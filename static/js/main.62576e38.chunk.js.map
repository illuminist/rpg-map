{"version":3,"sources":["theme/makeStyles.ts","components/GameMap/styles.ts","components/ImageLayer/styles.ts","helpers/makeUrl.ts","components/ImageLayer/ImageLayer.tsx","components/ImageLayer/index.ts","components/ObjectLayer/styles.ts","hooks/useAsyncEffect.ts","components/GameObject/styles.ts","store/game.ts","components/GameObject/GameObject.tsx","components/GameObject/index.ts","components/ObjectLayer/ObjectLayer.tsx","components/ObjectLayer/index.ts","components/CameraControl/styles.ts","store/camera.ts","components/CameraControl/CameraControl.tsx","components/CameraControl/index.ts","store/store.ts","components/GameMap/GameMap.tsx","components/GameMap/index.ts","theme/index.ts","App.tsx","serviceWorker.ts","index.tsx","mapdefs/demo1def.yaml","mapdefs/demo2def.yaml"],"names":["makeStyles","styles","options","oriMakeStyles","omit","theme","root","layer","position","top","left","userSelect","name","index","makeUrl","url","startsWith","process","ImageLayer","props","classes","useStyles","className","layerId","layerDef","classNames","src","alt","defaultProps","tileSize","gridSize","width","height","tile","backgroundColor","borderStyle","borderColor","borderWidth","walkable","displayMove","cursor","useAsyncEffect","fn","deps","mainRef","React","runningCount","current","selfRef","isCurrent","finally","console","log","positionAround","x","y","posToString","initMap","createAsyncThunk","arg","a","dispatch","prepareWalkableLayer","selectObject","createAction","deselectObject","moveObject","walkObject","getState","state","withId","objectId","map","selected","loaded","Promise","all","Object","keys","layerDefs","resolve","img","document","createElement","onload","canvas","ctx","getContext","Error","drawImage","wk","_","times","gridCount","getImageData","data","gameReducer","createReducer","builder","addCase","pending","action","cloneDeep","meta","animating","moveableDisplay","fulfilled","payload","forEach","id","gameObject","objectDefs","stat","movementRange","visited","Map","set","Number","POSITIVE_INFINITY","p","traverse","range","has","get","filter","destination","GameObject","useDispatch","useSelector","objectDef","spriteDef","spriteDefs","sprite","selectable","style","transform","type","onClick","undefined","draggable","WalkableIndicatorTile","key","WalkableIndicator","ObjectLayer","setWalkable","self","objId","layerContainer","transformOrigin","controlInstruction","bottom","color","borderTopRightRadius","shape","borderRadius","borderTopLeftRadius","padding","cameraMoveStart","cameraZoomRelative","cameraMoveRelative","cameraMoveSourceRelative","cameraMoveEnd","cameraZoomStart","cameraZoomEnd","cameraReducer","isMoving","cameraOriginalPosition","moveSourcePosition","zoom","isZooming","sourcePosition","center","screen","originalZoom","newZoom","Math","min","max","zoomDeltaRatio","zoomDelta","dcx","dcy","screenCenterDeltaCamPos","centerDeltaCamPos","screenCenterDistance","sqrt","centerRatio","deltaCamPos","CameraControl","children","cameraState","camera","cameraDispatch","ref","handleMouseUp","e","button","handleWheel","deltaY","pageX","pageY","clientWidth","clientHeight","window","addEventListener","removeEventListener","useSpring","config","stiff","onMouseDown","onMouseMove","onTouchStart","touches","length","onTouchMove","div","store","configureStore","reducer","combineReducers","Layer","layerComponentRender","MapLayerContainer","layerOrder","GameMap","mapDef","ready","Boolean","flexDirectionCenter","row","justifyContent","column","alignItems","sansFonts","serifFonts","palette","background","primary","amber","secondary","red","mixins","flex","direction","display","flexDirection","includes","flexWrap","imageAvatar","mixBackgroundColor","getContrastText","drawer","main","sidebar","typography","fontSize","fontFamily","h1","h2","h3","h4","h5","h6","createMuiTheme","partialTheme","App","basename","ThemeProvider","CssBaseline","path","map1Def","map2Def","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","then","registration","unregister","catch","error","message","module","exports"],"mappings":"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EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,Q,iBCAp+DD,EAAOC,QAAU,CAAC,UAAY,CAAC,MAAQ,GAAG,OAAS,IAAI,SAAW,CAAC,MAAQ,GAAG,OAAS,IAAI,WAAa,CAAC,cAAc,gBAAgB,UAAY,CAAC,YAAc,CAAC,KAAO,QAAQ,IAAM,yBAAyB,aAAe,CAAC,KAAO,SAAS,SAAW,CAAC,IAAM,mCAAmC,WAAa,CAAC,MAAQ,CAAC,OAAS,QAAQ,MAAQ,eAAe,SAAW,CAAC,EAAI,EAAE,EAAI,GAAG,KAAO,CAAC,cAAgB,IAAI,MAAQ,CAAC,OAAS,QAAQ,MAAQ,eAAe,SAAW,CAAC,EAAI,EAAE,EAAI,GAAG,KAAO,CAAC,cAAgB,KAAK,WAAa,CAAC,MAAQ,CAAC,KAAO,QAAQ,IAAM,+B","file":"static/js/main.62576e38.chunk.js","sourcesContent":["import omit from 'lodash/omit'\nimport { Theme } from '@material-ui/core/styles/createMuiTheme'\nimport { makeStyles as oriMakeStyles } from '@material-ui/styles'\n\nimport { Styles, WithStylesOptions } from '@material-ui/styles/withStyles'\n\nexport const makeStyles = <\n  Props extends {} = {},\n  ClassKey extends string = string\n>(\n  styles: Styles<Theme, Props, ClassKey>,\n  options?: WithStylesOptions<Theme>,\n) => {\n  return oriMakeStyles(\n    styles,\n    process.env.NODE_ENV === 'production' ? omit(options, 'name') : options,\n  )\n}\nexport default makeStyles\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // position: 'absolute',\n      // width: '100vw',\n      // height: '100vh',\n    },\n\n    layer: {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      userSelect: 'none',\n    },\n  }),\n  { name: 'GameMap', index: 1 },\n)\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {},\n  }),\n  { name: 'ImageLayer', index: 1 },\n)\n","export const makeUrl = (url: string) => {\n  if (url) {\n    if (url.startsWith('/')) {\n      return process.env.PUBLIC_URL + url\n    }\n  }\n\n  return url\n}\n\nexport default makeUrl\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport MapType, { ImageLayer as ImageLayerType } from 'maptype'\nimport makeUrl from 'helpers/makeUrl'\n\nexport interface ImageLayerProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  layerId: string\n  layerDef: ImageLayerType\n}\n\nexport const ImageLayer: React.FC<ImageLayerProps> = (props) => {\n  const classes = useStyles(props)\n  const { className, layerId, layerDef } = props\n\n  return (\n    <div className={classNames(className, classes.root)}>\n      <img src={makeUrl(layerDef.src)} alt={layerId} />\n    </div>\n  )\n}\n\nImageLayer.defaultProps = {}\n\nexport default ImageLayer\n","import ImageLayer from './ImageLayer'\n\nexport default ImageLayer\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\nimport MapType, { Size2D } from 'maptype'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // style code\n    },\n    tileSize: (gridSize: Size2D) => ({\n      width: gridSize.width,\n      height: gridSize.height,\n    }),\n    tile: {\n      backgroundColor: 'rgba(255,0,0,0.3)',\n      position: 'absolute',\n      borderStyle: 'solid',\n      borderColor: 'rgba(255,0,0,0.3)',\n      borderWidth: 1,\n    },\n    walkable: {\n      backgroundColor: 'unset',\n      borderColor: 'rgba(0,255,0,0.1)',\n    },\n    displayMove: {\n      backgroundColor: 'rgba(0,255,0,0.3)',\n      cursor: 'cell',\n    },\n  }),\n  { name: 'ObjectLayer', index: 1 },\n)\n","import * as React from 'react'\n\nexport type MainRef = {\n  deps: ReadonlyArray<any>\n  runningCount: number\n}\n\nexport type SelfRef = {\n  isCurrent: boolean\n  deps: ReadonlyArray<any>\n}\n\nexport const useAsyncEffect = (\n  fn: (ref: SelfRef, mainRef: MainRef) => Promise<void>,\n  deps: ReadonlyArray<any>,\n) => {\n  const mainRef = React.useRef<MainRef>({\n    deps: deps,\n    runningCount: 0,\n  })\n  mainRef.current.deps = deps\n  React.useEffect(() => {\n    const selfRef: SelfRef = {\n      isCurrent: true,\n      deps,\n    }\n    mainRef.current.runningCount++\n    fn(selfRef, mainRef.current).finally(() => {\n      console.log('async fin')\n      mainRef.current.runningCount--\n    })\n    return () => {\n      selfRef.isCurrent = false\n    }\n  }, deps)\n}\n\nexport default useAsyncEffect\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      position: 'absolute',\n      userSelect: 'none',\n    },\n  }),\n  { name: 'GameObject', index: 1 },\n)\n","import _ from 'lodash'\nimport { MapType, Position, Map2D, ObjectLayer } from 'maptype'\nimport { createAction, createReducer, createAsyncThunk } from '@reduxjs/toolkit'\nimport produce from 'immer'\nimport { ThunkConfig, RootState } from './store'\nimport makeUrl from 'helpers/makeUrl'\n\nexport type GameType = {\n  selected: string | null\n  animating: boolean\n  loaded: boolean\n  moveableDisplay: { [poscoordinate: string]: true } | null\n} & MapType\n\nconst positionAround = (position: Position) => {\n  return [\n    { x: position.x + 1, y: position.y },\n    { x: position.x - 1, y: position.y },\n    { x: position.x, y: position.y - 1 },\n    { x: position.x, y: position.y + 1 },\n  ]\n}\n\nconst posToString = (position: Position) => {\n  return position.x + ',' + position.y\n}\n\nexport const initMap = createAsyncThunk<MapType, MapType, ThunkConfig>(\n  'initMap',\n  async (arg, { dispatch }) => {\n    await dispatch(prepareWalkableLayer())\n    // const finalMap = produce(arg, (d) => {\n    //   Object.keys(wks).forEach((id) => {\n    //     ;(d.layerDefs[id] as ObjectLayer).walkable = wks[id]\n    //   })\n    // })\n    // return finalMap\n    return arg\n  },\n)\n\nexport const selectObject = createAction<string>('selectObject')\nexport const deselectObject = createAction<string>('deselectObject')\nexport const moveObject = createAction<{\n  objectId: string\n  destination: Position\n}>('moveObject')\nexport const walkObject = createAsyncThunk<\n  void,\n  {\n    objectId?: string\n    destination: Position\n  },\n  ThunkConfig\n>('walkObject', async (arg, { dispatch, getState }) => {\n  // TODO determine path, d\n\n  const state = getState() as RootState\n  const withId = {\n    ...arg,\n    objectId: 'objectId' in arg ? arg.objectId! : state.map.selected!,\n  }\n\n  dispatch(moveObject(withId))\n})\n\nconst prepareWalkableLayer = createAsyncThunk<\n  { [id: string]: Map2D<number> },\n  void,\n  ThunkConfig\n>('prepareWalkableLayer', async (arg, { getState }) => {\n  const map = (getState() as RootState).map!\n  const loaded: { [id: string]: Map2D<number> } = {}\n\n  await Promise.all(\n    Object.keys(map.layerDefs).map(\n      (layerId) =>\n        new Promise((resolve) => {\n          const layerDef = map.layerDefs[layerId] as ObjectLayer\n          if (layerDef.walkable && 'src' in layerDef.walkable) {\n            const img = document.createElement('img')\n            img.src = makeUrl(layerDef.walkable.src)\n            img.onload = () => {\n              const canvas = document.createElement('canvas')\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext('2d')\n              if (!ctx) throw new Error('not-support-canvas')\n              ctx.drawImage(img, 0, 0, img.width, img.height)\n\n              const wk = _.times(map.gridCount.height, (y) =>\n                _.times(map.gridCount.width, (x) => {\n                  const px = ctx.getImageData(\n                    x * map.gridSize.width + map.gridSize.width / 2,\n                    y * map.gridSize.height + map.gridSize.height / 2,\n                    1,\n                    1,\n                  ).data\n                  return px[0] ? 0 : 1\n                }),\n              )\n              loaded[layerId] = wk\n              resolve()\n            }\n          } else {\n            resolve()\n          }\n        }),\n    ),\n  )\n  return loaded\n})\n\nexport const gameReducer = createReducer<GameType>(null as any, (builder) =>\n  builder\n    .addCase(initMap.pending, (state, action) => {\n      return {\n        ..._.cloneDeep(action.meta.arg),\n        selected: null,\n        animating: false,\n        moveableDisplay: null,\n        loaded: false,\n      }\n    })\n    .addCase(initMap.fulfilled, (state, action) => {\n      state.loaded = true\n    })\n    .addCase(prepareWalkableLayer.fulfilled, (state, action) => {\n      console.log(action)\n      Object.keys(action.payload).forEach((id) => {\n        ;(state.layerDefs[id] as ObjectLayer).walkable = action.payload[id]\n      })\n    })\n    .addCase(selectObject, (state, action) => {\n      const gameObject = state.objectDefs[action.payload]\n      if (!gameObject?.stat.movementRange) return\n      state.selected = action.payload\n      state.moveableDisplay = {}\n\n      const visited = new Map<string, number>()\n      visited.set(posToString(gameObject.position), Number.POSITIVE_INFINITY)\n\n      const traverse = (position: Position, range: number) => {\n        if (range <= 0) return\n\n        if (\n          !visited.has(posToString(position)) ||\n          visited.get(posToString(position))! > range\n        ) {\n          visited.set(posToString(position), range)\n          if (true) {\n            state.moveableDisplay![posToString(position)] = true\n          }\n          positionAround(position)\n            .filter((p) => !visited.has(posToString(p)))\n            .forEach((p) => traverse(p, range - 1))\n        }\n      }\n      positionAround(gameObject.position).forEach((p) =>\n        traverse(p, gameObject.stat.movementRange!),\n      )\n    })\n    .addCase(deselectObject, (state, action) => {\n      state.selected = null\n      state.moveableDisplay = null\n    })\n    .addCase(moveObject, (state, action) => {\n      state.objectDefs[action.payload.objectId].position =\n        action.payload.destination\n      state.selected = null\n      state.moveableDisplay = null\n    })\n    .addCase(walkObject.pending, (state, action) => {\n      state.animating = true\n    })\n    .addCase(walkObject.fulfilled, (state, action) => {\n      state.animating = false\n    }),\n)\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport { useSelector, useDispatch } from 'react-redux'\nimport { selectObject } from 'store/game'\n\nexport interface GameObjectProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  objectId: string\n}\n\nexport const GameObject = (props: GameObjectProps) => {\n  const classes = useStyles(props)\n  const { className, objectId } = props\n  const dispatch = useDispatch()\n  const gridSize = useSelector((state) => state.map.gridSize)\n  const objectDef = useSelector((state) => state.map.objectDefs[objectId])\n  const spriteDef = useSelector(\n    (state) => state.map.spriteDefs[objectDef.sprite],\n  )\n\n  const selectable = useSelector(() => true)\n\n  const style = {\n    transform: `translate(${gridSize.width * objectDef.position.x}px,${\n      gridSize.height * objectDef.position.y\n    }px)`,\n    cursor: selectable ? 'pointer' : 'default',\n  }\n\n  const handleSelect = () => {\n    dispatch(selectObject(objectId))\n  }\n\n  switch (spriteDef.type) {\n    case 'image':\n      return (\n        <img\n          alt={`${objectId}:${objectDef.sprite}`}\n          className={classNames(className, classes.root)}\n          style={style}\n          src={spriteDef.src}\n          onClick={selectable ? handleSelect : undefined}\n          draggable={false}\n        />\n      )\n    default:\n      return null\n  }\n}\n\nGameObject.defaultProps = {}\n\nexport default GameObject\n","import GameObject from './GameObject'\n\nexport default GameObject\n","import _ from 'lodash'\nimport classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport { ObjectLayer as ObjectLayerType, Map2D } from 'maptype'\nimport makeUrl from 'helpers/makeUrl'\nimport useAsyncEffect from 'hooks/useAsyncEffect'\nimport { useSelector, useDispatch } from 'react-redux'\nimport GameObject from 'components/GameObject'\nimport { walkObject } from 'store/game'\n\nexport interface ObjectLayerProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  layerId: string\n  layerDef: ObjectLayerType\n}\n\nconst WalkableIndicatorTile = React.memo(\n  ({\n    x,\n    y,\n    classes,\n    layerId,\n  }: {\n    x: number\n    y: number\n    classes: any\n    layerId: string\n  }) => {\n    const gridSize = useSelector((state) => state.map.gridSize)\n    const displayMove = useSelector(\n      (state) => state.map.moveableDisplay?.[x + ',' + y],\n    )\n    const walkable = useSelector((state) => {\n      const layerDef = state.map.layerDefs?.[layerId]\n      return (\n        'walkable' in layerDef && (layerDef.walkable as Map2D<number>)[y][x]\n      )\n    })\n    const dispatch = useDispatch()\n\n    return (\n      <div\n        key={y + ':' + x}\n        style={{\n          top: y * gridSize.height,\n          left: x * gridSize.width,\n        }}\n        className={classNames(classes.tile, classes.tileSize, {\n          [classes.walkable]: walkable,\n          [classes.displayMove]: walkable && displayMove,\n        })}\n        onClick={\n          walkable && displayMove\n            ? () => dispatch(walkObject({ destination: { x, y } }))\n            : undefined\n        }\n      />\n    )\n  },\n)\n\nexport const WalkableIndicator = React.memo(\n  ({ layerId }: { layerId: string }) => {\n    const gridSize = useSelector((state) => state.map.gridSize)\n    const gridCount = useSelector((state) => state.map.gridCount)\n    const classes = useStyles({ ...gridSize })\n    return (\n      <div className={classNames(classes.root)}>\n        {_.times(gridCount.height, (y) => {\n          return _.times(gridCount.width, (x) => {\n            return (\n              <WalkableIndicatorTile\n                x={x}\n                y={y}\n                classes={classes}\n                layerId={layerId}\n              />\n            )\n          })\n        })}\n      </div>\n    )\n  },\n)\n\nexport const ObjectLayer: React.FC<ObjectLayerProps> = (props) => {\n  const { className, layerDef, layerId } = props\n  const gridSize = useSelector((state) => state.map.gridSize)\n  const gridCount = useSelector((state) => state.map.gridCount)\n  const objectDefs = useSelector((state) => state.map.objectDefs)\n  const classes = useStyles({ ...gridSize })\n\n  const [walkable, setWalkable] = React.useState<Map2D<number> | null>(\n    'src' in layerDef.walkable ? null : layerDef.walkable,\n  )\n\n  useAsyncEffect(\n    async (self) => {\n      if (!walkable && 'src' in layerDef.walkable) {\n        const img = document.createElement('img')\n        img.src = makeUrl(layerDef.walkable.src)\n        img.onload = () => {\n          if (!self.isCurrent) return\n          const canvas = document.createElement('canvas')\n          canvas.width = img.width\n          canvas.height = img.height\n          const ctx = canvas.getContext('2d')\n          if (!ctx) throw new Error('not-support-canvas')\n          ctx.drawImage(img, 0, 0, img.width, img.height)\n\n          const wk = _.times(gridCount.height, (y) =>\n            _.times(gridCount.width, (x) => {\n              const px = ctx.getImageData(\n                x * gridSize.width + gridSize.width / 2,\n                y * gridSize.height + gridSize.height / 2,\n                1,\n                1,\n              ).data\n              return px[0] ? 0 : 1\n            }),\n          )\n\n          setWalkable(wk)\n        }\n      }\n    },\n    [gridCount, gridSize, walkable, layerDef.walkable],\n  )\n\n  return (\n    walkable && (\n      <>\n        <WalkableIndicator layerId={layerId} />\n        {Object.keys(objectDefs)\n          .filter((objId) => objectDefs[objId].layer === layerId)\n          .map((objId) => (\n            <GameObject key={objId} objectId={objId} />\n          ))}\n      </>\n    )\n  )\n}\n\nObjectLayer.defaultProps = {}\n\nexport default ObjectLayer\n","import ObjectLayer from './ObjectLayer'\n\nexport default ObjectLayer\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      position: 'fixed',\n      height: '100%',\n      width: '100%',\n    },\n    layerContainer: {\n      transformOrigin: '0 0',\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      height: '100%',\n      width: '100%',\n    },\n    controlInstruction: {\n      position: 'fixed',\n      bottom: 0,\n      left: '50%',\n      transform: 'translateX(-50%)',\n      backgroundColor: 'rgba(0,0,0,0.3)',\n      color: 'white',\n      borderTopRightRadius: theme.shape.borderRadius,\n      borderTopLeftRadius: theme.shape.borderRadius,\n      padding: 16,\n    },\n  }),\n  { name: 'CameraControl', index: 1 },\n)\n","import { Position, Size2D } from 'maptype'\nimport { createAction, createReducer } from '@reduxjs/toolkit'\n\ntype CameraState = {\n  isMoving: boolean\n  moveSourcePosition: Position | null\n  cameraOriginalPosition: Position | null\n  position: Position\n  zoom: number\n  isZooming: boolean\n}\nconst initialCameraState: CameraState = {\n  isMoving: false,\n  cameraOriginalPosition: null,\n  moveSourcePosition: null,\n  position: {\n    x: 0,\n    y: 0,\n  },\n  zoom: 1,\n  isZooming: false,\n}\n\nexport const cameraMoveStart = createAction<{ sourcePosition: Position }>(\n  'cameraMoveStart',\n)\nexport const cameraZoomRelative = createAction<{\n  zoom: number\n  center: Position\n  screen: Size2D\n}>('cameraZoomRelative')\nexport const cameraMoveRelative = createAction<Position>('cameraMoveRelative')\nexport const cameraMoveSourceRelative = createAction<Position>(\n  'cameraMoveSourceRelative',\n)\nexport const cameraMoveEnd = createAction('cameraMoveEnd')\nexport const cameraZoomStart = createAction('cameraZoomStart')\nexport const cameraZoomEnd = createAction('cameraZoomEnd')\nexport const cameraReducer = createReducer(initialCameraState, (builder) =>\n  builder\n    .addCase(cameraMoveStart, (state, action) => {\n      state.isMoving = true\n      state.moveSourcePosition = action.payload.sourcePosition\n      state.cameraOriginalPosition = { ...state.position }\n    })\n    .addCase(cameraMoveEnd, (state, action) => {\n      state.isMoving = false\n    })\n    .addCase(cameraMoveRelative, (state, action) => {\n      state.position.x += action.payload.x\n      state.position.y += action.payload.y\n    })\n    .addCase(cameraMoveSourceRelative, (state, action) => {\n      state.position.x =\n        state.cameraOriginalPosition!.x +\n        state.moveSourcePosition!.x -\n        action.payload.x\n      state.position.y =\n        state.cameraOriginalPosition!.y +\n        state.moveSourcePosition!.y -\n        action.payload.y\n    })\n    .addCase(cameraZoomStart, (state, action) => {\n      state.isZooming = true\n    })\n    .addCase(cameraZoomEnd, (state, action) => {\n      state.isZooming = false\n    })\n    .addCase(\n      cameraZoomRelative,\n      (state, { payload: { center, zoom, screen } }) => {\n        const originalZoom = state.zoom\n\n        const maxZoomOut = 0.25\n        const maxZoomIn = 4\n\n        const newZoom = Math.min(\n          maxZoomIn,\n          Math.max(maxZoomOut, state.zoom + zoom),\n        )\n        const zoomDeltaRatio = newZoom / originalZoom\n        const zoomDelta = newZoom - originalZoom\n\n        const zoomPosLag = 1\n\n        const dcx = center.x - screen.width / 2\n        const dcy = center.y - screen.height / 2\n\n        const worldCenterPost = {\n          x: (state.position.x + dcx) / originalZoom,\n          y: (state.position.y + dcy) / originalZoom,\n        }\n\n        const screenCenterDeltaCamPos = {\n          x: dcx * -zoomDeltaRatio * zoomPosLag,\n          y: dcy * -zoomDeltaRatio * zoomPosLag,\n        }\n\n        const centerDeltaCamPos = {\n          x: worldCenterPost.x * -zoomDelta * zoomPosLag,\n          y: worldCenterPost.y * -zoomDelta * zoomPosLag,\n        }\n\n        const screenCenterDistance = Math.sqrt(dcx * dcx + dcy * dcy)\n\n        // centerRatio = 0 fixed zoom center\n        // centerRatio = 1 zoom center to screen center\n        const centerRatio = 0.5 * Math.min(1, (1 / screenCenterDistance) * 20)\n        // const centerRatio = 0\n\n        const deltaCamPos = {\n          x:\n            centerDeltaCamPos.x -\n            (centerDeltaCamPos.x - screenCenterDeltaCamPos.x) * centerRatio,\n          y:\n            centerDeltaCamPos.y -\n            (centerDeltaCamPos.y - screenCenterDeltaCamPos.y) * centerRatio,\n        }\n\n        const position = {\n          x: state.position.x - deltaCamPos.x,\n          y: state.position.y - deltaCamPos.y,\n        }\n        state.zoom = newZoom\n        state.position = position\n      },\n    ),\n)\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport { useSelector, useDispatch } from 'react-redux'\nimport { useSpring, config, animated } from 'react-spring'\nimport {\n  cameraMoveStart,\n  cameraMoveSourceRelative,\n  cameraMoveEnd,\n  cameraZoomStart,\n  cameraZoomRelative,\n} from 'store/camera'\nexport interface CameraControlProps {\n  children: React.ReactNode\n}\n\nexport const CameraControl = ({ children }: CameraControlProps) => {\n  const classes = useStyles({})\n  const cameraState = useSelector((state: any) => state.camera)\n  const cameraDispatch = useDispatch()\n\n  const ref = React.useRef<HTMLDivElement>(null)\n\n  const handleMouseDown = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (e.button === 1) {\n      cameraDispatch(\n        cameraMoveStart({ sourcePosition: { x: e.pageX, y: e.pageY } }),\n      )\n    }\n  }\n\n  const handleMouseMove = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (cameraState.isMoving) {\n      cameraDispatch(cameraMoveSourceRelative({ x: e.pageX, y: e.pageY }))\n    }\n  }\n\n  const handleTouchMove = (e: React.TouchEvent<HTMLDivElement>) => {\n    console.log(e.touches)\n    if (cameraState.isMoving) {\n      cameraDispatch(\n        cameraMoveSourceRelative({\n          x: e.touches[0].pageX,\n          y: e.touches[0].pageY,\n        }),\n      )\n    }\n  }\n\n  const handleTouchStart = (e: React.TouchEvent<HTMLDivElement>) => {\n    console.log(e.touches)\n    if (e.touches.length === 1) {\n      cameraDispatch(\n        cameraMoveStart({\n          sourcePosition: { x: e.touches[0].pageX, y: e.touches[0].pageY },\n        }),\n      )\n    } else if (e.touches.length === 2) {\n      cameraDispatch(cameraMoveEnd())\n      cameraDispatch(cameraZoomStart())\n    }\n  }\n\n  React.useEffect(() => {\n    const handleMouseUp = (e: MouseEvent) => {\n      if (e.button === 1) {\n        cameraDispatch(cameraMoveEnd())\n      }\n    }\n    const handleWheel = (e: WheelEvent) => {\n      ref.current &&\n        cameraDispatch(\n          cameraZoomRelative({\n            zoom: -e.deltaY / 200,\n            center: { x: e.pageX, y: e.pageY },\n            screen: {\n              width: ref.current.clientWidth,\n              height: ref.current.clientHeight,\n            },\n          }),\n        )\n    }\n    window.addEventListener('mouseup', handleMouseUp)\n    window.addEventListener('wheel', handleWheel)\n    return () => {\n      window.removeEventListener('mouseup', handleMouseUp)\n      window.removeEventListener('wheel', handleWheel)\n    }\n  }, [cameraDispatch])\n\n  const { transform } = useSpring({\n    // camera: [cameraState.zoom, cameraState.position.x, cameraState.position.y],\n    transform: `translate(50%,50%) translate(${-cameraState.position\n      .x}px,${-cameraState.position.y}px) scale(${cameraState.zoom})`,\n    config: config.stiff,\n  })\n\n  return (\n    <div\n      ref={ref}\n      className={classNames(classes.root)}\n      onMouseDown={handleMouseDown}\n      onMouseMove={handleMouseMove}\n      onTouchStart={handleTouchStart}\n      onTouchMove={handleTouchMove}>\n      <animated.div\n        className={classes.layerContainer}\n        style={{\n          transform,\n        }}>\n        {children}\n      </animated.div>\n      <div className={classes.controlInstruction}>\n        Middle mouse click and drag to move camera, middle wheel to zoom\n      </div>\n    </div>\n  )\n}\nCameraControl.defaultProps = {}\n\nexport default CameraControl\n","import CameraControl from './CameraControl'\n\nexport default CameraControl\n","import { configureStore, combineReducers } from '@reduxjs/toolkit'\nimport { cameraReducer } from './camera'\nimport { gameReducer } from './game'\n\nconst store = configureStore({\n  reducer: combineReducers({ camera: cameraReducer, map: gameReducer }),\n})\n\nexport type RootState = ReturnType<typeof store.getState>\nexport type AppDispatch = typeof store.dispatch\n\ndeclare module 'react-redux' {\n  interface DefaultRootState extends RootState {}\n}\n\nexport type ThunkConfig = {\n  // dispatch: AppDispatch\n  // state: RootState\n}\n\nexport default store\n","// import _ from 'lodash'\nimport classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport MapType, { AllLayer } from 'maptype'\nimport ImageLayer from 'components/ImageLayer'\nimport ObjectLayer from 'components/ObjectLayer'\nimport { Provider, useSelector, useDispatch } from 'react-redux'\nimport CameraControl from 'components/CameraControl'\nimport store from 'store/store'\nimport { initMap } from 'store/game'\n\nexport interface GameMapProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  mapDef: MapType\n}\n\nexport const Layer = React.memo(({ layerId }: { layerId: string }) => {\n  const classes = useStyles({})\n  const layerDef = useSelector((state) => state.map.layerDefs[layerId])\n  const layerComponentRender = (layerId: string) => {\n    switch (layerDef.type) {\n      case 'image':\n        return (\n          <ImageLayer\n            className={classes.layer}\n            key={layerId}\n            layerId={layerId}\n            layerDef={layerDef}\n          />\n        )\n      case 'object':\n        return (\n          <ObjectLayer\n            className={classes.layer}\n            key={layerId}\n            layerId={layerId}\n            layerDef={layerDef}\n          />\n        )\n      default:\n        return null\n    }\n  }\n  return layerComponentRender(layerId)\n})\n\nexport const MapLayerContainer = React.memo(() => {\n  const layerOrder = useSelector((state) => state.map.layerOrder)\n\n  return (\n    <>\n      {layerOrder.map((layerId) => (\n        <Layer key={layerId} layerId={layerId} />\n      ))}\n    </>\n  )\n})\n\nexport const GameMap: React.FC<GameMapProps> = (props) => {\n  const classes = useStyles(props)\n  const { className, mapDef } = props\n\n  const ready = useSelector((state) => Boolean(state.map))\n  const loaded = useSelector((state) => Boolean(state.map?.loaded))\n  const dispatch = useDispatch()\n  React.useEffect(() => {\n    if (!ready) {\n      dispatch(initMap(mapDef))\n    }\n  }, [dispatch, ready, mapDef])\n\n  return loaded && ready ? (\n    <div className={classes.root}>\n      <CameraControl>\n        <MapLayerContainer />\n      </CameraControl>\n    </div>\n  ) : null\n}\n\nexport const GameRoot = (props: GameMapProps) => {\n  return (\n    <Provider store={store}>\n      <GameMap {...props} />\n    </Provider>\n  )\n}\n\nexport default GameRoot\n","import GameMap from './GameMap'\n\nexport default GameMap\n","import createMuiTheme, {\n  ThemeOptions,\n  Theme,\n} from '@material-ui/core/styles/createMuiTheme'\nimport { Mixins, MixinsOptions } from '@material-ui/core/styles/createMixins'\nimport { CSSProperties } from '@material-ui/styles/withStyles'\nimport * as CSS from 'csstype'\nimport { Overrides } from '@material-ui/core/styles/overrides'\n\nimport { amber, red, grey } from '@material-ui/core/colors'\n\nconst flexDirectionCenter = {\n  row: { justifyContent: 'center' },\n  column: { alignItems: 'center' },\n}\n\nexport const sansFonts =\n  'Kanit, Sarabun, Prompt, \"Roboto\", \"Helvetica\", \"Arial\", sans-serif'\nexport const serifFonts =\n  'Sarabun, Prompt, \"Roboto\", \"Helvetica\", \"Arial\", sans-serif'\n\nexport const noiseImage = '' //createNoiseImage({ color: grey[500] })\n\nexport const overrides = (theme: Theme): Overrides => ({\n  MuiListItem: {\n    root: {\n      borderLeftStyle: 'solid',\n      borderLeftColor: theme.palette.primary.main,\n      borderLeftWidth: 0,\n    },\n  },\n  MuiFormControl: {\n    root: {\n      '&.border': {\n        borderColor: 'rgba(0,0,0,0.3)',\n        borderStyle: 'solid',\n        borderWidth: 1,\n        borderRadius: theme.shape.borderRadius,\n      },\n    },\n  },\n  MuiListItemText: {\n    root: {\n      '&.compact': {\n        display: 'none',\n      },\n    },\n  },\n  MuiExpansionPanelSummary: {\n    root: {\n      fontFamily: sansFonts,\n    },\n  },\n  MuiFormLabel: {\n    root: {\n      fontFamily: sansFonts,\n    },\n  },\n  MuiCssBaseline: {\n    '@global': {\n      body: {\n        backgroundColor: grey[700],\n        backgroundImage: `url(\"${noiseImage}\")`,\n        backgroundBlendMode: 'soft-light',\n      },\n      '@font-face': {\n        fontFamily: 'prompt',\n        unicodeRange: 'U+0E00-0E7F ',\n      },\n    },\n  },\n})\n\ndeclare module '@material-ui/core/styles/createMuiTheme' {\n  interface Theme {\n    drawer: CSSProperties\n    main: CSSProperties\n    sidebar: CSSProperties\n  }\n  interface ThemeOptions extends Partial<Theme> {}\n}\n\ndeclare module '@material-ui/core/styles/createMixins' {\n  interface Mixins {\n    flex: (\n      direction: CSS.FlexDirectionProperty,\n      ...option: string[]\n    ) => CSSProperties\n    imageAvatar: () => CSSProperties\n    mixBackgroundColor: (theme: Theme, color: string) => CSSProperties\n  }\n  interface MixinsOptions extends Partial<Mixins> {}\n}\n\ndeclare module '@material-ui/core/styles/createMixins' {\n  interface Mixins {\n    flex: (\n      direction: CSS.FlexDirectionProperty,\n      ...option: string[]\n    ) => CSSProperties\n    imageAvatar: () => CSSProperties\n    mixBackgroundColor: (theme: Theme, color: string) => CSSProperties\n  }\n  interface MixinsOptions extends Partial<Mixins> {}\n}\n\ndeclare module '@material-ui/core/styles/createTypography' {\n  interface Typography {\n    sansFonts: string\n    serifFonts: string\n  }\n  interface TypographyOptions extends Partial<Mixins> {}\n}\n\nexport const theme = {\n  palette: {\n    background: {\n      // default: grey[400],\n    },\n    type: 'dark',\n    primary: amber,\n    secondary: red,\n  },\n  mixins: {\n    flex: (direction: 'column' | 'row' = 'column', ...options) => ({\n      display: 'flex',\n      flexDirection: direction,\n      ...(options.includes('center') ? flexDirectionCenter[direction] : {}),\n      ...(options.includes('wrap') ? { flexWrap: 'wrap' } : {}),\n    }),\n    imageAvatar: () => ({\n      borderRadius: '12%',\n    }),\n    mixBackgroundColor: (theme, color) => ({\n      backgroundColor: color,\n      color: theme.palette.getContrastText(color),\n    }),\n  } as MixinsOptions,\n  drawer: {\n    width: 240,\n  },\n  main: {\n    width: 720,\n  },\n  sidebar: {\n    width: 300,\n    flex: '0 0 300px',\n  },\n  typography: {\n    fontSize: 14,\n    fontFamily: serifFonts,\n    sansFonts,\n    serifFonts,\n    // Tell Material-UI what the font-size on the html element is.\n    // htmlFontSize: 10,\n    h1: {\n      fontFamily: sansFonts,\n    },\n    h2: {\n      fontFamily: sansFonts,\n    },\n    h3: {\n      fontFamily: sansFonts,\n    },\n    h4: {\n      fontFamily: sansFonts,\n    },\n    h5: {\n      fontFamily: sansFonts,\n    },\n    h6: {\n      fontFamily: sansFonts,\n    },\n    // id: {\n    //   fontFamily: 'monospace',\n    //   fontSize: '0.7rem',\n    //   color: 'rgba(0,0,0,0.2)',\n    // },\n  },\n} as ThemeOptions\n\nexport default createMuiTheme(theme)\n","import React from 'react'\nimport map1Def from 'mapdefs/demo1def.yaml'\nimport map2Def from 'mapdefs/demo2def.yaml'\nimport GameMap from 'components/GameMap'\nimport ThemeProvider from '@material-ui/styles/ThemeProvider'\nimport createMuiTheme from '@material-ui/core/styles/createMuiTheme'\nimport partialTheme from 'theme'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport { HashRouter, Route, Switch } from 'react-router-dom'\n\nconst theme = createMuiTheme(partialTheme)\n\nfunction App() {\n  return (\n    <HashRouter basename={process.env.PUBLIC_URL}>\n      <ThemeProvider theme={theme}>\n        <CssBaseline>\n          <div className=\"App\">\n            <Switch>\n              <Route path=\"/demo1\">\n                <GameMap mapDef={map1Def} />\n              </Route>\n              <Route path=\"/demo2\">\n                <GameMap mapDef={map2Def} />\n              </Route>\n\n              <Route>\n                <GameMap mapDef={map1Def} />\n              </Route>\n            </Switch>\n          </div>\n        </CssBaseline>\n      </ThemeProvider>\n    </HashRouter>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = {\"gridCount\":{\"width\":36,\"height\":24},\"gridSize\":{\"width\":70,\"height\":70},\"layerOrder\":[\"imagelayer1\",\"objectlayer1\"],\"layerDefs\":{\"imagelayer1\":{\"type\":\"image\",\"src\":\"/assets/map.png\"},\"objectlayer1\":{\"type\":\"object\",\"walkable\":[[1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1],[1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],[0,0,0,0,1,1,0,0,1,1,1,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],[1,0,0,0,0,1,1,0,1,1,0,0,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1],[1,0,0,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1],[1,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,0,0,0,0,0,0,1,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,0,0,0,0,0,0,1,1,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,0,1,1,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,0,1,1,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,0,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}}}","module.exports = {\"gridCount\":{\"width\":22,\"height\":12},\"gridSize\":{\"width\":50,\"height\":50},\"layerOrder\":[\"imagelayer1\",\"objectlayer1\"],\"layerDefs\":{\"imagelayer1\":{\"type\":\"image\",\"src\":\"/assets/demo2/map.png\"},\"objectlayer1\":{\"type\":\"object\",\"walkable\":{\"src\":\"/assets/demo2/walkabledef.png\"}}},\"objectDefs\":{\"hero1\":{\"sprite\":\"hero1\",\"layer\":\"objectlayer1\",\"position\":{\"x\":4,\"y\":3},\"stat\":{\"movementRange\":4}},\"hero2\":{\"sprite\":\"hero1\",\"layer\":\"objectlayer1\",\"position\":{\"x\":6,\"y\":4},\"stat\":{\"movementRange\":4}}},\"spriteDefs\":{\"hero1\":{\"type\":\"image\",\"src\":\"/assets/demo2/hero1.png\"}}}"],"sourceRoot":""}