{"version":3,"sources":["mapdefs/demo3def.yaml","mapdefs/demo1def.yaml","mapdefs/demo2def.yaml","theme/makeStyles.ts","components/GameMap/styles.ts","components/ImageLayer/styles.ts","helpers/makeUrl.ts","helpers/vectorUtils.ts","helpers/promiseUtils.ts","helpers/resourceUtils.ts","store/game.ts","components/ImageLayer/ImageLayer.tsx","components/ImageLayer/index.ts","components/ObjectLayer/styles.ts","components/GameObject/styles.ts","components/GameObject/GameObject.tsx","components/GameObject/index.ts","components/ObjectLayer/ObjectLayer.tsx","components/ObjectLayer/index.ts","components/CameraControl/styles.ts","store/camera.ts","hooks/useGlobalEvent.ts","components/CameraControl/CameraControl.tsx","components/CameraControl/index.ts","components/TilemapLayer/styles.ts","helpers/imageUtils.ts","store/resource.ts","components/TilemapLayer/TilemapLayer.tsx","components/TilemapLayer/index.ts","components/GameMap/GameMap.tsx","components/GameMap/index.ts","theme/index.ts","components/GameEditor/styles.ts","components/GameEditor/LayerPanel/styles.ts","components/GameEditor/PanelBase/styles.ts","components/GameEditor/PanelBase/PanelBase.tsx","components/GameEditor/PanelBase/index.ts","store/editor.ts","helpers/extralodash.ts","store/store.ts","components/GameEditor/LayerPanel/LayerPanel.tsx","components/GameEditor/LayerPanel/index.ts","components/GameEditor/LayerWorkPanel/styles.ts","components/EditorTextField/styles.ts","components/EditorTextField/EditorTextField.tsx","components/EditorTextField/index.ts","components/ZoomInput/styles.ts","components/ZoomInput/ZoomInput.tsx","components/ZoomInput/index.ts","components/GridOverlay/styles.ts","components/GridOverlay/GridOverlay.tsx","components/GridOverlay/index.ts","components/GameEditor/LayerWorkPanel/TilemapLayerPanel.tsx","components/GameEditor/LayerWorkPanel/LayerWorkPanel.tsx","components/GameEditor/LayerWorkPanel/index.ts","components/GameEditor/MapEditorOverlay/styles.ts","components/GameEditor/MapEditorOverlay/MapEditorOverlay.tsx","components/GameEditor/MapEditorOverlay/index.ts","components/GameEditor/MenuPanel/styles.ts","components/GameEditor/MenuPanel/MenuPanel.tsx","components/GameEditor/MenuPanel/index.ts","components/GameEditor/TilesetPropertyDialog/styles.ts","components/GameEditor/TilesetPropertyDialog/TilesetPropertyDialog.tsx","components/GameEditor/TilesetPropertyDialog/index.ts","components/GameEditor/TilesetImporterDialog/styles.ts","components/GameEditor/TilesetImporterDialog/TilesetImporterDialog.tsx","components/GameEditor/TilesetImporterDialog/index.ts","components/GameEditor/GameEditor.tsx","components/GameEditor/index.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","makeStyles","styles","options","oriMakeStyles","omit","theme","root","layer","position","top","left","userSelect","name","index","makeUrl","url","startsWith","process","surround4","x","y","distance","p1","p2","dx","dy","Math","sqrt","inbound","pos","x1","y1","x2","y2","posToString","Symbol","iterator","toStringTag","PositionSet","internalSet","this","Set","clear","callbackfn","thisArg","Error","item","add","has","delete","size","sleep","time","Promise","resolve","setTimeout","loadDataResource","a","fullUrl","fetch","response","contentType","headers","get","split","mime","text","body","data","YAML","parse","json","loadImageResource","reject","img","document","createElement","src","onload","onerror","useMapDef","selector","useSelector","state","editor","isEditing","mapDef","map","initMap","createAsyncThunk","arg","dispatch","getState","tilesetDefs","_","forEach","tileset","id","pathFind","gridCount","origin","destination","passthrough","range","nextqueue","PQueue","comparator","b","visited","fromMap","Map","rangeMap","reached","width","height","queue","set","currentPos","dequeue","currentRange","length","pminus1","path","push","prepareObjectWalkMap","objectId","gameObject","objectDefs","layerDefs","walkmap","cloneDeep","walkable","objectsOnLayer","pickBy","group","tile","selectObject","createAction","deselectObject","moveObject","walkObject","selected","stat","movementRange","nextMove","pop","Number","nextPos","prepareLayerResource","loaded","all","Object","keys","layerId","layerDef","canvas","ctx","getContext","drawImage","wk","times","getImageData","gridSize","gameReducer","createReducer","builder","addCase","pending","action","meta","animating","moveableDisplay","fulfilled","payload","visitQueue","shift","filter","p","ImageLayer","props","classes","useStyles","className","classNames","style","transform","offset","scale","alt","defaultProps","tileSize","backgroundColor","borderStyle","borderColor","borderWidth","displayMove","cursor","selectable","GameObject","useDispatch","objectDef","spriteDef","spriteDefs","sprite","useSpring","config","duration","type","onClick","undefined","draggable","WalkableIndicatorTile","React","key","WalkableIndicator","ObjectLayer","objId","layerContainer","transformOrigin","transition","transitions","create","controlInstruction","bottom","color","borderTopRightRadius","shape","borderRadius","borderTopLeftRadius","padding","cameraMoveStart","cameraZoomRelative","cameraMoveRelative","cameraMoveSourceRelative","cameraMoveEnd","cameraZoomStart","cameraZoomEnd","cameraReducer","isMoving","cameraOriginalPosition","moveSourcePosition","zoom","isZooming","sourcePosition","center","screen","originalZoom","newZoom","min","max","zoomDeltaRatio","zoomDelta","dcx","dcy","screenCenterDeltaCamPos","centerDeltaCamPos","screenCenterDistance","centerRatio","deltaCamPos","useGlobalEvent","listener","dep","window","addEventListener","removeEventListener","CameraControl","children","cameraState","camera","cameraDispatch","ref","e","button","el","current","handleWheel","deltaY","pageX","pageY","clientWidth","clientHeight","onMouseDown","onMouseMove","onTouchStart","console","log","touches","onTouchMove","tileDef","tilesetDef","al","flatMap","identity","acc","i","backgroundPositionX","backgroundPositionY","display","getTransparentImage","transparentKey","clearRect","imageData","pixelData","transparentKeys","c","cl","red","green","blue","putImageData","toDataURL","getTransparentImageHash","transparentColor","join","resourceUtils","processImage","args","resource","createSlice","initialState","reducers","extraReducers","resourceType","extraActions","actions","assign","TilemapLayer","canvasRef","imgRef","processedImage","image","finalSrc","s","loadedSrc","handleLoaded","lastRenderRef","lastRender","tiles","row","tiledata","imageSmoothingEnabled","floor","Layer","layerComponentRender","MapLayerContainer","layerOrder","GameMap","overlay","ready","Boolean","flexDirectionCenter","justifyContent","column","alignItems","sansFonts","serifFonts","palette","background","primary","amber","secondary","mixins","flex","direction","flexDirection","includes","flexWrap","imageAvatar","mixBackgroundColor","getContrastText","drawer","main","sidebar","typography","fontSize","fontFamily","h1","h2","h3","h4","h5","h6","createMuiTheme","drawerPaper","maxWidth","boxShadow","shadows","overflowY","marginBottom","spacing","PanelBase","title","Card","elevation","CardHeader","importTileset","thunk","localId","uuidv4","tilesetId","applyToLayer","workingLayer","localName","createDefaultMapDef","panel","tilemapLayerEditor","paintMode","updatedTiles","dialog","initialize","prepare","reducer","selectWorkingLayer","addLayer","layerType","setMapProperty","property","value","setLayerProperty","setProperty","error","paintTileLayer","fn","tileGridCount","startingPosition","selectTileRect","px","py","newTileData","j","deleteLayer","createTileset","assignToLayer","rearrangeLayer","splice","sourceIndex","targetIndex","openDialog","closeDialog","persistConfig","storage","blacklist","store","configureStore","persistReducer","combineReducers","useEditorState","persistor","persistStore","LayerPanel","handleLayerSelect","currentTarget","dataset","layerid","menuOpen","setMenuOpen","addMenuAnchorRef","handleAddLayer","layertype","handleDelete","onDragEnd","result","source","droppableId","dropProvided","snapshot","List","innerRef","droppableProps","reverse","draggableId","dragProvided","ListItem","draggableProps","data-layerid","divider","ListItemText","dragHandleProps","placeholder","Menu","open","anchorEl","onClose","MenuItem","data-layertype","CardActions","IconButton","disabled","marginTop","EditorTextField","onUpdate","restProp","setEditing","editedValue","setEditedValue","propRef","handleFocus","handleBlur","target","handleChange","handleKeyDown","onKeyDown","TextField","onFocus","onBlur","onChange","paddingLeft","paddingRight","input","textAlign","ZoomInput","label","internalValue","setInternalValue","internalChanged","setInternalChanged","v","numVal","endsWith","substring","numVal2","round","handleInputKey","handleZoomIn","handleZoomOut","InputProps","startAdornment","InputAdornment","endAdornment","variant","onKeyPress","highlight","pointerEvents","clickThrough","highlightPosition","GridOverlay","strokeStyle","onGridClick","onGridPointerDown","onGridPointerUp","onGridPointerMove","beginPath","moveTo","lineTo","stroke","determineGridPos","canvasRect","getBoundingClientRect","xpos","clientX","ypos","clientY","downPosRef","lastPosRef","grid","lastPos","onMouseUp","imageContainer","overflow","borderRightStyle","borderBottomStyle","disableElementSelect","tileSelected","border","contentScale","TilemapLayerEditor","layerEditorComponent","CardContent","Grid","container","xs","fullWidth","inputProps","step","object","tilemap","tileResource","imgSrc","finalImageSrc","setZoom","selectedTiles","mouseDownAt","setMouseDown","handleTileMouseDown","handleTileClick","handleTileMouseEnter","startPos","abs","select","t","Divider","clsx","Toolbar","LayerWorkPanel","LayerEditor","gridContainer","gridTarget","MapEditorOverlay","workingLayerId","useStore","hoverAt","setHoverAt","setMouseDownAt","moveTargetGrid","handleMouseDown","MapPropertyDialog","Dialog","DialogTitle","DialogContent","DialogActions","Button","RawDataDialog","rawData","stringify","multiline","MenuPanel","setOpen","menuRef","handleAction","data-action","colorChipFocus","imgColorPick","initialTileDef","tileDefs","ColorSelector","field","form","focus","onFocusChange","useTheme","tryColor","Chip","onDelete","setFieldValue","without","newV","uniq","TilesetPropertyDialog","rest","focusing","setFocus","initialValues","onSubmit","as","fieldProps","values","rect","getColorOnImg","importableTilesets","TilesetImporterDialog","setSelected","setName","handleClose","handleSelect","handleNameChange","handleImport","data-tileset","ListItemIcon","Radio","checked","InputLabelProps","shrink","GameEditor","editorMapDef","Drawer","paper","anchor","partialTheme","App","basename","loading","ThemeProvider","CssBaseline","map1Def","map2Def","map3Def","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","then","registration","unregister","catch","message"],"mappings":"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,IAAI,IAAI,IAAI,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,EAAE,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,KAAK,CAAC,EAAE,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,KAAK,CAAC,EAAE,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,KAAK,CAAC,EAAE,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,EAAE,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,KAAK,CAAC,EAAE,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,KAAK,CAAC,EAAE,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,EAAE,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,OAAO,aAAa,CAAC,KAAO,UAAU,QAAU,aAAa,MAAQ,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,EAAE,GAAG,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,EAAE,EAAE,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,OAAO,cAAc,CAAC,KAAO,UAAU,QAAU,aAAa,MAAQ,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,IAAI,IAAI,KAAK,CAAC,IAAI,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,EAAE,EAAE,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,KAAK,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,GAAG,KAAK,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,OAAO,QAAS,EAAK,OAAQ,EAAK,YAAc,CAAC,uCAAuC,CAAC,UAAY,CAAC,MAAQ,GAAG,OAAS,IAAI,SAAW,CAAC,MAAQ,GAAG,OAAS,IAAI,MAAQ,CAAC,IAAM,kCAAkC,SAAW,CAAC,IAAM,CAAC,UAAY,CAAC,OAAS,CAAC,IAAI,KAAK,UAAY,OAAO,UAAY,YAAY,uCAAuC,CAAC,UAAY,CAAC,MAAQ,GAAG,OAAS,IAAI,SAAW,CAAC,MAAQ,GAAG,OAAS,IAAI,MAAQ,CAAC,IAAM,6CAA6C,SAAW,CAAC,IAAM,CAAC,UAAY,CAAC,OAAS,CAAC,IAAI,KAAK,UAAY,OAAO,UAAY,eAAe,WAAa,CAAC,UAAY,CAAC,MAAQ,GAAG,OAAS,IAAI,SAAW,CAAC,MAAQ,GAAG,OAAS,IAAI,MAAQ,CAAC,IAAM,6+KAA6+K,iBAAmB,CAAC,UAAU,SAAW,CAAC,IAAM,CAAC,UAAY,CAAC,OAAS,CAAC,IAAI,KAAK,UAAY,OAAO,UAAY,a,kBCAriZD,EAAOC,QAAU,CAAC,UAAY,CAAC,MAAQ,GAAG,OAAS,IAAI,SAAW,CAAC,MAAQ,GAAG,OAAS,IAAI,WAAa,CAAC,cAAc,gBAAgB,UAAY,CAAC,YAAc,CAAC,KAAO,QAAQ,IAAM,mBAAmB,aAAe,CAAC,KAAO,SAAS,SAAW,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE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","file":"static/js/main.b6d34536.chunk.js","sourcesContent":["module.exports = {\"gridCount\":{\"width\":22,\"height\":18},\"gridSize\":{\"width\":64,\"height\":64},\"layerOrder\":[\"tilemap-base\",\"tilemap-object\",\"tilemap-51\",\"tilemap-170\"],\"layerDefs\":{\"tilemap-base\":{\"type\":\"tilemap\",\"tileset\":\"2921978c-5b34-4521-950a-9ef9890533ff\",\"tiles\":[[116,116,116,116,117,115,116,116,116,117,115,116,116,116,117,115,116,116,116,117,118,118],[138,138,138,138,139,137,138,138,138,139,137,138,138,138,139,137,138,138,138,139,140,118],[160,160,160,160,161,159,160,160,160,161,159,160,160,160,161,159,160,160,160,161,162,140],[325,133,134,135,329,325,326,327,328,329,325,326,327,328,329,325,326,327,328,329,325,162],[259,155,156,157,263,259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,70],[281,155,156,157,285,281,282,283,284,285,281,282,283,284,285,281,282,283,153,285,281,92],[303,155,156,157,307,303,304,305,306,307,303,304,305,306,307,303,304,305,153,307,303,114],[325,155,156,157,329,325,326,327,328,329,325,326,327,328,329,325,326,327,153,329,325,326],[259,155,156,157,263,259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260],[281,177,178,179,285,281,282,283,284,285,281,282,283,284,285,281,282,283,284,285,281,282],[303,304,305,306,307,303,304,305,306,307,303,304,305,306,307,303,304,305,306,307,303,304],[325,326,327,328,329,325,326,327,328,329,325,326,327,328,329,325,326,327,328,329,325,326],[259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260],[281,282,283,284,285,281,282,283,284,285,281,282,283,284,285,281,282,283,284,285,281,282],[303,304,305,306,307,303,304,305,306,307,303,304,305,306,307,303,304,305,306,307,303,304],[289,326,327,328,329,325,326,327,328,329,325,326,327,328,329,325,326,327,328,329,325,326],[259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260],[281,282,283,284,285,281,282,283,284,285,281,282,283,284,285,281,282,283,284,285,281,282]]},\"tilemap-object\":{\"type\":\"tilemap\",\"tileset\":\"efc568e8-5bb2-48a7-8bec-6b8f88359486\",\"tiles\":[[262,263,259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260,261,338,263],[284,285,281,282,9,10,11,12,13,14,284,285,281,282,283,284,285,281,282,283,338,285],[2,23,23,23,31,32,33,34,35,36,306,22,23,24,305,306,307,303,304,305,338,307],[2,133,134,135,53,54,55,56,57,58,109,263,259,260,261,40,41,42,326,182,338,329],[2,112,112,157,75,76,77,78,79,80,131,285,281,282,40,62,63,64,109,261,338,263],[2,112,112,157,97,98,99,100,101,102,153,307,303,304,62,84,85,86,131,259,338,259],[2,112,156,112,119,120,121,122,123,124,175,329,325,326,84,106,107,108,182,182,338,259],[2,155,112,157,141,142,143,144,145,146,197,263,33,34,34,34,34,34,175,292,293,259],[2,112,156,157,163,164,165,166,167,168,284,285,55,56,55,56,57,58,197,294,183,259],[2,23,23,24,182,164,237,192,167,182,306,307,172,121,122,172,173,174,175,294,326,274],[259,1,185,185,327,328,329,192,326,327,328,329,194,143,144,194,195,196,197,314,317,296],[259,183,259,259,182,259,259,192,259,182,259,259,182,165,166,259,259,259,259,183,294,259],[259,259,259,259,259,259,259,192,259,182,182,182,259,259,259,259,259,259,259,259,294,259],[69,69,259,259,259,259,259,192,259,259,259,259,259,259,259,259,259,259,259,259,294,259],[288,288,291,259,259,259,259,236,239,239,239,237,239,239,239,239,259,259,259,259,294,259],[181,289,289,291,259,259,182,280,259,259,259,259,259,259,237,237,237,259,259,259,294,259],[259,183,259,313,259,182,259,280,259,259,259,259,259,259,259,259,259,259,259,259,294,259],[259,181,259,335,259,259,259,259,259,274,315,316,317,318,181,274,275,276,276,183,294,259]]},\"tilemap-51\":{\"type\":\"tilemap\",\"tileset\":\"foresttest\",\"tiles\":[[15,16,17,18,19,20,21,15,16,17,8,9,20,21,15,16,17,18,19,20,21,15],[37,38,39,40,41,42,43,37,38,39,30,31,42,43,37,38,39,40,41,42,43,37],[59,60,61,62,63,64,65,59,60,61,52,53,64,65,59,60,61,62,63,64,65,59],[81,82,83,84,85,86,87,81,82,83,74,75,86,87,81,82,83,84,85,86,87,81],[103,104,105,106,107,108,109,103,104,105,106,107,108,109,103,104,105,106,107,108,109,103],[125,126,127,128,129,130,131,125,126,127,128,129,130,131,125,126,127,128,129,130,131,125],[147,148,149,150,151,152,153,147,148,149,150,151,152,153,147,148,149,150,151,152,8,9],[169,170,171,172,173,174,130,131,125,126,127,128,129,130,131,125,126,127,8,9,30,31],[153,147,148,149,150,151,152,153,147,148,149,150,151,152,153,147,148,149,30,31,52,53],[12,13,170,171,172,173,174,175,169,170,171,172,173,174,175,169,170,171,52,53,74,75],[34,35,16,17,18,19,20,21,15,16,17,18,19,20,21,15,16,17,74,75,20,21],[56,57,38,39,40,41,42,43,37,38,39,40,41,42,43,37,38,39,8,9,42,43],[78,79,60,61,62,63,64,65,59,60,61,62,63,64,65,59,60,61,30,31,64,65],[87,81,82,83,84,85,86,87,81,82,83,84,85,86,87,81,82,83,52,53,86,87],[109,103,104,105,106,107,108,109,103,104,105,106,107,108,109,103,104,105,74,75,108,109],[131,125,126,127,128,129,130,131,125,126,127,128,129,130,131,125,126,127,128,129,130,131],[153,147,148,149,150,151,152,153,147,148,149,150,151,152,153,147,148,149,150,151,152,153],[175,169,170,171,172,173,174,175,169,170,171,172,173,174,175,169,170,171,172,173,174,175]]},\"tilemap-170\":{\"type\":\"tilemap\",\"tileset\":\"foresttest\",\"tiles\":[[15,16,17,18,19,20,21,15,16,17,18,19,20,21,15,16,17,18,19,20,21,15],[37,38,39,40,41,42,43,37,38,39,40,12,13,43,37,38,39,40,41,42,43,37],[59,60,61,62,63,64,65,59,60,61,62,34,35,65,59,60,61,62,63,64,65,59],[81,82,83,84,85,86,87,81,82,83,84,56,57,87,81,82,83,84,85,86,87,81],[103,104,105,106,107,108,109,103,104,105,106,78,79,109,103,104,105,106,107,108,109,103],[125,126,127,128,129,130,131,125,126,127,128,129,130,131,125,126,127,128,129,130,131,125],[147,148,149,150,151,152,153,147,148,149,150,151,152,153,147,148,149,150,151,152,153,147],[169,170,171,172,173,174,175,169,170,171,172,173,174,175,169,170,171,172,173,174,175,169],[15,16,17,18,19,20,21,15,16,17,18,19,20,21,15,16,17,18,19,8,9,15],[37,38,39,40,41,42,43,37,38,39,40,41,42,43,37,38,8,9,41,30,31,37],[59,12,13,62,63,64,65,59,60,148,149,150,151,152,153,147,30,31,63,52,53,59],[81,34,35,84,85,86,87,175,169,170,171,172,173,174,175,169,52,53,85,74,75,81],[103,56,57,106,107,108,109,21,15,16,17,18,19,20,21,15,74,8,9,108,109,103],[125,78,79,128,129,130,131,43,37,38,39,40,41,42,43,37,127,30,31,8,9,125],[147,148,149,150,151,152,153,65,59,60,61,62,63,64,65,59,149,52,53,30,31,147],[169,170,171,172,173,174,175,87,81,82,83,84,85,86,87,81,171,74,75,52,53,169],[15,16,17,18,19,20,21,109,103,104,105,106,107,108,109,103,17,18,19,74,75,15],[37,38,39,40,41,42,43,131,125,126,127,128,129,130,131,125,39,40,41,42,43,37]]}},\"loaded\":true,\"ready\":true,\"tilesetDefs\":{\"2921978c-5b34-4521-950a-9ef9890533ff\":{\"gridCount\":{\"width\":22,\"height\":18},\"gridSize\":{\"width\":16,\"height\":16},\"image\":{\"src\":\"/assets/tilesets/tiles-map.png\"},\"tileDefs\":{\"231\":{\"animation\":{\"frames\":[231,253],\"frametime\":700}}},\"localName\":\"BaseTile\"},\"efc568e8-5bb2-48a7-8bec-6b8f88359486\":{\"gridCount\":{\"width\":22,\"height\":18},\"gridSize\":{\"width\":16,\"height\":16},\"image\":{\"src\":\"/assets/tilesets/transparent-bg-tiles.png\"},\"tileDefs\":{\"231\":{\"animation\":{\"frames\":[231,253],\"frametime\":700}}},\"localName\":\"Transparent\"},\"foresttest\":{\"gridCount\":{\"width\":22,\"height\":18},\"gridSize\":{\"width\":16,\"height\":16},\"image\":{\"src\":\"data:image/png;base64,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\",\"transparentColor\":[\"white\"]},\"tileDefs\":{\"231\":{\"animation\":{\"frames\":[231,253],\"frametime\":700}}},\"localName\":\"Forest\"}}}","module.exports = {\"gridCount\":{\"width\":36,\"height\":24},\"gridSize\":{\"width\":70,\"height\":70},\"layerOrder\":[\"imagelayer1\",\"objectlayer1\"],\"layerDefs\":{\"imagelayer1\":{\"type\":\"image\",\"src\":\"/assets/map.png\"},\"objectlayer1\":{\"type\":\"object\",\"walkable\":[[0,0,0,0,0,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,0,0,0,0,0,0,0],[0,0,0,0,0,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,0,0,0,0,0],[8,8,8,8,0,0,8,8,0,0,0,8,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,0,0,0,0],[0,8,8,8,8,0,0,8,0,0,8,8,0,0,0,0,0,0,0,8,8,8,8,0,0,0,0,8,8,8,8,8,8,0,0,0],[0,8,8,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,0,8,8,8,0,0,0,0,0,0,8,8,8,8,8,8,0,0],[0,8,8,0,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,8,8,8,0,0,0,0,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,8,8,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,8,8,0,0,0,0,8,8,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,8,8,8,0,0,8,0,0,0,0,8,8,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,8,8,8,0,0,8,8,8,8,0,8,8,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,8,8,8,0,0,0,8,8,8,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,8,8,8,0,0,0,0,0,8,8,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,8,0,0,0,0,8,8,8,8,8,8,8,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,8,0,0,0,8,8,8,8,8,8,8,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,8,8,8,8,8,8,8,0,0,8,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,8,0,0,0,8,8,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,0,8,8,8,8,8,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,0,8,8,8,8,8,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,8,8,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]]}},\"objectDefs\":{\"hero1\":{\"sprite\":\"hero1\",\"layer\":\"objectlayer1\",\"group\":1,\"position\":{\"x\":2,\"y\":12},\"stat\":{\"movementRange\":4}},\"hero2\":{\"sprite\":\"hero1\",\"layer\":\"objectlayer1\",\"group\":1,\"position\":{\"x\":6,\"y\":4},\"stat\":{\"movementRange\":15}}},\"spriteDefs\":{\"hero1\":{\"type\":\"image\",\"src\":\"/assets/demo2/hero1.png\"}}}","module.exports = {\"gridCount\":{\"width\":22,\"height\":12},\"gridSize\":{\"width\":50,\"height\":50},\"layerOrder\":[\"imagelayer1\",\"objectlayer1\"],\"layerDefs\":{\"imagelayer1\":{\"type\":\"image\",\"src\":\"/assets/demo2/map.png\"},\"objectlayer1\":{\"type\":\"object\",\"walkable\":{\"src\":\"/assets/demo2/walkabledef.png\"}}},\"objectDefs\":{\"hero1\":{\"sprite\":\"hero1\",\"layer\":\"objectlayer1\",\"group\":1,\"position\":{\"x\":4,\"y\":3},\"stat\":{\"movementRange\":4}},\"hero2\":{\"sprite\":\"hero1\",\"layer\":\"objectlayer1\",\"group\":1,\"position\":{\"x\":6,\"y\":4},\"stat\":{\"movementRange\":4}}},\"spriteDefs\":{\"hero1\":{\"type\":\"image\",\"src\":\"/assets/demo2/hero1.png\"}}}","import omit from 'lodash/omit'\nimport { Theme } from '@material-ui/core/styles/createMuiTheme'\nimport { makeStyles as oriMakeStyles } from '@material-ui/styles'\n\nimport { Styles, WithStylesOptions } from '@material-ui/styles/withStyles'\n\nexport const makeStyles = <\n  Props extends {} = {},\n  ClassKey extends string = string\n>(\n  styles: Styles<Theme, Props, ClassKey>,\n  options?: WithStylesOptions<Theme>,\n) => {\n  return oriMakeStyles(\n    styles,\n    process.env.NODE_ENV === 'production' ? omit(options, 'name') : options,\n  )\n}\nexport default makeStyles\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // position: 'absolute',\n      // width: '100vw',\n      // height: '100vh',\n    },\n\n    layer: {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      userSelect: 'none',\n    },\n  }),\n  { name: 'GameMap', index: 1 },\n)\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {},\n  }),\n  { name: 'ImageLayer', index: 1 },\n)\n","export const makeUrl = (url: string) => {\n  if (url) {\n    if (url.startsWith('/')) {\n      return process.env.PUBLIC_URL + url\n    }\n  }\n\n  return url\n}\n\nexport default makeUrl\n","import { Position } from 'maptype'\n\nexport const surround4 = (position: Position) => {\n  return [\n    { x: position.x + 1, y: position.y },\n    { x: position.x - 1, y: position.y },\n    { x: position.x, y: position.y - 1 },\n    { x: position.x, y: position.y + 1 },\n  ]\n}\n\nexport const distance = (p1: Position, p2: Position) => {\n  const dx = p1.x - p2.x\n  const dy = p1.y - p2.y\n  return Math.sqrt(dx * dx + dy * dy)\n}\n\nexport const inbound = (\n  pos: Position,\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number,\n) => x1 <= pos.x && pos.x < x2 && y1 <= pos.y && pos.y < y2\n\nexport const posToString = (position: Position) => `${position.x},${position.y}`\n\nexport const vectorEq = (p1: Position, p2: Position) =>\n  p1.x === p2.x && p1.y === p2.y\n\nexport class PositionSet implements Set<Position> {\n  private internalSet: Set<string>\n  public constructor() {\n    this.internalSet = new Set()\n  }\n  public clear(): void {\n    return this.internalSet.clear()\n  }\n  forEach(\n    callbackfn: (value: Position, value2: Position, set: Set<Position>) => void,\n    thisArg?: any,\n  ): void {\n    throw new Error('Method not implemented.')\n  }\n\n  public get size(): number {\n    return this.internalSet.size\n  }\n\n  [Symbol.iterator](): IterableIterator<Position> {\n    throw new Error('Method not implemented.')\n  }\n  entries(): IterableIterator<[Position, Position]> {\n    throw new Error('Method not implemented.')\n  }\n  keys(): IterableIterator<Position> {\n    throw new Error('Method not implemented.')\n  }\n  values(): IterableIterator<Position> {\n    throw new Error('Method not implemented.')\n  }\n  [Symbol.toStringTag]: string\n  public add(item: Position) {\n    this.internalSet.add(posToString(item))\n    return this\n  }\n  public has(item: Position) {\n    return this.internalSet.has(posToString(item))\n  }\n  public delete(item: Position) {\n    return this.internalSet.delete(posToString(item))\n  }\n}\n","export const sleep = (time: number = 0): Promise<void> =>\n  new Promise((resolve) => setTimeout(resolve, time))\n","import YAML from 'yaml'\nimport makeUrl from './makeUrl'\n\nexport const loadDataResource = async <T = any>(url: string): Promise<T> => {\n  const fullUrl = makeUrl(url)\n  const response = await fetch(fullUrl)\n  const contentType = response.headers.get('content-type')\n  if (!contentType)\n    throw new Error('unable to determine content-type:' + fullUrl)\n  const [mime] = contentType.split(/;\\s*/i)\n\n  switch (mime) {\n    case 'text/yaml':\n      const body = await response.text()\n      const data = YAML.parse(body)\n      return data as T\n    case 'text/json':\n      return response.json() as Promise<T>\n    default:\n      throw new Error('unsupport mime: ' + mime + ' : ' + fullUrl)\n  }\n}\n\nexport const loadImageResource = async (\n  url: string,\n): Promise<HTMLImageElement> =>\n  new Promise((resolve, reject) => {\n    const img = document.createElement('img')\n    img.src = makeUrl(url)\n    img.onload = () => resolve(img)\n    img.onerror = reject\n  })\n","import _ from 'lodash'\nimport {\n  MapType,\n  Position,\n  Map2D,\n  ObjectLayer,\n  Size2D,\n  AllLayer,\n} from 'maptype'\nimport { createAction, createReducer, createAsyncThunk } from '@reduxjs/toolkit'\nimport { ThunkConfig, RootState } from './store'\nimport PQueue from 'js-priority-queue'\nimport {\n  surround4,\n  distance,\n  posToString,\n  PositionSet,\n  vectorEq,\n  inbound,\n} from 'helpers/vectorUtils'\nimport { sleep } from 'helpers/promiseUtils'\nimport { loadImageResource, loadDataResource } from 'helpers/resourceUtils'\nimport { useSelector } from 'react-redux'\n\nexport type GameType = {\n  selected: string | null\n  animating: boolean\n  loaded: boolean\n  moveableDisplay: { [poscoordinate: string]: true } | null\n} & MapType\n\nexport const useMapDef = <T extends any>(selector: (ard: MapType) => T) => {\n  return useSelector((state: RootState) => {\n    if (state.editor.isEditing) return selector(state.editor.mapDef!)\n    return selector(state.map)\n  })\n}\n\nexport const initMap = createAsyncThunk<MapType, MapType, ThunkConfig>(\n  'initMap',\n  async (arg, { dispatch, getState }) => {\n    // const finalMap = produce(arg, (d) => {\n    //   Object.keys(wks).forEach((id) => {\n    //     ;(d.layerDefs[id] as ObjectLayer).walkable = wks[id]\n    //   })\n    // })\n    // return finalMap\n    const tilesetDefs = arg.tilesetDefs\n    _.forEach(tilesetDefs, (tileset, id) => {})\n    return arg\n  },\n)\n\nexport const pathFind = ({\n  map,\n  gridCount,\n  origin,\n  destination,\n  passthrough = 0,\n  range = 1 / 0,\n}: {\n  map: Map2D<number>\n  gridCount: Size2D\n  origin: Position\n  destination: Position\n  passthrough?: number\n  range?: number\n}) => {\n  const nextqueue = new PQueue<Position>({\n    comparator: (a, b) => {\n      const da = distance(a, destination)\n      const db = distance(b, destination)\n      return da - db\n    },\n  })\n\n  const visited = new PositionSet()\n  const fromMap = new Map<string, string>()\n  const rangeMap = new Map<string, number>()\n  let reached = false\n  const around = surround4(origin)\n\n  around.forEach((pos) => {\n    if (\n      inbound(pos, 0, 0, gridCount.width, gridCount.height) &&\n      (map[pos.y][pos.x] === 0 || (map[pos.y][pos.x] ^ passthrough) === 0)\n    ) {\n      nextqueue.queue(pos)\n      fromMap.set(posToString(pos), posToString(origin))\n      rangeMap.set(posToString(pos), range)\n    }\n  })\n\n  while (nextqueue.length > 0) {\n    const currentPos = nextqueue.dequeue()\n    if (!visited.has(currentPos)) {\n      visited.add(currentPos)\n\n      if (vectorEq(currentPos, destination)) {\n        reached = true\n        break\n      }\n      const currentRange = rangeMap.get(posToString(currentPos))\n      if (currentRange == null || currentRange < 0) continue\n      const around = surround4(currentPos)\n\n      around.forEach((pos) => {\n        if (\n          !visited.has(pos) &&\n          (map[pos.y][pos.x] === 0 || (map[pos.y][pos.x] ^ passthrough) === 0)\n        ) {\n          nextqueue.queue(pos)\n          fromMap.set(posToString(pos), posToString(currentPos))\n          rangeMap.set(posToString(pos), currentRange - 1)\n        }\n      })\n    }\n  }\n\n  if (reached) {\n    let pminus1: string | undefined = posToString(destination)\n    const path: string[] = [pminus1]\n    do {\n      pminus1 = fromMap.get(pminus1!)\n      pminus1 && path.push(pminus1)\n      if (pminus1 === posToString(origin)) return path\n    } while (pminus1 && fromMap.size > 0)\n  }\n}\n\nexport const prepareObjectWalkMap = (state: GameType, objectId: string) => {\n  const gameObject = state.objectDefs[objectId]\n\n  const layer = state.layerDefs[gameObject.layer] as ObjectLayer\n\n  const walkmap = _.cloneDeep(layer.walkable) as Map2D<number>\n\n  const objectsOnLayer = _.pickBy(\n    state.objectDefs,\n    ({ layer }) => layer === gameObject.layer,\n  )\n\n  _.forEach(objectsOnLayer, ({ group, position }) => {\n    const tile = _.get(walkmap, [position.y, position.x])\n    _.set(\n      walkmap,\n      [position.y, position.x],\n      group && gameObject.group\n        ? (gameObject.group ^ group) === 0\n          ? group\n          : 0\n        : tile,\n    )\n  })\n\n  return walkmap\n}\n\nexport const selectObject = createAction<string>('selectObject')\nexport const deselectObject = createAction<string>('deselectObject')\nexport const moveObject = createAction<{\n  objectId: string\n  destination: Position\n}>('moveObject')\nexport const walkObject = createAsyncThunk<\n  void,\n  {\n    objectId?: string\n    destination: Position\n    ignoreBlock?: boolean\n    ignoreRange?: boolean\n  },\n  ThunkConfig\n>('walkObject', async (arg, { dispatch, getState }) => {\n  const state = getState() as RootState\n  const objectId = 'objectId' in arg ? arg.objectId! : state.map.selected!\n\n  const gameObject = state.map.objectDefs[objectId]\n  const walkmap = prepareObjectWalkMap(state.map, objectId)\n\n  const path = pathFind({\n    map: walkmap,\n    origin: gameObject.position,\n    destination: arg.destination,\n    passthrough: gameObject.group,\n    gridCount: state.map.gridCount,\n    range: gameObject.stat?.movementRange,\n  })\n\n  if (!path) {\n    throw new Error('path-invalid')\n  }\n  while (path.length) {\n    const nextMove = path.pop()!.split(',').map(Number)\n    const nextPos = { x: nextMove[0], y: nextMove[1] }\n    dispatch(moveObject({ destination: nextPos, objectId }))\n    await sleep(300)\n  }\n  // dispatch(moveObject(withId))\n})\n\nconst prepareLayerResource = createAsyncThunk<\n  { [id: string]: Partial<AllLayer> },\n  void,\n  ThunkConfig\n>('prepareLayerResource', async (arg, { getState }) => {\n  const map = (getState() as RootState).map!\n  const loaded: { [id: string]: Partial<AllLayer> } = {}\n\n  await Promise.all(\n    Object.keys(map.layerDefs).map(async (layerId) => {\n      const layerDef = map.layerDefs[layerId]\n      if ('walkable' in layerDef && 'src' in layerDef.walkable) {\n        const img = await loadImageResource(layerDef.walkable.src)\n        const canvas = document.createElement('canvas')\n        canvas.width = img.width\n        canvas.height = img.height\n        const ctx = canvas.getContext('2d')\n        if (!ctx) throw new Error('not-support-canvas')\n        ctx.drawImage(img, 0, 0, img.width, img.height)\n\n        const wk = _.times(map.gridCount.height, (y) =>\n          _.times(map.gridCount.width, (x) => {\n            const px = ctx.getImageData(\n              x * map.gridSize.width + map.gridSize.width / 2,\n              y * map.gridSize.height + map.gridSize.height / 2,\n              1,\n              1,\n            ).data\n            return px[0] ? -1 : 0\n          }),\n        )\n        _.set(loaded, [layerId, 'walkable'], wk)\n      }\n\n      if (\n        'tileset' in layerDef &&\n        typeof layerDef.tileset === 'object' &&\n        'src' in layerDef.tileset\n      ) {\n        const data = await loadDataResource(layerDef.tileset.src)\n        _.set(loaded, [layerId, 'tileset'], data)\n      }\n    }),\n  )\n  return loaded\n})\n\nexport const gameReducer = createReducer<GameType>(\n  null as any,\n  (builder): any =>\n    builder\n      .addCase(initMap.pending, (state, action) => {\n        return {\n          ..._.cloneDeep(action.meta.arg),\n          selected: null,\n          animating: false,\n          moveableDisplay: null,\n          loaded: false,\n        }\n      })\n      .addCase(initMap.fulfilled, (state, action) => {\n        state.loaded = true\n      })\n      .addCase(prepareLayerResource.fulfilled, (state, action) => {\n        Object.keys(action.payload).forEach((id) => {\n          state.layerDefs[id] = {\n            ...state.layerDefs[id],\n            ...action.payload[id],\n          } as any\n        })\n      })\n      .addCase(selectObject, (state, action) => {\n        const walkmap = _.cloneDeep(prepareObjectWalkMap(state, action.payload))\n        const gameObject = state.objectDefs[action.payload]\n        if (!gameObject?.stat.movementRange) return\n        state.selected = action.payload\n        state.moveableDisplay = {}\n\n        const visited = new PositionSet()\n        const visitQueue: [Position, number][] = [\n          [gameObject.position, gameObject.stat!.movementRange!],\n        ]\n        visited.add(gameObject.position)\n\n        do {\n          const [currentPos, currentRange = -1] = visitQueue.shift() || []\n          if (!currentPos) return\n          if (currentRange < 0) continue\n\n          const tilegroup = _.get(walkmap, [currentPos.y, currentPos.x])\n          if (tilegroup === 0)\n            state.moveableDisplay![posToString(currentPos)] = true\n\n          visited.add(currentPos)\n\n          surround4(currentPos)\n            .filter(\n              (p) =>\n                inbound(\n                  p,\n                  0,\n                  0,\n                  state.gridCount.width,\n                  state.gridCount.height,\n                ) &&\n                (_.get(walkmap, [p.y, p.x]) === 0 ||\n                  _.get(walkmap, [p.y, p.x]) === gameObject.group) &&\n                !visited.has(p),\n            )\n            .forEach((p) => visitQueue.push([p, currentRange - 1]))\n        } while (visitQueue.length)\n      })\n      .addCase(deselectObject, (state, action) => {\n        state.selected = null\n        state.moveableDisplay = null\n      })\n      .addCase(moveObject, (state, action) => {\n        state.objectDefs[action.payload.objectId].position =\n          action.payload.destination\n        state.selected = null\n        state.moveableDisplay = null\n      })\n      .addCase(walkObject.pending, (state, action) => {\n        state.animating = true\n      })\n      .addCase(walkObject.fulfilled, (state, action) => {\n        state.animating = false\n      }),\n)\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport MapType, { ImageLayer as ImageLayerType } from 'maptype'\nimport makeUrl from 'helpers/makeUrl'\nimport { useMapDef } from 'store/game'\n\nexport interface ImageLayerProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  layerId: string\n  layerDef: ImageLayerType\n}\n\nexport const ImageLayer: React.FC<ImageLayerProps> = (props) => {\n  const classes = useStyles(props)\n  const { className, layerId, layerDef } = props\n  const gridSize = useMapDef((state) => state.gridSize)\n\n  return (\n    <div className={classNames(className, classes.root)}>\n      <img\n        style={{\n          transform: `translate(${gridSize.width * layerDef.offset.x}px,${\n            gridSize.height * layerDef.offset.y\n          }px) scale(${layerDef.scale.width}, ${layerDef.scale.height})`,\n        }}\n        src={makeUrl(layerDef.src)}\n        alt={layerId}\n      />\n    </div>\n  )\n}\n\nImageLayer.defaultProps = {}\n\nexport default ImageLayer\n","import ImageLayer from './ImageLayer'\n\nexport default ImageLayer\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\nimport MapType, { Size2D } from 'maptype'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // style code\n    },\n    tileSize: (gridSize: Size2D) => ({\n      width: gridSize.width,\n      height: gridSize.height,\n    }),\n    tile: {\n      backgroundColor: 'rgba(255,0,0,0.3)',\n      position: 'absolute',\n      borderStyle: 'solid',\n      borderColor: 'rgba(255,0,0,0.3)',\n      borderWidth: 1,\n    },\n    walkable: {\n      backgroundColor: 'unset',\n      borderColor: 'rgba(0,255,0,0.1)',\n    },\n    displayMove: {\n      backgroundColor: 'rgba(0,255,0,0.3)',\n      cursor: 'cell',\n    },\n  }),\n  { name: 'ObjectLayer', index: 1 },\n)\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      position: 'absolute',\n      userSelect: 'none',\n    },\n    selectable: {\n      cursor: 'pointer',\n    },\n  }),\n  { name: 'GameObject', index: 1 },\n)\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport { useSelector, useDispatch } from 'react-redux'\nimport { selectObject } from 'store/game'\nimport { useSpring, animated } from 'react-spring'\nimport makeUrl from 'helpers/makeUrl'\n\nexport interface GameObjectProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  objectId: string\n}\n\nexport const GameObject = (props: GameObjectProps) => {\n  const classes = useStyles(props)\n  const { className, objectId } = props\n  const dispatch = useDispatch()\n  const gridSize = useSelector((state) => state.map.gridSize)\n  const objectDef = useSelector((state) => state.map.objectDefs[objectId])\n  const spriteDef = useSelector(\n    (state) => state.map.spriteDefs[objectDef.sprite],\n  )\n\n  const selectable = useSelector((state) => !state.map.animating)\n\n  const style = useSpring({\n    transform: `translate(${gridSize.width * objectDef.position.x}px,${\n      gridSize.height * objectDef.position.y\n    }px)`,\n    config: { duration: 270 },\n  })\n\n  const handleSelect = () => {\n    dispatch(selectObject(objectId))\n  }\n\n  switch (spriteDef.type) {\n    case 'image':\n      return (\n        <animated.img\n          alt={`${objectId}:${objectDef.sprite}`}\n          className={classNames(className, classes.root, {\n            [classes.selectable]: selectable,\n          })}\n          style={style}\n          src={makeUrl(spriteDef.src)}\n          onClick={selectable ? handleSelect : undefined}\n          draggable={false}\n        />\n      )\n    default:\n      return null\n  }\n}\n\nGameObject.defaultProps = {}\n\nexport default GameObject\n","import GameObject from './GameObject'\n\nexport default GameObject\n","import _ from 'lodash'\nimport classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport { ObjectLayer as ObjectLayerType, Map2D } from 'maptype'\nimport { useSelector, useDispatch } from 'react-redux'\nimport GameObject from 'components/GameObject'\nimport { walkObject } from 'store/game'\n\nexport interface ObjectLayerProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  layerId: string\n  layerDef: ObjectLayerType\n}\n\nconst WalkableIndicatorTile = React.memo(\n  ({\n    x,\n    y,\n    classes,\n    layerId,\n  }: {\n    x: number\n    y: number\n    classes: any\n    layerId: string\n  }) => {\n    const gridSize = useSelector((state) => state.map.gridSize)\n    const displayMove = useSelector(\n      (state) => state.map.moveableDisplay?.[x + ',' + y],\n    )\n    const walkable = useSelector((state) => {\n      const layerDef = state.map.layerDefs?.[layerId]\n      return (\n        'walkable' in layerDef &&\n        (layerDef.walkable as Map2D<number>)[y][x] === 0\n      )\n    })\n    const dispatch = useDispatch()\n\n    return (\n      <div\n        key={y + ':' + x}\n        style={{\n          top: y * gridSize.height,\n          left: x * gridSize.width,\n        }}\n        className={classNames(classes.tile, classes.tileSize, {\n          [classes.walkable]: walkable,\n          [classes.displayMove]: walkable && displayMove,\n        })}\n        onClick={\n          walkable && displayMove\n            ? () => dispatch(walkObject({ destination: { x, y } }))\n            : undefined\n        }\n      />\n    )\n  },\n)\n\nexport const WalkableIndicator = React.memo(\n  ({ layerId }: { layerId: string }) => {\n    const gridSize = useSelector((state) => state.map.gridSize)\n    const gridCount = useSelector((state) => state.map.gridCount)\n    const classes = useStyles({ ...gridSize })\n    return (\n      <div className={classNames(classes.root)}>\n        {_.times(gridCount.height, (y) => {\n          return _.times(gridCount.width, (x) => {\n            return (\n              <WalkableIndicatorTile\n                key={`${x}-${y}`}\n                x={x}\n                y={y}\n                classes={classes}\n                layerId={layerId}\n              />\n            )\n          })\n        })}\n      </div>\n    )\n  },\n)\n\nexport const ObjectLayer: React.FC<ObjectLayerProps> = (props) => {\n  const { className, layerDef, layerId } = props\n  const objectDefs = useSelector((state) => state.map.objectDefs)\n\n  return (\n    layerDef.walkable && (\n      <>\n        <WalkableIndicator layerId={layerId} />\n        {objectDefs &&\n          Object.keys(objectDefs)\n            .filter((objId) => objectDefs[objId].layer === layerId)\n            .map((objId) => <GameObject key={objId} objectId={objId} />)}\n      </>\n    )\n  )\n}\n\nObjectLayer.defaultProps = {}\n\nexport default ObjectLayer\n","import ObjectLayer from './ObjectLayer'\n\nexport default ObjectLayer\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      position: 'fixed',\n      height: '100%',\n      width: '100%',\n    },\n    layerContainer: {\n      transformOrigin: '0 0',\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      height: '100%',\n      width: '100%',\n      transition: theme.transitions.create('transform', { duration: 100 }),\n    },\n    controlInstruction: {\n      position: 'fixed',\n      bottom: 0,\n      left: '50%',\n      transform: 'translateX(-50%)',\n      backgroundColor: 'rgba(0,0,0,0.3)',\n      color: 'white',\n      borderTopRightRadius: theme.shape.borderRadius,\n      borderTopLeftRadius: theme.shape.borderRadius,\n      padding: 16,\n    },\n  }),\n  { name: 'CameraControl', index: 1 },\n)\n","import { Position, Size2D } from 'maptype'\nimport { createAction, createReducer } from '@reduxjs/toolkit'\n\ntype CameraState = {\n  isMoving: boolean\n  moveSourcePosition: Position | null\n  cameraOriginalPosition: Position | null\n  position: Position\n  zoom: number\n  isZooming: boolean\n}\nconst initialCameraState: CameraState = {\n  isMoving: false,\n  cameraOriginalPosition: null,\n  moveSourcePosition: null,\n  position: {\n    x: 0,\n    y: 0,\n  },\n  zoom: 1,\n  isZooming: false,\n}\n\nexport const cameraMoveStart = createAction<{ sourcePosition: Position }>(\n  'cameraMoveStart',\n)\nexport const cameraZoomRelative = createAction<{\n  zoom: number\n  center: Position\n  screen: Size2D\n}>('cameraZoomRelative')\nexport const cameraMoveRelative = createAction<Position>('cameraMoveRelative')\nexport const cameraMoveSourceRelative = createAction<Position>(\n  'cameraMoveSourceRelative',\n)\nexport const cameraMoveEnd = createAction('cameraMoveEnd')\nexport const cameraZoomStart = createAction('cameraZoomStart')\nexport const cameraZoomEnd = createAction('cameraZoomEnd')\nexport const cameraReducer = createReducer(initialCameraState, (builder) =>\n  builder\n    .addCase(cameraMoveStart, (state, action) => {\n      state.isMoving = true\n      state.moveSourcePosition = action.payload.sourcePosition\n      state.cameraOriginalPosition = { ...state.position }\n    })\n    .addCase(cameraMoveEnd, (state, action) => {\n      state.isMoving = false\n    })\n    .addCase(cameraMoveRelative, (state, action) => {\n      state.position.x += action.payload.x\n      state.position.y += action.payload.y\n    })\n    .addCase(cameraMoveSourceRelative, (state, action) => {\n      state.position.x =\n        state.cameraOriginalPosition!.x +\n        state.moveSourcePosition!.x -\n        action.payload.x\n      state.position.y =\n        state.cameraOriginalPosition!.y +\n        state.moveSourcePosition!.y -\n        action.payload.y\n    })\n    .addCase(cameraZoomStart, (state, action) => {\n      state.isZooming = true\n    })\n    .addCase(cameraZoomEnd, (state, action) => {\n      state.isZooming = false\n    })\n    .addCase(\n      cameraZoomRelative,\n      (state, { payload: { center, zoom, screen } }) => {\n        const originalZoom = state.zoom\n\n        const maxZoomOut = 0.25\n        const maxZoomIn = 4\n\n        const newZoom = Math.min(\n          maxZoomIn,\n          Math.max(maxZoomOut, state.zoom + zoom),\n        )\n        const zoomDeltaRatio = newZoom / originalZoom\n        const zoomDelta = newZoom - originalZoom\n\n        const zoomPosLag = 1\n\n        const dcx = center.x - screen.width / 2\n        const dcy = center.y - screen.height / 2\n\n        const worldCenterPost = {\n          x: (state.position.x + dcx) / originalZoom,\n          y: (state.position.y + dcy) / originalZoom,\n        }\n\n        const screenCenterDeltaCamPos = {\n          x: dcx * -zoomDeltaRatio * zoomPosLag,\n          y: dcy * -zoomDeltaRatio * zoomPosLag,\n        }\n\n        const centerDeltaCamPos = {\n          x: worldCenterPost.x * -zoomDelta * zoomPosLag,\n          y: worldCenterPost.y * -zoomDelta * zoomPosLag,\n        }\n\n        const screenCenterDistance = Math.sqrt(dcx * dcx + dcy * dcy)\n\n        // centerRatio = 0 fixed zoom center\n        // centerRatio = 1 zoom center to screen center\n        const centerRatio = 0.5 * Math.min(1, (1 / screenCenterDistance) * 20)\n        // const centerRatio = 0\n\n        const deltaCamPos = {\n          x:\n            centerDeltaCamPos.x -\n            (centerDeltaCamPos.x - screenCenterDeltaCamPos.x) * centerRatio,\n          y:\n            centerDeltaCamPos.y -\n            (centerDeltaCamPos.y - screenCenterDeltaCamPos.y) * centerRatio,\n        }\n\n        const position = {\n          x: state.position.x - deltaCamPos.x,\n          y: state.position.y - deltaCamPos.y,\n        }\n        state.zoom = newZoom\n        state.position = position\n      },\n    ),\n)\n","import * as React from 'react'\n\nexport const useGlobalEvent = function <K extends keyof WindowEventMap>(\n  type: K,\n  listener: (this: Window, ev: WindowEventMap[K]) => any,\n  dep?: React.DependencyList,\n) {\n  React.useEffect(() => {\n    window.addEventListener(type, listener)\n    return () => {\n      window.removeEventListener(type, listener)\n    }\n  }, dep)\n}\n\nexport default useGlobalEvent\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport { useSelector, useDispatch } from 'react-redux'\nimport {\n  cameraMoveStart,\n  cameraMoveSourceRelative,\n  cameraMoveEnd,\n  cameraZoomStart,\n  cameraZoomRelative,\n} from 'store/camera'\nimport useGlobalEvent from 'hooks/useGlobalEvent'\nexport interface CameraControlProps {\n  children: React.ReactNode\n}\n\nexport const CameraControl = ({ children }: CameraControlProps) => {\n  const classes = useStyles({})\n  const cameraState = useSelector((state: any) => state.camera)\n  const cameraDispatch = useDispatch()\n\n  const ref = React.useRef<HTMLDivElement>(null)\n\n  const handleMouseDown = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (e.button === 1) {\n      cameraDispatch(\n        cameraMoveStart({ sourcePosition: { x: e.pageX, y: e.pageY } }),\n      )\n    }\n  }\n\n  const handleMouseMove = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (cameraState.isMoving) {\n      cameraDispatch(cameraMoveSourceRelative({ x: e.pageX, y: e.pageY }))\n    }\n  }\n\n  const handleTouchMove = (e: React.TouchEvent<HTMLDivElement>) => {\n    console.log(e.touches)\n    if (cameraState.isMoving) {\n      cameraDispatch(\n        cameraMoveSourceRelative({\n          x: e.touches[0].pageX,\n          y: e.touches[0].pageY,\n        }),\n      )\n    }\n  }\n\n  const handleTouchStart = (e: React.TouchEvent<HTMLDivElement>) => {\n    console.log(e.touches)\n    if (e.touches.length === 1) {\n      cameraDispatch(\n        cameraMoveStart({\n          sourcePosition: { x: e.touches[0].pageX, y: e.touches[0].pageY },\n        }),\n      )\n    } else if (e.touches.length === 2) {\n      cameraDispatch(cameraMoveEnd())\n      cameraDispatch(cameraZoomStart())\n    }\n  }\n\n  useGlobalEvent(\n    'mouseup',\n    (e) => e.button === 1 && cameraDispatch(cameraMoveEnd()),\n    [cameraDispatch],\n  )\n  React.useEffect(() => {\n    const el = ref.current\n    if (el) {\n      const handleWheel = (e: WheelEvent) => {\n        cameraDispatch(\n          cameraZoomRelative({\n            zoom: -e.deltaY / 200,\n            center: { x: e.pageX, y: e.pageY },\n            screen: {\n              width: el.clientWidth,\n              height: el.clientHeight,\n            },\n          }),\n        )\n      }\n      el.addEventListener('wheel', handleWheel)\n      return () => {\n        el.removeEventListener('wheel', handleWheel)\n      }\n    }\n  }, [cameraDispatch])\n\n  return (\n    <div\n      ref={ref}\n      className={classNames(classes.root)}\n      onMouseDown={handleMouseDown}\n      onMouseMove={handleMouseMove}\n      onTouchStart={handleTouchStart}\n      onTouchMove={handleTouchMove}>\n      <div\n        className={classes.layerContainer}\n        style={{\n          transform: `translate(50%,50%) translate(${-cameraState.position\n            .x}px,${-cameraState.position.y}px) scale(${cameraState.zoom})`,\n        }}>\n        {children}\n      </div>\n      <div className={classes.controlInstruction}>\n        Middle mouse click and drag to move camera, middle wheel to zoom\n      </div>\n    </div>\n  )\n}\nCameraControl.defaultProps = {}\n\nexport default CameraControl\n","import CameraControl from './CameraControl'\n\nexport default CameraControl\n","import _ from 'lodash'\nimport makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\nimport { TilemapLayer, TilesetDef, Size2D } from 'maptype'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // style code\n    },\n    tile: {\n      position: 'absolute',\n    },\n    tileDef: ({\n      tileset,\n      gridCount,\n      gridSize,\n    }: TilemapLayer & { gridCount: Size2D; gridSize: Size2D }) => {\n      const tilesetDef = tileset as TilesetDef\n      const al = _.transform(\n        _.times(tilesetDef.gridCount?.height ?? 0, (y) =>\n          _.times(tilesetDef.gridCount?.width ?? 0, (x) => {\n            return [x, y]\n          }),\n        ).flatMap(_.identity),\n        (acc: any, [x, y]: any, i) => {\n          acc[`&.t${i}`] = {\n            backgroundPositionX: -x * gridSize.width,\n            backgroundPositionY: -y * gridSize.height,\n          }\n        },\n        {},\n      )\n      return {\n        width: gridSize.width,\n        height: gridSize.height,\n        // backgroundImage: `url(${makeUrl((tileset as TilesetDef).image.src)})`,\n        ...al,\n      }\n    },\n    img: {\n      display: 'none',\n    },\n  }),\n  { name: 'TilemapLayer', index: 1 },\n)\n","import color from 'color'\n\nexport const getTransparentImage = (\n  img: HTMLImageElement,\n  transparentKey: string[],\n) => {\n  if (!transparentKey.length) return\n  const canvas = document.createElement('canvas')\n  const ctx = canvas.getContext('2d')\n  const width = img.width\n  const height = img.height\n  if (ctx) {\n    canvas.width = width\n    canvas.height = height\n    ctx.clearRect(0, 0, width, height)\n\n    ctx.drawImage(img, 0, 0)\n\n    const imageData = ctx.getImageData(0, 0, width, height)\n    const pixelData = imageData.data\n\n    const transparentKeys = new Set(\n      transparentKey.map((c) => {\n        const cl = new color(c)\n        return `${cl.red()},${cl.green()},${cl.blue()}`\n      }),\n    )\n\n    console.log(transparentKeys)\n\n    for (let i = 0; i < pixelData.length; i += 4) {\n      const color = `${pixelData[i]},${pixelData[i + 1]},${pixelData[i + 2]}`\n      if (transparentKeys.has(color)) {\n        pixelData[i + 3] = 0\n      }\n    }\n    ctx.clearRect(0, 0, width, height)\n    ctx.putImageData(imageData, 0, 0)\n\n    const dataURL = canvas.toDataURL('image/png')\n    return dataURL\n  }\n  throw new Error('not support canvas 2dcontext')\n}\n\nexport const getTransparentImageHash = (arg: {\n  src: string\n  transparentColor?: string[]\n}) => {\n  return (\n    arg.src +\n    (arg.transparentColor?.length ? '::' + arg.transparentColor.join(',') : '')\n  )\n}\n","import _ from 'lodash'\n\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit'\nimport * as resourceUtils from 'helpers/resourceUtils'\nimport {\n  getTransparentImage,\n  getTransparentImageHash,\n} from 'helpers/imageUtils'\n\nexport type ResourceStore = {\n  [resourceType: string]: { [resourceName: string]: any }\n}\n\nexport const loadDataResource = createAsyncThunk(\n  'loadDataResource',\n  async (arg: { resourceType: string; url: string }) => {\n    return resourceUtils.loadDataResource(arg.url)\n  },\n)\n\nexport const processImage = createAsyncThunk(\n  'processImage',\n  async (args: { src: string; transparentColor?: string[] }) =>\n    new Promise<{ src: string }>((resolve) => {\n      const img = document.createElement('img')\n      img.src = args.src\n      img.onload = () => {\n        if (args.transparentColor) {\n          resolve({\n            src: getTransparentImage(img, args.transparentColor) as string,\n          })\n        } else {\n          resolve({ src: args.src })\n        }\n      }\n    }),\n)\n\nexport const resource = createSlice({\n  name: 'resource',\n  initialState: {} as ResourceStore,\n  reducers: {},\n  extraReducers: (builder): any =>\n    builder\n      .addCase(loadDataResource.fulfilled, (state, action) => {\n        _.set(\n          state,\n          [action.meta.arg.resourceType, action.meta.arg.url],\n          action.payload,\n        )\n      })\n      .addCase(processImage.fulfilled, (state, action) => {\n        _.set(\n          state,\n          ['image', getTransparentImageHash(action.meta.arg)],\n          action.payload.src,\n        )\n      }),\n})\n\nconst extraActions = {\n  loadDataResource,\n  processImage,\n}\nresource.actions = Object.assign(resource.actions, extraActions)\n\nexport default resource as typeof resource & {\n  actions: typeof extraActions\n}\n","import _ from 'lodash'\nimport classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport { TilemapLayer as TilemapLayerType, Map2D } from 'maptype'\nimport { useSelector, useDispatch } from 'react-redux'\nimport resource from 'store/resource'\nimport { useMapDef } from 'store/game'\nimport { getTransparentImageHash } from 'helpers/imageUtils'\n\nexport interface TilemapLayerProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  layerId: string\n  layerDef: TilemapLayerType\n}\n\nexport const TilemapLayer: React.FC<TilemapLayerProps> = (props) => {\n  const { className, layerId } = props\n  const dispatch = useDispatch()\n  const gridCount = useMapDef((state) => state.gridCount)\n  const gridSize = useMapDef((state) => state.gridSize)\n  const layerDef = useMapDef(\n    (state) => state.layerDefs[layerId],\n  ) as TilemapLayerType\n  const tilesetDef = useMapDef((state) =>\n    typeof layerDef.tileset === 'string'\n      ? state.tilesetDefs[layerDef.tileset]\n      : undefined,\n  )\n  const tilesetReady = true\n\n  const classes = useStyles({ ...layerDef, gridCount, gridSize })\n\n  const canvasRef = React.useRef<HTMLCanvasElement>(null)\n  const imgRef = React.useRef<HTMLImageElement>()\n\n  const processedImage = useSelector((state) =>\n    tilesetDef?.image.src\n      ? state.resource.image?.[getTransparentImageHash(tilesetDef.image)]\n      : undefined,\n  )\n\n  const finalSrc = processedImage || tilesetDef?.image.src\n\n  React.useEffect(() => {\n    if (!processedImage && tilesetDef?.image?.transparentColor) {\n      dispatch(resource.actions.processImage(tilesetDef.image))\n    }\n  }, [processedImage, tilesetDef?.image])\n\n  const [loadedSrc, handleLoaded] = React.useReducer(\n    (s: string, e: HTMLImageElement) => {\n      return e.src\n    },\n    '',\n  )\n  const lastRenderRef = React.useRef<{ src: string; tiles: Map2D<number> }>()\n  React.useLayoutEffect(() => {\n    console.log('rener')\n    const lastRender = lastRenderRef.current\n    const ctx = canvasRef.current?.getContext('2d')\n    const img = imgRef.current\n    if (!ctx || !img || !tilesetDef) return\n    if (!lastRender || lastRender.src !== loadedSrc) {\n      console.log('renessr')\n      _.forEach(layerDef.tiles, (row, y: any) => {\n        _.forEach(row, (tiledata, x: any) => {\n          ctx.imageSmoothingEnabled = false\n          ctx.clearRect(\n            gridSize.width * x,\n            gridSize.height * y,\n            gridSize.width,\n            gridSize.height,\n          )\n          if (tiledata == null) return\n          ctx.drawImage(\n            img,\n            (tiledata % tilesetDef.gridCount.width) * tilesetDef.gridSize.width,\n            Math.floor(tiledata / tilesetDef.gridCount.width) *\n              tilesetDef.gridSize.height,\n            tilesetDef.gridSize.width,\n            tilesetDef.gridSize.height,\n            gridSize.width * x,\n            gridSize.height * y,\n            gridSize.width,\n            gridSize.height,\n          )\n        })\n      })\n    } else {\n      _.forEach(layerDef.tiles, (row, y: any) => {\n        if (row !== lastRender?.tiles[y]) {\n          _.forEach(row, (tiledata, x: any) => {\n            if (tiledata !== lastRender.tiles[y]?.[x]) {\n              ctx.imageSmoothingEnabled = false\n              ctx.clearRect(\n                gridSize.width * x,\n                gridSize.height * y,\n                gridSize.width,\n                gridSize.height,\n              )\n              if (tiledata == null) return\n              ctx.drawImage(\n                img,\n                (tiledata % tilesetDef.gridCount.width) *\n                  tilesetDef.gridSize.width,\n                Math.floor(tiledata / tilesetDef.gridCount.width) *\n                  tilesetDef.gridSize.height,\n                tilesetDef.gridSize.width,\n                tilesetDef.gridSize.height,\n                gridSize.width * x,\n                gridSize.height * y,\n                gridSize.width,\n                gridSize.height,\n              )\n            }\n          })\n        }\n      })\n    }\n    lastRenderRef.current = {\n      src: loadedSrc,\n      tiles: layerDef.tiles,\n    }\n  }, [loadedSrc, layerDef.tiles, tilesetDef])\n\n  React.useEffect(() => {\n    if (!imgRef.current) {\n      imgRef.current = document.createElement('img')\n    }\n    const img = imgRef.current\n    if (img) {\n      img.src = finalSrc\n      img.onload = (e) => handleLoaded(finalSrc)\n    }\n  }, [finalSrc])\n\n  return tilesetReady ? (\n    <div className={classNames(className, classes.root)}>\n      <canvas\n        ref={canvasRef}\n        width={gridCount.width * gridSize.width}\n        height={gridCount.height * gridSize.height}\n      />\n    </div>\n  ) : null\n}\n\nTilemapLayer.defaultProps = {}\n\nexport default TilemapLayer\n","import TilemapLayer from './TilemapLayer'\n\nexport default TilemapLayer\n","// import _ from 'lodash'\nimport classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport MapType, { AllLayer } from 'maptype'\nimport ImageLayer from 'components/ImageLayer'\nimport ObjectLayer from 'components/ObjectLayer'\nimport { Provider, useSelector, useDispatch } from 'react-redux'\nimport CameraControl from 'components/CameraControl'\nimport store from 'store/store'\nimport { initMap, useMapDef } from 'store/game'\nimport TilemapLayer from 'components/TilemapLayer'\n\nexport interface GameMapProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  mapDef: MapType\n  overlay?: React.ReactNode\n}\n\nexport const Layer = React.memo(({ layerId }: { layerId: string }) => {\n  const classes = useStyles({})\n  const layerDef = useMapDef((state) => state.layerDefs[layerId])\n  const layerComponentRender = (layerId: string) => {\n    switch (layerDef.type) {\n      case 'image':\n        return (\n          <ImageLayer\n            className={classes.layer}\n            key={layerId}\n            layerId={layerId}\n            layerDef={layerDef}\n          />\n        )\n      case 'object':\n        return (\n          <ObjectLayer\n            className={classes.layer}\n            key={layerId}\n            layerId={layerId}\n            layerDef={layerDef}\n          />\n        )\n      case 'tilemap':\n        return (\n          <TilemapLayer\n            className={classes.layer}\n            key={layerId}\n            layerId={layerId}\n            layerDef={layerDef}\n          />\n        )\n      default:\n        return null\n    }\n  }\n  return layerComponentRender(layerId)\n})\n\nexport const MapLayerContainer = React.memo(() => {\n  const layerOrder = useMapDef((state) => state.layerOrder)\n\n  return (\n    <>\n      {layerOrder.map((layerId) => (\n        <Layer key={layerId} layerId={layerId} />\n      ))}\n    </>\n  )\n})\n\n// const TilesetProcessor = React.useMemo(() => {\n//   const tilesetDefs = useMapDef(state.pro)\n//   return null\n// })\n\nexport const GameMap: React.FC<GameMapProps> = (props) => {\n  const classes = useStyles(props)\n  const { className, mapDef, overlay } = props\n\n  const ready = useMapDef((state) => Boolean(state))\n  const loaded = useMapDef((state) => Boolean((state as any).loaded))\n  const dispatch = useDispatch()\n  React.useEffect(() => {\n    if (!ready) {\n      dispatch(initMap(mapDef))\n    }\n  }, [dispatch, ready, mapDef])\n\n  return (\n    <div className={classes.root}>\n      <CameraControl>\n        <MapLayerContainer />\n        {overlay}\n      </CameraControl>\n    </div>\n  )\n}\n\nexport const GameRoot = (props: GameMapProps) => {\n  return <GameMap {...props} />\n}\n\nexport default GameRoot\n","import GameMap from './GameMap'\n\nexport default GameMap\n","import createMuiTheme, {\n  ThemeOptions,\n  Theme,\n} from '@material-ui/core/styles/createMuiTheme'\nimport { Mixins, MixinsOptions } from '@material-ui/core/styles/createMixins'\nimport { CSSProperties } from '@material-ui/styles/withStyles'\nimport * as CSS from 'csstype'\nimport { Overrides } from '@material-ui/core/styles/overrides'\n\nimport { amber, red, grey } from '@material-ui/core/colors'\n\nconst flexDirectionCenter = {\n  row: { justifyContent: 'center' },\n  column: { alignItems: 'center' },\n}\n\nexport const sansFonts =\n  'Kanit, Sarabun, Prompt, \"Roboto\", \"Helvetica\", \"Arial\", sans-serif'\nexport const serifFonts =\n  'Sarabun, Prompt, \"Roboto\", \"Helvetica\", \"Arial\", sans-serif'\n\nexport const noiseImage = '' //createNoiseImage({ color: grey[500] })\n\nexport const overrides = (theme: Theme): Overrides => ({\n  MuiListItem: {\n    root: {\n      borderLeftStyle: 'solid',\n      borderLeftColor: theme.palette.primary.main,\n      borderLeftWidth: 0,\n    },\n  },\n  MuiFormControl: {\n    root: {\n      '&.border': {\n        borderColor: 'rgba(0,0,0,0.3)',\n        borderStyle: 'solid',\n        borderWidth: 1,\n        borderRadius: theme.shape.borderRadius,\n      },\n    },\n  },\n  MuiListItemText: {\n    root: {\n      '&.compact': {\n        display: 'none',\n      },\n    },\n  },\n  MuiExpansionPanelSummary: {\n    root: {\n      fontFamily: sansFonts,\n    },\n  },\n  MuiFormLabel: {\n    root: {\n      fontFamily: sansFonts,\n    },\n  },\n  MuiCssBaseline: {\n    '@global': {\n      body: {\n        backgroundColor: grey[700],\n        backgroundImage: `url(\"${noiseImage}\")`,\n        backgroundBlendMode: 'soft-light',\n      },\n      '@font-face': {\n        fontFamily: 'prompt',\n        unicodeRange: 'U+0E00-0E7F ',\n      },\n    },\n  },\n})\n\ndeclare module '@material-ui/core/styles/createMuiTheme' {\n  interface Theme {\n    drawer: CSSProperties\n    main: CSSProperties\n    sidebar: CSSProperties\n  }\n  interface ThemeOptions extends Partial<Theme> {}\n}\n\ndeclare module '@material-ui/core/styles/createMixins' {\n  interface Mixins {\n    flex: (\n      direction: CSS.FlexDirectionProperty,\n      ...option: string[]\n    ) => CSSProperties\n    imageAvatar: () => CSSProperties\n    mixBackgroundColor: (theme: Theme, color: string) => CSSProperties\n  }\n  interface MixinsOptions extends Partial<Mixins> {}\n}\n\ndeclare module '@material-ui/core/styles/createMixins' {\n  interface Mixins {\n    flex: (\n      direction: CSS.FlexDirectionProperty,\n      ...option: string[]\n    ) => CSSProperties\n    imageAvatar: () => CSSProperties\n    mixBackgroundColor: (theme: Theme, color: string) => CSSProperties\n  }\n  interface MixinsOptions extends Partial<Mixins> {}\n}\n\ndeclare module '@material-ui/core/styles/createTypography' {\n  interface Typography {\n    sansFonts: string\n    serifFonts: string\n  }\n  interface TypographyOptions extends Partial<Mixins> {}\n}\n\nexport const theme = {\n  palette: {\n    background: {\n      // default: grey[400],\n    },\n    type: 'dark',\n    primary: amber,\n    secondary: red,\n  },\n  mixins: {\n    flex: (direction: 'column' | 'row' = 'column', ...options) => ({\n      display: 'flex',\n      flexDirection: direction,\n      ...(options.includes('center') ? flexDirectionCenter[direction] : {}),\n      ...(options.includes('wrap') ? { flexWrap: 'wrap' } : {}),\n    }),\n    imageAvatar: () => ({\n      borderRadius: '12%',\n    }),\n    mixBackgroundColor: (theme, color) => ({\n      backgroundColor: color,\n      color: theme.palette.getContrastText(color),\n    }),\n  } as MixinsOptions,\n  drawer: {\n    width: 240,\n  },\n  main: {\n    width: 720,\n  },\n  sidebar: {\n    width: 300,\n    flex: '0 0 300px',\n  },\n  typography: {\n    fontSize: 14,\n    fontFamily: serifFonts,\n    sansFonts,\n    serifFonts,\n    // Tell Material-UI what the font-size on the html element is.\n    // htmlFontSize: 10,\n    h1: {\n      fontFamily: sansFonts,\n    },\n    h2: {\n      fontFamily: sansFonts,\n    },\n    h3: {\n      fontFamily: sansFonts,\n    },\n    h4: {\n      fontFamily: sansFonts,\n    },\n    h5: {\n      fontFamily: sansFonts,\n    },\n    h6: {\n      fontFamily: sansFonts,\n    },\n    // id: {\n    //   fontFamily: 'monospace',\n    //   fontSize: '0.7rem',\n    //   color: 'rgba(0,0,0,0.2)',\n    // },\n  },\n} as ThemeOptions\n\nexport default createMuiTheme(theme)\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      display: 'flex',\n    },\n    drawerPaper: {\n      backgroundColor: 'rgba(66, 66, 66, 0.5)',\n      maxWidth: '25vw',\n      boxShadow: theme.shadows[15],\n    },\n  }),\n  { name: 'GameEditor', index: 1 },\n)\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // style code\n    },\n    center: {\n      overflowY: 'auto',\n    },\n  }),\n  { name: 'LayerPanel', index: 1 },\n)\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      marginBottom: theme.spacing(1),\n      display: 'flex',\n      flexDirection: 'column',\n    },\n  }),\n  { name: 'PanelBase', index: 1 },\n)\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport Card from '@material-ui/core/Card'\nimport CardHeader from '@material-ui/core/CardHeader'\n\nexport interface PanelBaseProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  title?: string\n}\n\nexport const PanelBase: React.FC<PanelBaseProps> = (props) => {\n  const classes = useStyles(props)\n  const { className, title, children } = props\n\n  return (\n    <Card elevation={8} className={classNames(className, classes.root)}>\n      {title && <CardHeader title={title || 'unnamedpanel'} />}\n      {children}\n    </Card>\n  )\n}\n\nPanelBase.defaultProps = {}\n\nexport default PanelBase\n","import PanelBase from './PanelBase'\n\nexport default PanelBase\n","import _ from 'lodash'\nimport { createSlice, PayloadAction, createAsyncThunk } from '@reduxjs/toolkit'\nimport MapType, {\n  ImageLayer,\n  Rect,\n  Position,\n  TilemapLayer,\n  Size2D,\n  TilesetDef,\n  LayerType,\n} from 'maptype'\nimport { v4 as uuidv4 } from 'uuid'\nimport { times2D } from 'helpers/extralodash'\nimport { loadDataResource } from 'helpers/resourceUtils'\nimport { RootState } from './store'\n\nexport type EditorState = {\n  workingLayer: string | null\n  mapDef: MapType | null\n  isEditing: boolean\n  panel: {\n    tilemapLayerEditor: {\n      selected: Rect\n      paintMode: 'paint'\n    }\n  }\n  updatedTiles: {\n    layerId: string\n    tiles: { [tileId: string]: true }\n  } | null\n  dialog: { [dialogId: string]: any }\n}\n\nconst editorInitialState: EditorState = {\n  workingLayer: null,\n  mapDef: null,\n  isEditing: false,\n  panel: {\n    tilemapLayerEditor: {\n      selected: {\n        x: 0,\n        y: 0,\n        width: 1,\n        height: 1,\n      },\n      paintMode: 'paint',\n    },\n  },\n  updatedTiles: null,\n  dialog: {},\n}\n\nexport const importTileset = createAsyncThunk(\n  'importTileset',\n  async (\n    arg: {\n      tilesetId: string\n      applyToLayer?: string | true\n      localName?: string\n    },\n    thunk,\n  ) => {\n    const localId = uuidv4()\n    const url = arg.tilesetId\n    const applyToLayer: string | undefined =\n      arg.applyToLayer === true\n        ? (thunk.getState() as any).editor.workingLayer\n        : arg.applyToLayer\n    const data = await loadDataResource<TilesetDef>(url)\n    return {\n      tileDef: data,\n      localId,\n      localName: arg.localName || arg.tilesetId,\n      applyToLayer,\n    }\n  },\n)\n\nconst createDefaultMapDef = (): MapType => {\n  const layerId = uuidv4()\n\n  return {\n    gridCount: {\n      width: 36,\n      height: 18,\n    },\n    gridSize: {\n      width: 16,\n      height: 16,\n    },\n    layerOrder: [layerId],\n    layerDefs: {\n      [layerId]: {\n        type: 'tilemap',\n        tileset: '',\n        tiles: [],\n      },\n    },\n    objectDefs: {},\n    spriteDefs: {},\n    tilesetDefs: {},\n  }\n}\n\nexport const editor = createSlice({\n  name: 'editor',\n  initialState: editorInitialState,\n  reducers: {\n    initialize: {\n      prepare: (args: { mapDef?: MapType }) => {\n        return {\n          payload: { mapDef: args.mapDef || createDefaultMapDef() },\n        }\n      },\n      reducer: (state, action: PayloadAction<{ mapDef: MapType }>) => {\n        state.mapDef = action.payload.mapDef\n        state.isEditing = true\n        ;(state.mapDef as any).loaded = true\n        ;(state.mapDef as any).ready = true\n      },\n    },\n\n    selectWorkingLayer: (state, action: PayloadAction<{ layerId: string }>) => {\n      state.workingLayer = action.payload.layerId\n    },\n\n    addLayer: {\n      prepare: ({ layerType }: { layerType: LayerType }) => {\n        return {\n          payload: { layerType, layerId: uuidv4() },\n        }\n      },\n      reducer: (\n        state,\n        action: PayloadAction<{\n          layerId: string\n          layerType: LayerType\n        }>,\n      ) => {\n        const layerId = action.payload.layerId\n        const mapDef = state.mapDef\n        if (!mapDef) return\n        mapDef.layerOrder.push(layerId)\n        switch (action.payload.layerType) {\n          case 'image':\n            const imageLayer: ImageLayer = {\n              type: 'image',\n              localName: 'Image Layer',\n              src: '',\n              scale: { width: 1, height: 1 },\n              offset: { x: 0, y: 0 },\n            }\n            mapDef.layerDefs[layerId] = imageLayer\n            state.workingLayer = layerId\n            break\n          case 'tilemap':\n            const tilemapLayer: TilemapLayer = {\n              type: 'tilemap',\n              localName: 'Tilemap Layer',\n              tileset: { src: '' },\n              tiles: [],\n            }\n            mapDef.layerDefs[layerId] = tilemapLayer\n            state.workingLayer = layerId\n            break\n          default:\n            throw new Error('not support layer type')\n        }\n      },\n    },\n\n    setMapProperty: (\n      state,\n      action: PayloadAction<{\n        property: string | string[]\n        value: any\n      }>,\n    ) => {\n      if (state.mapDef)\n        _.set(state.mapDef, action.payload.property, action.payload.value)\n    },\n\n    setLayerProperty: (\n      state,\n      action: PayloadAction<{\n        layerId: string\n        property: string | string[]\n        value: any\n      }>,\n    ) => {\n      const layer = state.mapDef?.layerDefs[action.payload.layerId] as any\n      if (layer) _.set(layer, action.payload.property, action.payload.value)\n    },\n\n    setProperty: {\n      prepare: (name: string | string[], value: any) => ({\n        payload: { name, value },\n        meta: {},\n        error: null,\n      }),\n      reducer: (state, action) => {\n        _.set(state, action.payload.name, action.payload.value)\n      },\n    },\n\n    paintTileLayer: (\n      state,\n      action: PayloadAction<{\n        layerId: string\n        position: Position\n        tileGridCount: Size2D\n        startingPosition?: Position\n      }>,\n    ) => {\n      const {\n        layerId,\n        position,\n        tileGridCount,\n        startingPosition,\n      } = action.payload\n      const layer = state.mapDef?.layerDefs[layerId]\n      if (layer && layer.type === 'tilemap' && tileGridCount) {\n        const selectTileRect = state.panel.tilemapLayerEditor.selected\n        times2D(selectTileRect.width, selectTileRect.height, (dx, dy) => {\n          const px = position.x + dx\n          const py = position.y + dy\n          if (\n            px < state.mapDef!.gridCount.width &&\n            py < state.mapDef!.gridCount.height\n          ) {\n            if (!layer.tiles[py]) {\n              layer.tiles[py] = []\n            }\n\n            const newTileData =\n              tileGridCount.width *\n                (selectTileRect.y +\n                  (startingPosition\n                    ? (position.y -\n                        (startingPosition.y - selectTileRect.height * 10000) +\n                        dy) %\n                      selectTileRect.height\n                    : dy)) +\n              selectTileRect.x +\n              (startingPosition\n                ? (position.x -\n                    (startingPosition.x - selectTileRect.width * 10000) +\n                    dx) %\n                  selectTileRect.width\n                : dx)\n\n            layer.tiles[py][px] = newTileData\n          }\n        })\n      }\n    },\n\n    deleteLayer: (state, action: PayloadAction<{ layerId: string }>) => {\n      if (state.mapDef) {\n        const layerId = action.payload.layerId\n        state.mapDef.layerOrder = state.mapDef?.layerOrder.filter(\n          (s) => s !== layerId,\n        )\n        delete state.mapDef.layerDefs[layerId]\n        state.workingLayer = null\n      }\n    },\n\n    createTileset: {\n      prepare: ({\n        tilesetDef,\n        assignToLayer,\n      }: {\n        tilesetDef: TilesetDef\n        assignToLayer?: string | true\n      }) => {\n        return {\n          payload: { tilesetDef, tilesetId: uuidv4(), assignToLayer },\n          meta: {},\n          error: null,\n        }\n      },\n      reducer: (state, action) => {\n        if (state.mapDef) {\n          _.set(\n            state.mapDef,\n            ['tilesetDefs', action.payload.tilesetId],\n            action.payload.tilesetDef,\n          )\n\n          if (action.payload.assignToLayer) {\n            const layerDef = state.mapDef.layerDefs[\n              (action.payload.assignToLayer === true && state.workingLayer) ||\n                action.payload.assignToLayer\n            ] as TilemapLayer\n            layerDef.tileset = action.payload.tilesetId\n            return\n          }\n        }\n      },\n    },\n\n    rearrangeLayer: (\n      state,\n      action: PayloadAction<{ sourceIndex: number; targetIndex: number }>,\n    ) => {\n      if (state.mapDef) {\n        const layer = state.mapDef.layerOrder.splice(\n          action.payload.sourceIndex,\n          1,\n        )\n        state.mapDef.layerOrder.splice(action.payload.targetIndex, 0, ...layer)\n      }\n    },\n\n    openDialog: (\n      state,\n      action: PayloadAction<{ dialog: string; props?: any }>,\n    ) => {\n      state.dialog[action.payload.dialog] = action.payload.props ?? true\n    },\n\n    closeDialog: (state, action: PayloadAction<{ dialog: string }>) => {\n      delete state.dialog[action.payload.dialog]\n    },\n  },\n\n  extraReducers: (builder) =>\n    (builder.addCase(importTileset.fulfilled, (state, action) => {\n      if (state.mapDef) {\n        _.set(state.mapDef, ['tilesetDefs', action.payload.localId], {\n          ...action.payload.tileDef,\n          localName: action.payload.localName,\n        })\n        action.payload.applyToLayer &&\n          _.set(\n            state.mapDef,\n            ['layerDefs', action.payload.applyToLayer, 'tileset'],\n            action.payload.localId,\n          )\n      }\n    }) as unknown) as void,\n})\n\ntype EditerActions = typeof editor.actions & {\n  importTileset: typeof importTileset\n}\n\neditor.actions = Object.assign(editor.actions, { importTileset })\n\nexport default editor as typeof editor & { actions: EditerActions }\n","import _ from 'lodash'\n\nexport const times2D = <T extends any>(\n  x: number,\n  y: number,\n  fn: (x: number, y: number) => T,\n) => _.times(y, (j) => _.times(x, (i) => fn(i, j))).flatMap<T>(_.identity)\n","import { configureStore, combineReducers } from '@reduxjs/toolkit'\nimport { cameraReducer } from './camera'\nimport { gameReducer } from './game'\nimport editor, { EditorState } from './editor'\nimport { useSelector } from 'react-redux'\nimport { resource } from './resource'\nimport { persistStore, persistReducer } from 'redux-persist'\nimport storage from 'redux-persist/lib/storage'\n\nconst persistConfig = {\n  key: 'root',\n  storage,\n  blacklist: ['resource'],\n}\n\nconst store = configureStore({\n  reducer: persistReducer(\n    persistConfig,\n    combineReducers({\n      camera: cameraReducer,\n      map: gameReducer,\n      editor: editor.reducer,\n      resource: resource.reducer,\n    }),\n  ),\n})\n\nexport type RootState = ReturnType<typeof store.getState>\nexport type AppDispatch = typeof store.dispatch\n\nexport const useEditorState = <T extends any>(\n  selector: (editorState: EditorState) => T,\n) => useSelector((state) => selector(state.editor))\n\ndeclare module 'react-redux' {\n  interface DefaultRootState extends RootState {}\n}\n\nexport type ThunkConfig = {\n  dispatch: AppDispatch\n  state: RootState\n}\n\nexport const persistor = persistStore(store)\n\nexport default store\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport PanelBase from '../PanelBase'\nimport IconButton from '@material-ui/core/IconButton'\nimport CardActions from '@material-ui/core/CardActions'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Menu from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport { useEditorState } from 'store/store'\nimport { useDispatch } from 'react-redux'\nimport editor from 'store/editor'\nimport AddIcon from '@material-ui/icons/Add'\nimport DragHandleIcon from '@material-ui/icons/DragHandle'\n\nimport DeleteIcon from '@material-ui/icons/Delete'\nimport { LayerType } from 'maptype'\nimport {\n  DragDropContext,\n  Draggable,\n  Droppable,\n  DropResult,\n} from 'react-beautiful-dnd'\n\nexport interface LayerPanelProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n}\n\nexport const LayerPanel: React.FC<LayerPanelProps> = (props) => {\n  const classes = useStyles(props)\n  const { className } = props\n\n  const mapDef = useEditorState((state) => state.mapDef)\n  const workingLayer = useEditorState((state) => state.workingLayer)\n  const dispatch = useDispatch()\n  const handleLayerSelect = React.useCallback(\n    (e: React.MouseEvent<HTMLElement>) => {\n      const layerId = e.currentTarget.dataset.layerid\n      if (layerId) dispatch(editor.actions.selectWorkingLayer({ layerId }))\n    },\n    [],\n  )\n\n  const [menuOpen, setMenuOpen] = React.useState(false)\n  const addMenuAnchorRef = React.useRef<HTMLButtonElement>(null)\n  const handleAddLayer = React.useCallback(\n    (e: React.MouseEvent<HTMLElement>) => {\n      setMenuOpen(false)\n      const layerType = e.currentTarget.dataset.layertype as LayerType\n\n      if (layerType)\n        dispatch(\n          editor.actions.addLayer({\n            layerType,\n          }),\n        )\n    },\n    [],\n  )\n\n  const handleDelete = React.useCallback(() => {\n    workingLayer &&\n      dispatch(editor.actions.deleteLayer({ layerId: workingLayer }))\n  }, [workingLayer])\n\n  const handleRearrage = (result: DropResult) => {\n    if (result.destination) {\n      dispatch(\n        editor.actions.rearrangeLayer({\n          sourceIndex: mapDef!.layerOrder.length - result.source.index - 1,\n          targetIndex: mapDef!.layerOrder.length - result.destination.index - 1,\n        }),\n      )\n    }\n  }\n\n  return (\n    <DragDropContext onDragEnd={handleRearrage}>\n      <PanelBase title=\"Layer\">\n        <Droppable droppableId=\"layerpanel\" type=\"LAYER\">\n          {(dropProvided, snapshot) => {\n            return (\n              <List\n                className={classes.center}\n                ref={dropProvided.innerRef}\n                {...dropProvided.droppableProps}>\n                {mapDef?.layerOrder &&\n                  [...mapDef.layerOrder].reverse().map((layerId, index) => (\n                    <Draggable\n                      key={layerId}\n                      draggableId={layerId}\n                      index={index}>\n                      {(dragProvided, snapshot) => (\n                        <ListItem\n                          button\n                          ref={dragProvided.innerRef}\n                          {...dragProvided.draggableProps}\n                          data-layerid={layerId}\n                          selected={workingLayer === layerId}\n                          onClick={handleLayerSelect}\n                          divider>\n                          <ListItemText\n                            secondary={mapDef.layerDefs[layerId].type}>\n                            {mapDef.layerDefs[layerId]?.localName || layerId}\n                          </ListItemText>\n\n                          <span {...dragProvided.dragHandleProps}>\n                            <DragHandleIcon />\n                          </span>\n                        </ListItem>\n                      )}\n                    </Draggable>\n                  ))}\n                {dropProvided.placeholder}\n              </List>\n            )\n          }}\n        </Droppable>\n        <Menu\n          open={menuOpen}\n          anchorEl={addMenuAnchorRef.current}\n          onClose={() => setMenuOpen(false)}>\n          {/* <MenuItem data-layertype=\"object\" onClick={handleAddLayer}>\n            Object\n          </MenuItem> */}\n          <MenuItem data-layertype=\"image\" onClick={handleAddLayer}>\n            Image\n          </MenuItem>\n          <MenuItem data-layertype=\"tilemap\" onClick={handleAddLayer}>\n            Tilemap\n          </MenuItem>\n        </Menu>\n        <CardActions>\n          <IconButton ref={addMenuAnchorRef} onClick={() => setMenuOpen(true)}>\n            <AddIcon />\n          </IconButton>\n          <IconButton disabled={!workingLayer} onClick={handleDelete}>\n            <DeleteIcon />\n          </IconButton>\n        </CardActions>\n      </PanelBase>\n    </DragDropContext>\n  )\n}\n\nLayerPanel.defaultProps = {}\n\nexport default LayerPanel\n","import LayerPanel from './LayerPanel'\n\nexport default LayerPanel\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // style code\n    },\n    divider: {\n      marginTop: theme.spacing(1),\n      marginBottom: theme.spacing(1),\n    },\n  }),\n  { name: 'LayerWorkPanel', index: 1 },\n)\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // style code\n    },\n  }),\n  { name: 'EditorTextField', index: 1 },\n)\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport TextField, { TextFieldProps } from '@material-ui/core/TextField'\n\nexport type EditorTextFieldProps = TextFieldProps & {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  onUpdate?: (value: string) => void\n}\n\nexport const EditorTextField = (props: EditorTextFieldProps) => {\n  const classes = useStyles(props)\n  const { className, onUpdate, ...restProp } = props\n\n  const [isEditing, setEditing] = React.useState(false)\n  const [editedValue, setEditedValue] = React.useState('')\n\n  const propRef = React.useRef(props)\n  propRef.current = props\n  const handleFocus = React.useCallback(() => {\n    setEditing(true)\n    setEditedValue(propRef.current.value! as string)\n  }, [])\n  const handleBlur = React.useCallback(\n    (e: React.FocusEvent<HTMLInputElement>) => {\n      setEditing(false)\n      propRef.current.onUpdate?.(e.target.value)\n    },\n    [],\n  )\n  const handleChange = React.useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      setEditedValue(e.target.value)\n    },\n    [],\n  )\n  const handleKeyDown = React.useCallback(\n    (e: React.KeyboardEvent<HTMLInputElement>) => {\n      if (e.key === 'Enter') {\n        onUpdate?.((e.target as HTMLInputElement).value)\n      }\n      props.onKeyDown?.(e)\n    },\n    [props.onKeyDown, onUpdate],\n  )\n\n  return (\n    <TextField\n      {...restProp}\n      className={classNames(className, classes.root)}\n      onFocus={handleFocus}\n      onBlur={handleBlur}\n      onChange={handleChange}\n      onKeyDown={handleKeyDown}\n      value={isEditing ? editedValue : props.value}\n    />\n  )\n}\n\nEditorTextField.defaultProps = {}\n\nexport default EditorTextField\n","import EditorTextField from './EditorTextField'\n\nexport default EditorTextField\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\nimport { IZoomInputProps } from './ZoomInput'\n\nexport default makeStyles<IZoomInputProps>(\n  (theme: Theme) => ({\n    root: {\n      height: props => props.height,\n      paddingLeft: theme.spacing(1),\n      paddingRight: theme.spacing(1),\n    },\n\n    input: {\n      width: 48,\n      textAlign: 'right',\n    },\n  }),\n  { name: 'ZoomInput', index: 1 },\n)\n","import _ from 'lodash'\nimport * as React from 'react'\nimport useStyles from './styles'\n\nimport InputAdornment from '@material-ui/core/InputAdornment'\nimport IconButton from '@material-ui/core/IconButton'\nimport TextField from '@material-ui/core/TextField'\nimport ZoomInIcon from '@material-ui/icons/ZoomIn'\nimport ZoomOutIcon from '@material-ui/icons/ZoomOut'\n\nexport interface IZoomInputProps {\n  classes?: object\n  className?: string\n  onChange?: (value: number) => void\n  value: number\n  height?: number\n  min?: number\n  label?: string\n}\n\nexport const ZoomInput: React.FC<IZoomInputProps> = props => {\n  const classes = useStyles(props)\n  const { className, value, onChange, label, min = 0.1 } = props\n\n  const [internalValue, setInternalValue] = React.useState(value)\n  const [internalChanged, setInternalChanged] = React.useState(false)\n\n  const handleChange = React.useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      const v = e.target.value\n      const numVal = v.endsWith('%') ? v.substring(0, v.length - 1) : v\n      const numVal2 = Math.max(min, Math.round(Number(numVal)) / 100)\n      setInternalValue(numVal2)\n      setInternalChanged(true)\n    },\n    [min],\n  )\n\n  const handleBlur = React.useCallback(() => {\n    if (internalChanged) onChange && onChange(internalValue)\n    setInternalChanged(false)\n  }, [onChange, internalValue, internalChanged])\n\n  const handleInputKey = React.useCallback(\n    (e: React.KeyboardEvent) => {\n      if (e.key === 'Enter') handleBlur()\n    },\n    [handleBlur],\n  )\n\n  const handleZoomIn = React.useCallback(() => {\n    onChange && onChange(value + 0.1)\n  }, [value, onChange])\n\n  const handleZoomOut = React.useCallback(() => {\n    onChange && onChange(value - 0.1)\n  }, [value, onChange])\n\n  const InputProps = React.useMemo(\n    () => ({\n      classes,\n      startAdornment: (\n        <InputAdornment position=\"start\">\n          <IconButton disabled={value <= min + 0.0001} onClick={handleZoomOut}>\n            <ZoomOutIcon />\n          </IconButton>\n        </InputAdornment>\n      ),\n      endAdornment: (\n        <InputAdornment position=\"end\">\n          <IconButton onClick={handleZoomIn}>\n            <ZoomInIcon />\n          </IconButton>\n        </InputAdornment>\n      ),\n    }),\n    [classes, value, min, handleZoomIn, handleZoomOut],\n  )\n\n  return (\n    <TextField\n      className={className}\n      value={Math.floor((internalChanged ? internalValue : value) * 100) + '%'}\n      variant=\"outlined\"\n      InputProps={InputProps}\n      onBlur={handleBlur}\n      onChange={handleChange}\n      onKeyPress={handleInputKey}\n      label={label}\n    />\n  )\n}\n\nZoomInput.defaultProps = {}\n\nexport default ZoomInput\n","import ZoomInput from './ZoomInput'\n\nexport default ZoomInput\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\nimport { GridOverlayProps } from './GridOverlay'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      position: 'relative',\n    },\n    canvas: {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n    },\n    highlight: {\n      position: 'absolute',\n      backgroundColor: 'rgba(255,255,127,0.5)',\n      pointerEvents: 'none',\n    },\n    clickThrough: {\n      pointerEvents: 'none',\n    },\n    highlightPosition: (props: GridOverlayProps) => {\n      if (typeof props.highlight === 'object') {\n        return {\n          left: props.highlight.x * props.gridSize.width,\n          top: props.highlight.y * props.gridSize.height,\n          width: props.highlight.width * props.gridSize.height,\n          height: props.highlight.height * props.gridSize.height,\n        }\n      }\n      return {}\n    },\n  }),\n  { name: 'GridOverlay', index: 1 },\n)\n","import _ from 'lodash'\nimport classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport { Size2D, Position, Rect } from 'maptype'\n\nexport type GridEvent = {\n  grid: Position\n}\n\nexport type GridPointerEventHandler = (\n  p: GridEvent,\n  e: React.MouseEvent<HTMLCanvasElement>,\n) => void\n\nexport type GridOverlayProps = {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  gridSize: Size2D\n  gridCount: Size2D\n  strokeStyle?: CanvasFillStrokeStyles['strokeStyle']\n  highlight?: string | Rect\n  clickThrough?: boolean\n  onGridClick?: GridPointerEventHandler\n  onGridPointerDown?: GridPointerEventHandler\n  onGridPointerUp?: GridPointerEventHandler\n  onGridPointerMove?: GridPointerEventHandler\n} & React.HTMLAttributes<HTMLCanvasElement>\n\nexport const GridOverlay: React.FC<GridOverlayProps> = (props) => {\n  const classes = useStyles(props)\n  const {\n    className,\n    children,\n    gridSize,\n    gridCount,\n    strokeStyle = 'rgb(255,255,0)',\n    highlight = '',\n    clickThrough = false,\n    onGridClick,\n    onGridPointerDown,\n    onGridPointerUp,\n    onGridPointerMove,\n    ...restProp\n  } = props\n\n  const canvasRef = React.useRef<HTMLCanvasElement>(null)\n\n  const width = gridCount.width * gridSize.width\n  const height = gridCount.height * gridSize.height\n\n  React.useLayoutEffect(() => {\n    const ctx = canvasRef.current?.getContext('2d')\n    if (ctx) {\n      ctx.clearRect(0, 0, width, height)\n      ctx.beginPath()\n      _.times(gridCount.height + 1, (y) => {\n        ctx.moveTo(0, y * gridSize.height)\n        ctx.lineTo(width, y * gridSize.height)\n      })\n\n      _.times(gridCount.width + 1, (width) => {\n        ctx.moveTo(width * gridSize.width, 0)\n        ctx.lineTo(width * gridSize.width, height)\n      })\n      ctx.strokeStyle = strokeStyle\n      ctx.stroke()\n    }\n  }, [\n    width,\n    height,\n    gridSize.width,\n    gridSize.height,\n    gridCount.width,\n    gridCount.height,\n    strokeStyle,\n  ])\n\n  const determineGridPos = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    const canvasRect = e.currentTarget.getBoundingClientRect()\n    const xpos = e.clientX - canvasRect.x\n    const ypos = e.clientY - canvasRect.y\n    return {\n      x: Math.floor(\n        xpos /\n          (gridSize.width *\n            (canvasRect.width / (gridSize.width * gridCount.width))),\n      ),\n      y: Math.floor(\n        ypos /\n          (gridSize.height *\n            (canvasRect.height / (gridSize.height * gridCount.height))),\n      ),\n    }\n  }\n\n  const downPosRef = React.useRef<Position | null>(null)\n  const lastPosRef = React.useRef<Position | null>(null)\n  const handleClick = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    const pos = determineGridPos(e)\n    if (downPosRef.current?.x === pos.x && downPosRef.current?.y === pos.y) {\n      onGridClick?.({ grid: pos }, e)\n    }\n    restProp.onClick?.(e)\n  }\n\n  const handleMouseMove = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    const pos = determineGridPos(e)\n    const lastPos = lastPosRef.current\n\n    if (!lastPos || lastPos.x !== pos.x || lastPos.y !== pos.y) {\n      onGridPointerMove?.({ grid: pos }, e)\n    }\n    lastPosRef.current = pos\n    restProp.onMouseMove?.(e)\n  }\n\n  const handleMouseDown = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    const pos = determineGridPos(e)\n    downPosRef.current = pos\n    onGridPointerDown?.({ grid: pos }, e)\n    restProp.onMouseDown?.(e)\n  }\n\n  const handleMouseUp = (e: React.MouseEvent<HTMLCanvasElement>) => {\n    const pos = determineGridPos(e)\n    onGridPointerUp?.({ grid: pos }, e)\n    restProp.onMouseUp?.(e)\n  }\n\n  return (\n    <div className={classNames(className, classes.root)}>\n      {children}\n      <canvas\n        {...restProp}\n        ref={canvasRef}\n        width={width}\n        height={height}\n        className={classNames(classes.canvas, {\n          [classes.clickThrough]: clickThrough,\n        })}\n        onClick={handleClick}\n        onMouseMove={handleMouseMove}\n        onMouseDown={handleMouseDown}\n        onMouseUp={handleMouseUp}\n      />\n      {highlight && (\n        <div\n          className={classNames(classes.highlight, classes.highlightPosition)}\n        />\n      )}\n    </div>\n  )\n}\n\nGridOverlay.defaultProps = {}\n\nexport default GridOverlay\n","import GridOverlay from './GridOverlay'\n\nexport default GridOverlay\n","import _ from 'lodash'\nimport * as React from 'react'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Divider from '@material-ui/core/Divider'\nimport TextField from '@material-ui/core/TextField'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport { TilemapLayer, TilesetDef, Size2D, Position } from 'maptype'\nimport { useDispatch, useSelector } from 'react-redux'\nimport resource from 'store/resource'\nimport { useEditorState } from 'store/store'\nimport makeStyles from 'theme/makeStyles'\nimport clsx from 'clsx'\nimport editor from 'store/editor'\nimport ZoomInput from 'components/ZoomInput'\nimport GridOverlay from 'components/GridOverlay'\nimport { GridPointerEventHandler } from 'components/GridOverlay/GridOverlay'\nimport useGlobalEvent from 'hooks/useGlobalEvent'\nimport { useMapDef } from 'store/game'\nimport { getTransparentImageHash } from 'helpers/imageUtils'\n\nconst useStyles = makeStyles<{ gridSize?: Size2D; zoom: number }>(\n  (theme) => ({\n    imageContainer: {\n      maxWidth: '100%',\n      overflow: 'auto',\n      position: 'relative',\n    },\n    tile: {\n      borderRightStyle: 'dashed',\n      borderBottomStyle: 'dashed',\n      borderWidth: 1,\n      borderColor: 'rgba(255,0,255,0.4)',\n      position: 'absolute',\n    },\n    disableElementSelect: {\n      userSelect: 'none',\n    },\n    tileSize: ({ gridSize }) => {\n      return {\n        width: gridSize?.width,\n        height: gridSize?.height,\n      }\n    },\n    tileSelected: {\n      border: 'solid yellow 1px !important',\n    },\n    contentScale: ({ zoom }) => {\n      return {\n        transform: `scale(${zoom})`,\n        transformOrigin: '0 0',\n      }\n    },\n    divider: {\n      marginTop: theme.spacing(1),\n      marginBottom: theme.spacing(1),\n    },\n  }),\n  { index: 1 },\n)\n\nfunction TilemapLayerEditor({ layerId }: { layerId: string }) {\n  const layerDef = useEditorState(\n    (state) => state.mapDef!.layerDefs[layerId],\n  ) as TilemapLayer\n\n  const tilesetId =\n    typeof layerDef.tileset === 'string'\n      ? layerDef.tileset\n      : 'src' in layerDef.tileset\n      ? layerDef.tileset.src\n      : 'local'\n  const dispatch = useDispatch()\n  const tileResource = useMapDef(\n    (state) => state.tilesetDefs?.[tilesetId],\n  ) as TilesetDef\n  const imgSrc = tileResource?.image?.src\n\n  const processedImage = useSelector(\n    (state) =>\n      imgSrc &&\n      state.resource.image?.[getTransparentImageHash(tileResource.image)],\n  )\n\n  const finalImageSrc = processedImage || imgSrc\n\n  React.useEffect(() => {\n    if (!processedImage && tileResource?.image?.transparentColor) {\n      dispatch(resource.actions.processImage(tileResource?.image))\n    }\n  }, [processedImage, tileResource?.image])\n\n  console.log(processedImage)\n\n  const [zoom, setZoom] = React.useState(1)\n\n  const classes = useStyles({ ...tileResource, zoom })\n\n  const selectedTiles = useEditorState(\n    (state) => state.panel.tilemapLayerEditor.selected,\n  )\n\n  const tilesetDefs = useEditorState((state) => state.mapDef?.tilesetDefs)\n\n  const [mouseDownAt, setMouseDown] = React.useState<Position | null>(null)\n  const handleTileMouseDown = React.useCallback<GridPointerEventHandler>(\n    (p, e) => {\n      const pos = p.grid\n      if (pos) {\n        setMouseDown(pos)\n      }\n    },\n    [],\n  )\n\n  const handleTileClick = React.useCallback<GridPointerEventHandler>((p, e) => {\n    const pos = p.grid\n    if (pos) {\n      dispatch(\n        editor.actions.setProperty(\n          ['panel', 'tilemapLayerEditor', 'selected'],\n          { ...pos, width: 1, height: 1 },\n        ),\n      )\n    }\n  }, [])\n\n  const handleTileMouseEnter = React.useCallback<GridPointerEventHandler>(\n    (p, e) => {\n      const pos = p.grid\n\n      if (pos && mouseDownAt) {\n        const startPos = {\n          x: Math.min(mouseDownAt.x, pos.x),\n          y: Math.min(mouseDownAt.y, pos.y),\n        }\n        const size = {\n          width: Math.max(\n            1,\n            Math.abs(\n              startPos.x - (pos.x > mouseDownAt.x ? pos.x : mouseDownAt.x) - 1,\n            ),\n          ),\n          height: Math.max(\n            1,\n            Math.abs(\n              startPos.y - (pos.y > mouseDownAt.y ? pos.y : mouseDownAt.y) - 1,\n            ),\n          ),\n        }\n        dispatch(\n          editor.actions.setProperty(\n            ['panel', 'tilemapLayerEditor', 'selected'],\n            { ...startPos, ...size },\n          ),\n        )\n      }\n    },\n    [mouseDownAt],\n  )\n\n  useGlobalEvent('mouseup', () => setMouseDown(null), [])\n\n  const handleMenuSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    switch (e.target.value) {\n      case '$import':\n        dispatch(editor.actions.openDialog({ dialog: 'tilesetImporter' }))\n        return\n      case '$create':\n        dispatch(editor.actions.openDialog({ dialog: 'tilesetProperty' }))\n        return\n      case undefined:\n        return\n      default:\n        dispatch(\n          editor.actions.setLayerProperty({\n            layerId,\n            property: ['tileset'],\n            value: e.target.value,\n          }),\n        )\n    }\n  }\n\n  return (\n    <>\n      <TextField\n        fullWidth\n        label=\"Tileset ID\"\n        value={tilesetId}\n        select\n        onChange={handleMenuSelect}>\n        {_.map(tilesetDefs, (t, id) => (\n          <MenuItem key={id} value={id}>\n            {t.localName || 'unnamed tileset'}\n          </MenuItem>\n        ))}\n        <Divider className={classes.divider} />\n        <MenuItem value=\"$import\">Import tileset</MenuItem>\n        <MenuItem value=\"$create\">Create new tileset</MenuItem>\n      </TextField>\n      {tileResource && (\n        <>\n          <div\n            className={clsx(\n              classes.imageContainer,\n              classes.disableElementSelect,\n            )}>\n            <div className={classes.contentScale}>\n              <GridOverlay\n                gridCount={tileResource.gridCount}\n                gridSize={tileResource.gridSize}\n                onGridClick={handleTileClick}\n                onGridPointerMove={handleTileMouseEnter}\n                onGridPointerDown={handleTileMouseDown}\n                highlight={selectedTiles}>\n                <img src={finalImageSrc} alt={tilesetId} />\n              </GridOverlay>\n            </div>\n          </div>\n          <Toolbar>\n            <ZoomInput onChange={(v) => setZoom(v)} value={zoom} />\n          </Toolbar>\n        </>\n      )}\n    </>\n  )\n}\n\nexport default TilemapLayerEditor\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport PanelBase from '../PanelBase'\nimport { useEditorState } from 'store/store'\nimport { ImageLayer, LayerType, TilemapLayer, AllLayer } from 'maptype'\nimport EditorTextField from 'components/EditorTextField'\nimport { useDispatch } from 'react-redux'\nimport CardContent from '@material-ui/core/CardContent'\nimport TextField from '@material-ui/core/TextField'\nimport Grid from '@material-ui/core/Grid'\nimport editor from 'store/editor'\nimport TilemapLayerEditor from './TilemapLayerPanel'\n\nexport interface LayerWorkPanelProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n}\n\nexport const layerEditorComponent: Record<\n  LayerType,\n  React.ComponentType<{ layerId: string }>\n> = {\n  image: function ImageLayerEditor({ layerId }) {\n    const layerDef = useEditorState(\n      (state) => state.mapDef!.layerDefs[layerId],\n    ) as ImageLayer\n    const dispatch = useDispatch()\n    const handleSrcChange = (e: string) => {\n      dispatch(\n        editor.actions.setLayerProperty({ layerId, property: 'src', value: e }),\n      )\n    }\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n      dispatch(\n        editor.actions.setLayerProperty({\n          layerId,\n          property: e.target.name,\n          value: Number(e.target.value),\n        }),\n      )\n    }\n\n    return (\n      <CardContent>\n        <Grid container spacing={1}>\n          <Grid item xs={12}>\n            <EditorTextField\n              fullWidth\n              label=\"Image src\"\n              value={layerDef.src}\n              onUpdate={handleSrcChange}\n            />\n          </Grid>\n          <Grid item xs={6}>\n            <TextField\n              fullWidth\n              type=\"number\"\n              inputProps={{ step: 0.1 }}\n              value={layerDef.offset.x}\n              label=\"Offset X\"\n              onChange={handleChange}\n              name=\"offset.x\"\n            />\n          </Grid>\n          <Grid item xs={6}>\n            <TextField\n              fullWidth\n              type=\"number\"\n              inputProps={{ step: 0.1 }}\n              value={layerDef.offset.y}\n              label=\"Offset Y\"\n              onChange={handleChange}\n              name=\"offset.y\"\n            />\n          </Grid>\n          <Grid item xs={6}>\n            <TextField\n              fullWidth\n              type=\"number\"\n              inputProps={{ step: 0.1 }}\n              value={layerDef.scale.width}\n              label=\"Scale width\"\n              onChange={handleChange}\n              name=\"scale.width\"\n            />\n          </Grid>\n          <Grid item xs={6}>\n            <TextField\n              fullWidth\n              type=\"number\"\n              inputProps={{ step: 0.1 }}\n              value={layerDef.scale.height}\n              label=\"Scale height\"\n              onChange={handleChange}\n              name=\"scale.height\"\n            />\n          </Grid>\n        </Grid>\n      </CardContent>\n    )\n  },\n  object: function ObjectLayerEditor({ layerId }) {\n    const layerDef = useEditorState(\n      (state) => state.mapDef!.layerDefs[layerId],\n    ) as ImageLayer\n    return (\n      <>\n        <EditorTextField label=\"Image src\" value={layerDef.src} />\n      </>\n    )\n  },\n  tilemap: TilemapLayerEditor,\n}\n\nexport const LayerWorkPanel: React.FC<LayerWorkPanelProps> = (props) => {\n  const classes = useStyles(props)\n  const { className } = props\n\n  const workingLayer = useEditorState((state) => state.workingLayer)\n  const layerDef = useEditorState(\n    (state) =>\n      state.workingLayer && state.mapDef!.layerDefs[state.workingLayer],\n  ) as AllLayer\n  const LayerEditor = layerEditorComponent[layerDef?.type]\n  return (\n    <PanelBase\n      title={'Working on ' + (layerDef?.localName || '' + workingLayer)}>\n      {LayerEditor && <LayerEditor layerId={workingLayer!} />}\n    </PanelBase>\n  )\n}\n\nLayerWorkPanel.defaultProps = {}\n\nexport default LayerWorkPanel\n","import LayerWorkPanel from './LayerWorkPanel'\n\nexport default LayerWorkPanel\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\nimport { Size2D } from 'maptype'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // style code\n    },\n    gridContainer: {\n      position: 'absolute',\n    },\n    grid: {\n      borderRightStyle: 'dashed',\n      borderBottomStyle: 'dashed',\n      borderWidth: 2,\n      borderColor: 'rgba(255,0,255,0.4)',\n      position: 'absolute',\n    },\n    gridSize: ({ gridSize }: { gridSize: Size2D }) => ({\n      ...gridSize,\n    }),\n    gridTarget: {\n      backgroundColor: 'rgba(255,255,0,0.5)',\n    },\n  }),\n  { name: 'MapEditorOverlay', index: 1 },\n)\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport { useMapDef } from 'store/game'\nimport { useEditorState } from 'store/store'\nimport { Position } from 'maptype'\nimport { useDispatch, useStore } from 'react-redux'\nimport editor from 'store/editor'\nimport GridOverlay from 'components/GridOverlay'\nimport { GridPointerEventHandler } from 'components/GridOverlay/GridOverlay'\nimport useGlobalEvent from 'hooks/useGlobalEvent'\n\nexport interface MapEditorOverlayProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n}\n\nexport const MapEditorOverlay: React.FC<MapEditorOverlayProps> = (props) => {\n  const { className } = props\n\n  const dispatch = useDispatch()\n  const gridSize = useMapDef((state) => state.gridSize)\n  const gridCount = useMapDef((state) => state.gridCount)\n  const workingLayerId = useEditorState((state) => state.workingLayer)\n  const layerDef = useMapDef((state) =>\n    workingLayerId ? state.layerDefs[workingLayerId] : null,\n  )\n  const classes = useStyles({ gridSize })\n\n  const store = useStore()\n\n  const [hoverAt, setHoverAt] = React.useState<null | Position>(null)\n  const [mouseDownAt, setMouseDownAt] = React.useState<Position | null>(null)\n\n  const selected = useEditorState(\n    (state) => state.panel.tilemapLayerEditor.selected,\n  )\n\n  const highlight = React.useMemo(\n    () => ({\n      ...selected,\n      ...hoverAt,\n    }),\n    [selected, hoverAt],\n  )\n\n  const tilesetDef = useMapDef((state) => state.tilesetDefs)\n  useGlobalEvent('mouseup', (e) => e.button === 0 && setMouseDownAt(null), [])\n\n  const moveTargetGrid = React.useCallback<GridPointerEventHandler>(\n    (p, e) => {\n      const pos = p.grid\n      if (pos) {\n        setHoverAt(pos)\n\n        if (mouseDownAt && layerDef?.type === 'tilemap' && workingLayerId) {\n          const tileGridCount =\n            typeof layerDef.tileset === 'string'\n              ? tilesetDef[layerDef.tileset].gridCount\n              : 'gridCount' in layerDef.tileset\n              ? layerDef.tileset.gridCount\n              : store.getState().resource.tileset?.[layerDef.tileset.src]\n                  ?.gridCount\n\n          dispatch(\n            editor.actions.paintTileLayer({\n              layerId: workingLayerId,\n              position: pos,\n              startingPosition: mouseDownAt,\n              tileGridCount,\n            }),\n          )\n        }\n      }\n    },\n    [mouseDownAt, layerDef, workingLayerId, tilesetDef],\n  )\n\n  const handleMouseDown = React.useCallback<GridPointerEventHandler>(\n    (p, e) => {\n      const pos = p.grid\n      if (\n        e.button === 0 &&\n        workingLayerId &&\n        pos &&\n        layerDef?.type === 'tilemap'\n      ) {\n        setMouseDownAt(pos)\n\n        const tileGridCount =\n          typeof layerDef.tileset === 'string'\n            ? tilesetDef[layerDef.tileset].gridCount\n            : 'gridCount' in layerDef.tileset\n            ? layerDef.tileset.gridCount\n            : store.getState().resource.tileset?.[layerDef.tileset.src]\n                ?.gridCount\n\n        dispatch(\n          editor.actions.paintTileLayer({\n            layerId: workingLayerId,\n            position: pos,\n            startingPosition: pos,\n            tileGridCount,\n          }),\n        )\n      }\n    },\n    [layerDef, workingLayerId, tilesetDef],\n  )\n\n  return (\n    layerDef && (\n      <div\n        draggable={false}\n        className={classNames(className, classes.root, classes.gridContainer)}>\n        <GridOverlay\n          gridCount={gridCount}\n          gridSize={gridSize}\n          onGridPointerDown={handleMouseDown}\n          onGridPointerMove={moveTargetGrid}\n          highlight={highlight}\n        />\n      </div>\n    )\n  )\n}\n\nMapEditorOverlay.defaultProps = {}\n\nexport default MapEditorOverlay\n","import MapEditorOverlay from './MapEditorOverlay'\n\nexport default MapEditorOverlay\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // style code\n    },\n  }),\n  { name: 'MenuPanel', index: 1 },\n)\n","import _ from 'lodash'\nimport classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport PanelBase from '../PanelBase'\nimport Button from '@material-ui/core/Button'\nimport Dialog, { DialogProps } from '@material-ui/core/Dialog'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Grid from '@material-ui/core/Grid'\nimport IconButton from '@material-ui/core/IconButton'\nimport Menu from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport SettingsIcon from '@material-ui/icons/Settings'\nimport EditorTextField from 'components/EditorTextField'\nimport { useDispatch } from 'react-redux'\nimport editor from 'store/editor'\nimport { useMapDef } from 'store/game'\nimport YAML from 'yaml'\n\nexport interface MenuPanelProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n}\n\nconst MapPropertyDialog = (props: DialogProps) => {\n  const mapDef = useMapDef((s) => s) ?? null\n  const dispatch = useDispatch()\n  return (\n    mapDef && (\n      <Dialog {...props}>\n        <DialogTitle>Map Properties</DialogTitle>\n        <DialogContent>\n          <Grid container spacing={2}>\n            <Grid item xs={6}>\n              <EditorTextField\n                type=\"number\"\n                fullWidth\n                inputProps={{ max: 1024, min: 0 }}\n                name=\"gridSize.width\"\n                label=\"Tile width\"\n                value={mapDef.gridSize.width}\n                onUpdate={(value) =>\n                  dispatch(\n                    editor.actions.setMapProperty({\n                      property: 'gridSize.width',\n                      value: Number(value),\n                    }),\n                  )\n                }\n              />\n            </Grid>\n            <Grid item xs={6}>\n              <EditorTextField\n                type=\"number\"\n                fullWidth\n                inputProps={{ max: 1024, min: 0 }}\n                name=\"gridSize.height\"\n                label=\"Tile height\"\n                value={mapDef.gridSize.height}\n                onUpdate={(value) =>\n                  dispatch(\n                    editor.actions.setMapProperty({\n                      property: 'gridSize.height',\n                      value: Number(value),\n                    }),\n                  )\n                }\n              />\n            </Grid>\n            <Grid item xs={6}>\n              <EditorTextField\n                type=\"number\"\n                fullWidth\n                inputProps={{ max: 100, min: 0 }}\n                name=\"gridCount.width\"\n                label=\"Tile row\"\n                value={mapDef.gridCount.width}\n                onUpdate={(value) =>\n                  dispatch(\n                    editor.actions.setMapProperty({\n                      property: 'gridCount.width',\n                      value: Number(value),\n                    }),\n                  )\n                }\n              />\n            </Grid>\n            <Grid item xs={6}>\n              <EditorTextField\n                type=\"number\"\n                fullWidth\n                inputProps={{ max: 100, min: 0 }}\n                name=\"gridCount.height\"\n                label=\"Tile column\"\n                value={mapDef.gridCount.height}\n                onUpdate={(value) =>\n                  dispatch(\n                    editor.actions.setMapProperty({\n                      property: 'gridCount.height',\n                      value: Number(value),\n                    }),\n                  )\n                }\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={props.onClose as any}>Close</Button>\n        </DialogActions>\n      </Dialog>\n    )\n  )\n}\n\nexport const RawDataDialog = (props: DialogProps) => {\n  const mapDef = useMapDef((s) => s) ?? null\n  const dispatch = useDispatch()\n  const rawData = React.useMemo(() => {\n    return YAML.stringify(_.omit(mapDef, 'loaded', 'ready'))\n  }, [mapDef])\n  return (\n    mapDef && (\n      <Dialog {...props}>\n        <DialogTitle>MapDef Raw Data</DialogTitle>\n        <DialogContent>\n          <EditorTextField\n            multiline\n            fullWidth\n            variant=\"outlined\"\n            value={rawData}\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={props.onClose as any}>Close</Button>\n        </DialogActions>\n      </Dialog>\n    )\n  )\n}\n\nexport const MenuPanel: React.FC<MenuPanelProps> = (props) => {\n  const classes = useStyles(props)\n  const { className } = props\n\n  const [open, setOpen] = React.useState<string | null>(null)\n  const menuRef = React.useRef<HTMLButtonElement>(null)\n\n  const mapDef = useMapDef((s) => s)\n\n  const dispatch = useDispatch()\n\n  const handleAction = React.useCallback((e: React.MouseEvent<HTMLElement>) => {\n    setOpen(null)\n    const action = e.currentTarget.dataset.action\n    switch (action) {\n      case 'newmap':\n        dispatch(editor.actions.initialize({}))\n        return\n    }\n  }, [])\n\n  return (\n    <PanelBase className={classNames(className, classes.root)}>\n      <Toolbar>\n        <IconButton ref={menuRef} onClick={() => setOpen('menu')}>\n          <SettingsIcon />\n        </IconButton>\n      </Toolbar>\n\n      <Menu\n        anchorEl={menuRef.current}\n        open={open === 'menu'}\n        onClose={() => setOpen(null)}>\n        <MenuItem data-action=\"newmap\" onClick={handleAction}>\n          New map\n        </MenuItem>\n        <MenuItem onClick={() => setOpen('mapproperties')}>\n          Map properties\n        </MenuItem>\n        <MenuItem onClick={() => setOpen('rawdata')}>Raw data</MenuItem>\n      </Menu>\n\n      <MapPropertyDialog\n        open={open === 'mapproperties'}\n        onClose={() => setOpen(null)}\n      />\n      <RawDataDialog open={open === 'rawdata'} onClose={() => setOpen(null)} />\n    </PanelBase>\n  )\n}\n\nMenuPanel.defaultProps = {}\n\nexport default MenuPanel\n","import MenuPanel from './MenuPanel'\n\nexport default MenuPanel\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // style code\n    },\n    colorChipFocus: {\n      border: 'solid',\n    },\n    imgColorPick: {\n      cursor: 'crosshair',\n    },\n  }),\n  { name: 'TilesetPropertyDialog', index: 1 },\n)\n","import _ from 'lodash'\nimport classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport Button from '@material-ui/core/Button'\nimport IconButton from '@material-ui/core/IconButton'\nimport Dialog, { DialogProps } from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Chip from '@material-ui/core/Chip'\nimport Grid from '@material-ui/core/Grid'\nimport TextField from '@material-ui/core/TextField'\nimport AddCircleIcon from '@material-ui/icons/AddCircle'\nimport { Formik, Form, Field, FieldProps } from 'formik'\nimport { TilesetDef } from 'maptype'\nimport { useEditorState } from 'store/store'\nimport { useDispatch } from 'react-redux'\nimport editor from 'store/editor'\nimport GridOverlay from 'components/GridOverlay'\nimport { useTheme } from '@material-ui/core'\n\nexport interface TilesetPropertyDialogProps\n  extends Omit<DialogProps, 'open' | 'onClose'> {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n}\n\nconst initialTileDef: TilesetDef = {\n  gridCount: { width: 3, height: 3 },\n  gridSize: { width: 8, height: 8 },\n  offset: { x: 0, y: 0 },\n  image: { src: '', transparentColor: [] },\n  tileDefs: [],\n  localName: '',\n}\n\nexport const dialogName = 'tilesetProperty'\n\nconst ColorSelector = ({\n  classes,\n  field,\n  form,\n  focus,\n  onFocusChange,\n}: {\n  classes: ReturnType<typeof useStyles>\n  focus: null | number\n  onFocusChange: (i: number | null) => void\n} & FieldProps<string[]>) => {\n  const theme = useTheme()\n  const tryColor = (c: string) => {\n    try {\n      return {\n        backgroundColor: c,\n        color: theme.palette.getContrastText(c),\n      }\n    } catch (e) {\n      return undefined\n    }\n  }\n  return (\n    <>\n      {field.value.map((c, i) => (\n        <Chip\n          key={c}\n          style={tryColor(c)}\n          onClick={() => {\n            onFocusChange(i)\n          }}\n          className={classNames({ [classes.colorChipFocus]: focus === i })}\n          onDelete={(e) => {\n            onFocusChange(null)\n            form.setFieldValue(field.name, _.without(field.value, c))\n          }}\n          label={c}\n        />\n      ))}\n      <IconButton\n        onClick={() => {\n          const newV = _.uniq([...field.value, ''])\n          form.setFieldValue(field.name, newV)\n          onFocusChange(newV.length - 1)\n        }}>\n        <AddCircleIcon />\n      </IconButton>\n    </>\n  )\n}\n\nexport const TilesetPropertyDialog: React.FC<TilesetPropertyDialogProps> = (\n  props,\n) => {\n  const classes = useStyles(props)\n  const { className, ...rest } = props\n\n  const dispatch = useDispatch()\n  const open = useEditorState((state) => Boolean(state.dialog[dialogName]))\n  const handleClose = () => {\n    dispatch(editor.actions.closeDialog({ dialog: dialogName }))\n  }\n  const handleSave = (data: TilesetDef) => {\n    console.log(data)\n    dispatch(editor.actions.createTileset({ tilesetDef: data }))\n    dispatch(editor.actions.closeDialog({ dialog: dialogName }))\n  }\n\n  const canvasRef = React.useRef<HTMLCanvasElement>()\n  React.useEffect(() => {\n    canvasRef.current = document.createElement('canvas')\n  }, [])\n\n  const getColorOnImg = (e: React.MouseEvent<HTMLImageElement>) => {\n    const img = e.currentTarget\n    const ctx = canvasRef.current?.getContext('2d')\n    if (canvasRef.current && ctx) {\n      canvasRef.current.width = img.width\n      canvasRef.current.height = img.height\n      ctx.clearRect(0, 0, img.width, img.height)\n      ctx.drawImage(img, 0, 0)\n      const rect = img.getBoundingClientRect()\n      const x = e.pageX - rect.left\n      const y = e.pageY - rect.top\n      const data = ctx.getImageData(x, y, 1, 1).data\n      return `rgb(${data[0]},${data[1]},${data[2]})`\n    }\n  }\n\n  const [focusing, setFocus] = React.useState<number | null>(null)\n\n  return (\n    <Formik initialValues={initialTileDef} onSubmit={handleSave}>\n      <Dialog\n        {...rest}\n        onClose={handleClose}\n        open={open}\n        className={classNames(className, classes.root)}>\n        <Form>\n          <DialogTitle>Create a new tileset</DialogTitle>\n          <DialogContent>\n            <Grid container spacing={2}>\n              <Grid item xs={12}>\n                <Field\n                  fullWidth\n                  as={TextField}\n                  name=\"localName\"\n                  label=\"Tileset name\"\n                />\n              </Grid>\n              <Grid item xs={12}>\n                <Field\n                  fullWidth\n                  as={TextField}\n                  name=\"image.src\"\n                  label=\"Image URL\"\n                />\n              </Grid>\n              <Grid item xs={6}>\n                <Field\n                  fullWidth\n                  type=\"number\"\n                  as={TextField}\n                  name=\"gridCount.width\"\n                  label=\"Tile count horizontal\"\n                />\n              </Grid>\n              <Grid item xs={6}>\n                <Field\n                  fullWidth\n                  type=\"number\"\n                  as={TextField}\n                  name=\"gridCount.height\"\n                  label=\"Tile count vertical\"\n                />\n              </Grid>\n              <Grid item xs={6}>\n                <Field\n                  fullWidth\n                  type=\"number\"\n                  as={TextField}\n                  name=\"gridSize.width\"\n                  label=\"Tile width\"\n                />\n              </Grid>\n              <Grid item xs={6}>\n                <Field\n                  fullWidth\n                  type=\"number\"\n                  as={TextField}\n                  name=\"gridSize.height\"\n                  label=\"Tile height\"\n                />\n              </Grid>\n              <Grid item xs={12}>\n                Transparent color\n                <Field name=\"image.transparentColor\">\n                  {(fieldProps: FieldProps<string[]>) => {\n                    return (\n                      <ColorSelector\n                        {...fieldProps}\n                        classes={classes}\n                        focus={focusing}\n                        onFocusChange={setFocus}\n                      />\n                    )\n                  }}\n                </Field>\n              </Grid>\n              <Grid item xs={12}>\n                Preview\n                <Field>\n                  {({ form }: FieldProps) => (\n                    <GridOverlay\n                      gridCount={form.values.gridCount}\n                      gridSize={form.values.gridSize}\n                      clickThrough>\n                      <img\n                        className={classNames({\n                          [classes.imgColorPick]: focusing != null,\n                        })}\n                        src={form.values.image.src}\n                        onClick={(e) => {\n                          const c = getColorOnImg(e)\n                          form.setFieldValue(\n                            `image.transparentColor[${focusing}]`,\n                            c,\n                          )\n                        }}\n                        alt=\"Tileset preview\"\n                      />\n                    </GridOverlay>\n                  )}\n                </Field>\n              </Grid>\n            </Grid>\n          </DialogContent>\n          <DialogActions>\n            <Button type=\"submit\">Save</Button>\n          </DialogActions>\n        </Form>\n      </Dialog>\n    </Formik>\n  )\n}\n\nTilesetPropertyDialog.defaultProps = {}\n\nexport default TilesetPropertyDialog\n","import TilesetPropertyDialog from './TilesetPropertyDialog'\n\nexport default TilesetPropertyDialog\n","import makeStyles from 'theme/makeStyles'\nimport { Theme } from '@material-ui/core/styles'\n\nexport default makeStyles(\n  (theme: Theme) => ({\n    root: {\n      // style code\n    },\n  }),\n  { name: 'TilesetImporterDialog', index: 1 },\n)\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport Button from '@material-ui/core/Button'\nimport Dialog, { DialogProps } from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Radio from '@material-ui/core/Radio'\nimport TextField from '@material-ui/core/TextField'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\n\nimport { useDispatch } from 'react-redux'\nimport { useEditorState } from 'store/store'\nimport editor from 'store/editor'\n\nexport interface TilesetImporterDialogProps\n  extends Omit<DialogProps, 'open' | 'onClose'> {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n}\n\nconst importableTilesets = [\n  '/assets/tilesets/grasstown-tileset.yaml',\n  '/assets/tilesets/grasstown-tileset-transparent.yaml',\n]\n\nexport const dialogName = 'tilesetImporter'\n\nexport const TilesetImporterDialog: React.FC<TilesetImporterDialogProps> = (\n  props,\n) => {\n  const classes = useStyles(props)\n  const { className } = props\n\n  const [selected, setSelected] = React.useState('')\n  const [name, setName] = React.useState('')\n\n  const dispatch = useDispatch()\n  const open = useEditorState((state) => Boolean(state.dialog[dialogName]))\n  const handleClose = () => {\n    dispatch(editor.actions.closeDialog({ dialog: dialogName }))\n  }\n  const handleSelect = React.useCallback((e: React.MouseEvent<HTMLElement>) => {\n    const tileset = e.currentTarget.dataset.tileset\n    if (tileset) {\n      setSelected(tileset)\n    }\n  }, [])\n  const handleNameChange = React.useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      setName(e.target.value)\n    },\n    [],\n  )\n  const handleImport = async () => {\n    dispatch(\n      editor.actions.importTileset({\n        tilesetId: selected,\n        localName: name,\n        applyToLayer: true,\n      }),\n    )\n    handleClose()\n  }\n  return (\n    <Dialog\n      open={open}\n      onClose={handleClose}\n      className={classNames(className, classes.root)}>\n      <DialogTitle>Import tileset</DialogTitle>\n      <List>\n        {importableTilesets.map((id) => (\n          <ListItem\n            key={id}\n            data-tileset={id}\n            selected={selected === id}\n            button\n            onClick={handleSelect}>\n            <ListItemIcon>\n              <Radio checked={selected === id} />\n            </ListItemIcon>\n            <ListItemText>{id}</ListItemText>\n          </ListItem>\n        ))}\n      </List>\n      <DialogContent>\n        <TextField\n          fullWidth\n          label=\"As name\"\n          InputLabelProps={{\n            shrink: true,\n          }}\n          placeholder={selected}\n          onChange={handleNameChange}\n          value={name}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClose}>Close</Button>\n        <Button onClick={handleImport} disabled={!selected}>\n          Import\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nTilesetImporterDialog.defaultProps = {}\n\nexport default TilesetImporterDialog\n","import TilesetImporterDialog from './TilesetImporterDialog'\n\nexport default TilesetImporterDialog\n","import classNames from 'clsx'\nimport * as React from 'react'\nimport useStyles from './styles'\nimport MapType from 'maptype'\nimport GameMap from 'components/GameMap'\nimport Drawer from '@material-ui/core/Drawer'\nimport LayerPanel from './LayerPanel'\nimport { useEditorState } from 'store/store'\nimport { useDispatch } from 'react-redux'\nimport editor from 'store/editor'\nimport LayerWorkPanel from './LayerWorkPanel'\nimport MapEditorOverlay from './MapEditorOverlay'\nimport MenuPanel from './MenuPanel'\nimport TilesetPropertyDialog from './TilesetPropertyDialog'\nimport TilesetImporterDialog from './TilesetImporterDialog'\n\nexport interface GameEditorProps {\n  classes?: Partial<ReturnType<typeof useStyles>>\n  className?: string\n  mapDef: MapType\n}\n\nexport const GameEditor: React.FC<GameEditorProps> = (props) => {\n  const classes = useStyles(props)\n  const { className, mapDef } = props\n\n  const editorMapDef = useEditorState((state) => state.mapDef)\n  const isEditing = useEditorState((state) => state.isEditing)\n  const dispatch = useDispatch()\n\n  React.useEffect(() => {\n    if (!editorMapDef) {\n      dispatch(editor.actions.initialize({ mapDef }))\n    }\n  }, [mapDef, editorMapDef])\n\n  return isEditing && editorMapDef ? (\n    <div className={classNames(className, classes.root)}>\n      <GameMap mapDef={editorMapDef} overlay={<MapEditorOverlay />} />\n      <Drawer\n        classes={{ paper: classes.drawerPaper }}\n        open\n        variant=\"permanent\"\n        anchor=\"right\">\n        <LayerPanel />\n      </Drawer>\n      <Drawer\n        classes={{ paper: classes.drawerPaper }}\n        open\n        variant=\"permanent\"\n        anchor=\"left\">\n        <MenuPanel />\n        <LayerWorkPanel />\n      </Drawer>\n      <TilesetPropertyDialog />\n      <TilesetImporterDialog />\n    </div>\n  ) : null\n}\n\nGameEditor.defaultProps = {}\n\nexport default GameEditor\n","import GameEditor from './GameEditor'\n\nexport default GameEditor\n","import React from 'react'\nimport map1Def from 'mapdefs/demo1def.yaml'\nimport map2Def from 'mapdefs/demo2def.yaml'\nimport map3Def from 'mapdefs/demo3def.yaml'\nimport GameMap from 'components/GameMap'\nimport ThemeProvider from '@material-ui/styles/ThemeProvider'\nimport createMuiTheme from '@material-ui/core/styles/createMuiTheme'\nimport partialTheme from 'theme'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport { HashRouter, Route, Switch } from 'react-router-dom'\nimport GameEditor from 'components/GameEditor'\nimport store, { persistor } from 'store/store'\nimport { Provider } from 'react-redux'\nimport { PersistGate } from 'redux-persist/integration/react'\n\nconst theme = createMuiTheme(partialTheme)\n\nfunction App() {\n  return (\n    <HashRouter basename={process.env.PUBLIC_URL}>\n      <Provider store={store}>\n        <PersistGate loading={null} persistor={persistor}>\n          <ThemeProvider theme={theme}>\n            <CssBaseline>\n              <div className=\"App\">\n                <Switch>\n                  <Route path=\"/demo1\">\n                    <GameMap mapDef={map1Def} />\n                  </Route>\n                  <Route path=\"/demo2\">\n                    <GameMap mapDef={map2Def} />\n                  </Route>\n                  <Route path=\"/demo3\">\n                    <GameMap mapDef={map3Def} />\n                  </Route>\n\n                  <Route>\n                    <GameEditor mapDef={map3Def} />\n                  </Route>\n                </Switch>\n              </div>\n            </CssBaseline>\n          </ThemeProvider>\n        </PersistGate>\n      </Provider>\n    </HashRouter>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}