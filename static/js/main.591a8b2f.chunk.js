(this["webpackJsonprpg-map"]=this["webpackJsonprpg-map"]||[]).push([[0],{123:function(e,t){e.exports={gridCount:{width:22,height:18},gridSize:{width:64,height:64},layerOrder:["tilemap-base","tilemap-object","tilemap-51","tilemap-170"],layerDefs:{"tilemap-base":{type:"tilemap",tileset:"2921978c-5b34-4521-950a-9ef9890533ff",tiles:[[116,116,116,116,117,115,116,116,116,117,115,116,116,116,117,115,116,116,116,117,118,118],[138,138,138,138,139,137,138,138,138,139,137,138,138,138,139,137,138,138,138,139,140,118],[160,160,160,160,161,159,160,160,160,161,159,160,160,160,161,159,160,160,160,161,162,140],[325,133,134,135,329,325,326,327,328,329,325,326,327,328,329,325,326,327,328,329,325,162],[259,155,156,157,263,259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,70],[281,155,156,157,285,281,282,283,284,285,281,282,283,284,285,281,282,283,153,285,281,92],[303,155,156,157,307,303,304,305,306,307,303,304,305,306,307,303,304,305,153,307,303,114],[325,155,156,157,329,325,326,327,328,329,325,326,327,328,329,325,326,327,153,329,325,326],[259,155,156,157,263,259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260],[281,177,178,179,285,281,282,283,284,285,281,282,283,284,285,281,282,283,284,285,281,282],[303,304,305,306,307,303,304,305,306,307,303,304,305,306,307,303,304,305,306,307,303,304],[325,326,327,328,329,325,326,327,328,329,325,326,327,328,329,325,326,327,328,329,325,326],[259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260],[281,282,283,284,285,281,282,283,284,285,281,282,283,284,285,281,282,283,284,285,281,282],[303,304,305,306,307,303,304,305,306,307,303,304,305,306,307,303,304,305,306,307,303,304],[289,326,327,328,329,325,326,327,328,329,325,326,327,328,329,325,326,327,328,329,325,326],[259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260],[281,282,283,284,285,281,282,283,284,285,281,282,283,284,285,281,282,283,284,285,281,282]]},"tilemap-object":{type:"tilemap",tileset:"efc568e8-5bb2-48a7-8bec-6b8f88359486",tiles:[[262,263,259,260,261,262,263,259,260,261,262,263,259,260,261,262,263,259,260,261,338,263],[284,285,281,282,9,10,11,12,13,14,284,285,281,282,283,284,285,281,282,283,338,285],[2,23,23,23,31,32,33,34,35,36,306,22,23,24,305,306,307,303,304,305,338,307],[2,133,134,135,53,54,55,56,57,58,109,263,259,260,261,40,41,42,326,182,338,329],[2,112,112,157,75,76,77,78,79,80,131,285,281,282,40,62,63,64,109,261,338,263],[2,112,112,157,97,98,99,100,101,102,153,307,303,304,62,84,85,86,131,259,338,259],[2,112,156,112,119,120,121,122,123,124,175,329,325,326,84,106,107,108,182,182,338,259],[2,155,112,157,141,142,143,144,145,146,197,263,33,34,34,34,34,34,175,292,293,259],[2,112,156,157,163,164,165,166,167,168,284,285,55,56,55,56,57,58,197,294,183,259],[2,23,23,24,182,164,237,192,167,182,306,307,172,121,122,172,173,174,175,294,326,274],[259,1,185,185,327,328,329,192,326,327,328,329,194,143,144,194,195,196,197,314,317,296],[259,183,259,259,182,259,259,192,259,182,259,259,182,165,166,259,259,259,259,183,294,259],[259,259,259,259,259,259,259,192,259,182,182,182,259,259,259,259,259,259,259,259,294,259],[69,69,259,259,259,259,259,192,259,259,259,259,259,259,259,259,259,259,259,259,294,259],[288,288,291,259,259,259,259,236,239,239,239,237,239,239,239,239,259,259,259,259,294,259],[181,289,289,291,259,259,182,280,259,259,259,259,259,259,237,237,237,259,259,259,294,259],[259,183,259,313,259,182,259,280,259,259,259,259,259,259,259,259,259,259,259,259,294,259],[259,181,259,335,259,259,259,259,259,274,315,316,317,318,181,274,275,276,276,183,294,259]]},"tilemap-51":{type:"tilemap",tileset:"foresttest",tiles:[[15,16,17,18,19,20,21,15,16,17,8,9,20,21,15,16,17,18,19,20,21,15],[37,38,39,40,41,42,43,37,38,39,30,31,42,43,37,38,39,40,41,42,43,37],[59,60,61,62,63,64,65,59,60,61,52,53,64,65,59,60,61,62,63,64,65,59],[81,82,83,84,85,86,87,81,82,83,74,75,86,87,81,82,83,84,85,86,87,81],[103,104,105,106,107,108,109,103,104,105,106,107,108,109,103,104,105,106,107,108,109,103],[125,126,127,128,129,130,131,125,126,127,128,129,130,131,125,126,127,128,129,130,131,125],[147,148,149,150,151,152,153,147,148,149,150,151,152,153,147,148,149,150,151,152,8,9],[169,170,171,172,173,174,130,131,125,126,127,128,129,130,131,125,126,127,8,9,30,31],[153,147,148,149,150,151,152,153,147,148,149,150,151,152,153,147,148,149,30,31,52,53],[12,13,170,171,172,173,174,175,169,170,171,172,173,174,175,169,170,171,52,53,74,75],[34,35,16,17,18,19,20,21,15,16,17,18,19,20,21,15,16,17,74,75,20,21],[56,57,38,39,40,41,42,43,37,38,39,40,41,42,43,37,38,39,8,9,42,43],[78,79,60,61,62,63,64,65,59,60,61,62,63,64,65,59,60,61,30,31,64,65],[87,81,82,83,84,85,86,87,81,82,83,84,85,86,87,81,82,83,52,53,86,87],[109,103,104,105,106,107,108,109,103,104,105,106,107,108,109,103,104,105,74,75,108,109],[131,125,126,127,128,129,130,131,125,126,127,128,129,130,131,125,126,127,128,129,130,131],[153,147,148,149,150,151,152,153,147,148,149,150,151,152,153,147,148,149,150,151,152,153],[175,169,170,171,172,173,174,175,169,170,171,172,173,174,175,169,170,171,172,173,174,175]]},"tilemap-170":{type:"tilemap",tileset:"foresttest",tiles:[[15,16,17,18,19,20,21,15,16,17,18,19,20,21,15,16,17,18,19,20,21,15],[37,38,39,40,41,42,43,37,38,39,40,12,13,43,37,38,39,40,41,42,43,37],[59,60,61,62,63,64,65,59,60,61,62,34,35,65,59,60,61,62,63,64,65,59],[81,82,83,84,85,86,87,81,82,83,84,56,57,87,81,82,83,84,85,86,87,81],[103,104,105,106,107,108,109,103,104,105,106,78,79,109,103,104,105,106,107,108,109,103],[125,126,127,128,129,130,131,125,126,127,128,129,130,131,125,126,127,128,129,130,131,125],[147,148,149,150,151,152,153,147,148,149,150,151,152,153,147,148,149,150,151,152,153,147],[169,170,171,172,173,174,175,169,170,171,172,173,174,175,169,170,171,172,173,174,175,169],[15,16,17,18,19,20,21,15,16,17,18,19,20,21,15,16,17,18,19,8,9,15],[37,38,39,40,41,42,43,37,38,39,40,41,42,43,37,38,8,9,41,30,31,37],[59,12,13,62,63,64,65,59,60,148,149,150,151,152,153,147,30,31,63,52,53,59],[81,34,35,84,85,86,87,175,169,170,171,172,173,174,175,169,52,53,85,74,75,81],[103,56,57,106,107,108,109,21,15,16,17,18,19,20,21,15,74,8,9,108,109,103],[125,78,79,128,129,130,131,43,37,38,39,40,41,42,43,37,127,30,31,8,9,125],[147,148,149,150,151,152,153,65,59,60,61,62,63,64,65,59,149,52,53,30,31,147],[169,170,171,172,173,174,175,87,81,82,83,84,85,86,87,81,171,74,75,52,53,169],[15,16,17,18,19,20,21,109,103,104,105,106,107,108,109,103,17,18,19,74,75,15],[37,38,39,40,41,42,43,131,125,126,127,128,129,130,131,125,39,40,41,42,43,37]]}},loaded:!0,ready:!0,tilesetDefs:{"2921978c-5b34-4521-950a-9ef9890533ff":{gridCount:{width:22,height:18},gridSize:{width:16,height:16},image:{src:"/assets/tilesets/tiles-map.png"},tileDefs:{231:{animation:{frames:[231,253],frametime:700}}},localName:"BaseTile"},"efc568e8-5bb2-48a7-8bec-6b8f88359486":{gridCount:{width:22,height:18},gridSize:{width:16,height:16},image:{src:"/assets/tilesets/transparent-bg-tiles.png"},tileDefs:{231:{animation:{frames:[231,253],frametime:700}}},localName:"Transparent"},foresttest:{gridCount:{width:22,height:18},gridSize:{width:16,height:16},image:{src:"data:image/png;base64,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",transparentColor:["white"]},tileDefs:{231:{animation:{frames:[231,253],frametime:700}}},localName:"Forest"}}}},171:function(e,t){e.exports={gridCount:{width:36,height:24},gridSize:{width:70,height:70},layerOrder:["imagelayer1","objectlayer1"],layerDefs:{imagelayer1:{type:"image",src:"/assets/map.png"},objectlayer1:{type:"object",walkable:[[0,0,0,0,0,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,0,0,0,0,0,0,0],[0,0,0,0,0,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,0,0,0,0,0],[8,8,8,8,0,0,8,8,0,0,0,8,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,0,0,0,0],[0,8,8,8,8,0,0,8,0,0,8,8,0,0,0,0,0,0,0,8,8,8,8,0,0,0,0,8,8,8,8,8,8,0,0,0],[0,8,8,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,0,8,8,8,0,0,0,0,0,0,8,8,8,8,8,8,0,0],[0,8,8,0,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,8,8,8,0,0,0,0,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,8,8,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,8,8,0,0,0,0,8,8,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,8,8,8,0,0,8,0,0,0,0,8,8,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,8,8,8,0,0,8,8,8,8,0,8,8,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,8,8,8,0,0,0,8,8,8,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,8,8,8,0,0,0,0,0,8,8,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,8,0,0,0,0,8,8,8,8,8,8,8,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,8,0,0,0,8,8,8,8,8,8,8,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,8,8,8,8,8,8,8,0,0,8,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,8,0,0,0,8,8,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,0,8,8,8,8,8,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,8,8,8,0,8,8,8,8,8,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,8,8,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]]}},objectDefs:{hero1:{sprite:"hero1",layer:"objectlayer1",group:1,position:{x:2,y:12},stat:{movementRange:4}},hero2:{sprite:"hero1",layer:"objectlayer1",group:1,position:{x:6,y:4},stat:{movementRange:15}}},spriteDefs:{hero1:{type:"image",src:"/assets/demo2/hero1.png"}}}},172:function(e,t){e.exports={gridCount:{width:22,height:12},gridSize:{width:50,height:50},layerOrder:["imagelayer1","objectlayer1"],layerDefs:{imagelayer1:{type:"image",src:"/assets/demo2/map.png"},objectlayer1:{type:"object",walkable:{src:"/assets/demo2/walkabledef.png"}}},objectDefs:{hero1:{sprite:"hero1",layer:"objectlayer1",group:1,position:{x:4,y:3},stat:{movementRange:4}},hero2:{sprite:"hero1",layer:"objectlayer1",group:1,position:{x:6,y:4},stat:{movementRange:4}}},spriteDefs:{hero1:{type:"image",src:"/assets/demo2/hero1.png"}}}},209:function(e,t,a){e.exports=a(343)},214:function(e,t,a){},343:function(e,t,a){"use strict";a.r(t);var n,r,i=a(0),o=a.n(i),l=a(15),c=a.n(l),u=(a(214),a(171)),s=a.n(u),A=a(172),d=a.n(A),m=a(123),f=a.n(m),p=a(173),g=a.n(p),h=a(410),y=function(e,t){return Object(h.a)(e,g()(t,"name"))},v=y((function(e){return{root:{},layer:{position:"absolute",top:0,left:0,userSelect:"none"}}}),{name:"GameMap",index:1}),b=a(3),E=y((function(e){return{root:{}}}),{name:"ImageLayer",index:1}),w=function(e){return e&&e.startsWith("/")?"/rpg-map"+e:e},x=a(16),j=a(19),C=a(18),O=a.n(C),k=a(30),D=a(9),S=a.n(D),P=a(17),L=a(175),T=a.n(L),I=a(37),z=a(53),M=function(e){return[{x:e.x+1,y:e.y},{x:e.x-1,y:e.y},{x:e.x,y:e.y-1},{x:e.x,y:e.y+1}]},N=function(e,t){var a=e.x-t.x,n=e.y-t.y;return Math.sqrt(a*a+n*n)},R=function(e,t,a,n,r){return t<=e.x&&e.x<n&&a<=e.y&&e.y<r},B=function(e){return"".concat(e.x,",").concat(e.y)};n=Symbol.iterator,r=Symbol.toStringTag;var F=function(){function e(){Object(I.a)(this,e),this.internalSet=void 0,this[r]=void 0,this.internalSet=new Set}return Object(z.a)(e,[{key:"clear",value:function(){return this.internalSet.clear()}},{key:"forEach",value:function(e,t){throw new Error("Method not implemented.")}},{key:n,value:function(){throw new Error("Method not implemented.")}},{key:"entries",value:function(){throw new Error("Method not implemented.")}},{key:"keys",value:function(){throw new Error("Method not implemented.")}},{key:"values",value:function(){throw new Error("Method not implemented.")}},{key:"add",value:function(e){return this.internalSet.add(B(e)),this}},{key:"has",value:function(e){return this.internalSet.has(B(e))}},{key:"delete",value:function(e){return this.internalSet.delete(B(e))}},{key:"size",get:function(){return this.internalSet.size}}]),e}(),W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t){return setTimeout(t,e)}))},G=a(91),Y=a.n(G),K=function(){var e=Object(k.a)(O.a.mark((function e(t){var a,n,r,i,o,l,c,u;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=w(t),e.next=3,fetch(a);case 3:if(n=e.sent,r=n.headers.get("content-type")){e.next=7;break}throw new Error("unable to determine content-type:"+a);case 7:i=r.split(/;\s*/i),o=Object(x.a)(i,1),l=o[0],e.t0=l,e.next="text/yaml"===e.t0?11:"text/json"===e.t0?16:17;break;case 11:return e.next=13,n.text();case 13:return c=e.sent,u=Y.a.parse(c),e.abrupt("return",u);case 16:return e.abrupt("return",n.json());case 17:throw new Error("unsupport mime: "+l+" : "+a);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(k.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var n=document.createElement("img");n.src=w(t),n.onload=function(){return e(n)},n.onerror=a})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=a(8),q=function(e){return Object(X.d)((function(t){return t.editor.isEditing?e(t.editor.mapDef):e(t.map)}))},Z=Object(P.c)("initMap",function(){var e=Object(k.a)(O.a.mark((function e(t,a){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.dispatch,a.getState,n=t.tilesetDefs,S.a.forEach(n,(function(e,t){})),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),H=function(e){var t=e.map,a=e.gridCount,n=e.origin,r=e.destination,i=e.passthrough,o=void 0===i?0:i,l=e.range,c=void 0===l?1/0:l,u=new T.a({comparator:function(e,t){return N(e,r)-N(t,r)}}),s=new F,A=new Map,d=new Map,m=!1;M(n).forEach((function(e){!R(e,0,0,a.width,a.height)||0!==t[e.y][e.x]&&0!==(t[e.y][e.x]^o)||(u.queue(e),A.set(B(e),B(n)),d.set(B(e),c))}));var f=function(){var e,a,n=u.dequeue();if(!s.has(n)){if(s.add(n),a=r,(e=n).x===a.x&&e.y===a.y)return m=!0,"break";var i=d.get(B(n));if(null==i||i<0)return"continue";M(n).forEach((function(e){s.has(e)||0!==t[e.y][e.x]&&0!==(t[e.y][e.x]^o)||(u.queue(e),A.set(B(e),B(n)),d.set(B(e),i-1))}))}};e:for(;u.length>0;){switch(f()){case"break":break e;case"continue":continue}}if(m){var p=B(r),g=[p];do{if((p=A.get(p))&&g.push(p),p===B(n))return g}while(p&&A.size>0)}},U=function(e,t){var a=e.objectDefs[t],n=e.layerDefs[a.layer],r=S.a.cloneDeep(n.walkable),i=S.a.pickBy(e.objectDefs,(function(e){return e.layer===a.layer}));return S.a.forEach(i,(function(e){var t=e.group,n=e.position,i=S.a.get(r,[n.y,n.x]);S.a.set(r,[n.y,n.x],t&&a.group?0===(a.group^t)?t:0:i)})),r},J=Object(P.b)("selectObject"),Q=Object(P.b)("deselectObject"),$=Object(P.b)("moveObject"),_=Object(P.c)("walkObject",function(){var e=Object(k.a)(O.a.mark((function e(t,a){var n,r,i,o,l,c,u,s,A,d;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.dispatch,i=a.getState,o=i(),l="objectId"in t?t.objectId:o.map.selected,c=o.map.objectDefs[l],u=U(o.map,l),s=H({map:u,origin:c.position,destination:t.destination,passthrough:c.group,gridCount:o.map.gridCount,range:null===(n=c.stat)||void 0===n?void 0:n.movementRange})){e.next=8;break}throw new Error("path-invalid");case 8:if(!s.length){e.next=16;break}return A=s.pop().split(",").map(Number),d={x:A[0],y:A[1]},r($({destination:d,objectId:l})),e.next=14,W(300);case 14:e.next=8;break;case 16:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),ee=Object(P.c)("prepareLayerResource",function(){var e=Object(k.a)(O.a.mark((function e(t,a){var n,r,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.getState,r=n().map,i={},e.next=5,Promise.all(Object.keys(r.layerDefs).map(function(){var e=Object(k.a)(O.a.mark((function e(t){var a,n,o,l,c,u;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("walkable"in(a=r.layerDefs[t]))||!("src"in a.walkable)){e.next=14;break}return e.next=4,V(a.walkable.src);case 4:if(n=e.sent,(o=document.createElement("canvas")).width=n.width,o.height=n.height,l=o.getContext("2d")){e.next=11;break}throw new Error("not-support-canvas");case 11:l.drawImage(n,0,0,n.width,n.height),c=S.a.times(r.gridCount.height,(function(e){return S.a.times(r.gridCount.width,(function(t){return l.getImageData(t*r.gridSize.width+r.gridSize.width/2,e*r.gridSize.height+r.gridSize.height/2,1,1).data[0]?-1:0}))})),S.a.set(i,[t,"walkable"],c);case 14:if(!("tileset"in a)||"object"!==typeof a.tileset||!("src"in a.tileset)){e.next=19;break}return e.next=17,K(a.tileset.src);case 17:u=e.sent,S.a.set(i,[t,"tileset"],u);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),te=Object(P.d)(null,(function(e){return e.addCase(Z.pending,(function(e,t){return Object(j.a)({},S.a.cloneDeep(t.meta.arg),{selected:null,animating:!1,moveableDisplay:null,loaded:!1})})).addCase(Z.fulfilled,(function(e,t){e.loaded=!0})).addCase(ee.fulfilled,(function(e,t){Object.keys(t.payload).forEach((function(a){e.layerDefs[a]=Object(j.a)({},e.layerDefs[a],{},t.payload[a])}))})).addCase(J,(function(e,t){var a=S.a.cloneDeep(U(e,t.payload)),n=e.objectDefs[t.payload];if(null===n||void 0===n?void 0:n.stat.movementRange){e.selected=t.payload,e.moveableDisplay={};var r=new F,i=[[n.position,n.stat.movementRange]];r.add(n.position);var o=function(){var t=i.shift()||[],o=Object(x.a)(t,2),l=o[0],c=o[1],u=void 0===c?-1:c;return l?u<0?"continue":(0===S.a.get(a,[l.y,l.x])&&(e.moveableDisplay[B(l)]=!0),r.add(l),void M(l).filter((function(t){return R(t,0,0,e.gridCount.width,e.gridCount.height)&&(0===S.a.get(a,[t.y,t.x])||S.a.get(a,[t.y,t.x])===n.group)&&!r.has(t)})).forEach((function(e){return i.push([e,u-1])}))):{v:void 0}};do{var l=o();switch(l){case"continue":continue;default:if("object"===typeof l)return l.v}}while(i.length)}})).addCase(Q,(function(e,t){e.selected=null,e.moveableDisplay=null})).addCase($,(function(e,t){e.objectDefs[t.payload.objectId].position=t.payload.destination,e.selected=null,e.moveableDisplay=null})).addCase(_.pending,(function(e,t){e.animating=!0})).addCase(_.fulfilled,(function(e,t){e.animating=!1}))})),ae=function(e){var t=E(e),a=e.className,n=e.layerId,r=e.layerDef,o=q((function(e){return e.gridSize}));return i.createElement("div",{className:Object(b.a)(a,t.root)},i.createElement("img",{style:{transform:"translate(".concat(o.width*r.offset.x,"px,").concat(o.height*r.offset.y,"px) scale(").concat(r.scale.width,", ").concat(r.scale.height,")")},src:w(r.src),alt:n}))};ae.defaultProps={};var ne=ae,re=a(25),ie=y((function(e){return{root:{},tileSize:function(e){return{width:e.width,height:e.height}},tile:{backgroundColor:"rgba(255,0,0,0.3)",position:"absolute",borderStyle:"solid",borderColor:"rgba(255,0,0,0.3)",borderWidth:1},walkable:{backgroundColor:"unset",borderColor:"rgba(0,255,0,0.1)"},displayMove:{backgroundColor:"rgba(0,255,0,0.3)",cursor:"cell"}}}),{name:"ObjectLayer",index:1}),oe=y((function(e){return{root:{position:"absolute",userSelect:"none"},selectable:{cursor:"pointer"}}}),{name:"GameObject",index:1}),le=a(129),ce=function(e){var t=oe(e),a=e.className,n=e.objectId,r=Object(X.c)(),o=Object(X.d)((function(e){return e.map.gridSize})),l=Object(X.d)((function(e){return e.map.objectDefs[n]})),c=Object(X.d)((function(e){return e.map.spriteDefs[l.sprite]})),u=Object(X.d)((function(e){return!e.map.animating})),s=Object(le.b)({transform:"translate(".concat(o.width*l.position.x,"px,").concat(o.height*l.position.y,"px)"),config:{duration:270}});switch(c.type){case"image":return i.createElement(le.a.img,{alt:"".concat(n,":").concat(l.sprite),className:Object(b.a)(a,t.root,Object(re.a)({},t.selectable,u)),style:s,src:w(c.src),onClick:u?function(){r(J(n))}:void 0,draggable:!1});default:return null}};ce.defaultProps={};var ue=ce,se=i.memo((function(e){var t,a=e.x,n=e.y,r=e.classes,o=e.layerId,l=Object(X.d)((function(e){return e.map.gridSize})),c=Object(X.d)((function(e){var t;return null===(t=e.map.moveableDisplay)||void 0===t?void 0:t[a+","+n]})),u=Object(X.d)((function(e){var t,r=null===(t=e.map.layerDefs)||void 0===t?void 0:t[o];return"walkable"in r&&0===r.walkable[n][a]})),s=Object(X.c)();return i.createElement("div",{key:n+":"+a,style:{top:n*l.height,left:a*l.width},className:Object(b.a)(r.tile,r.tileSize,(t={},Object(re.a)(t,r.walkable,u),Object(re.a)(t,r.displayMove,u&&c),t)),onClick:u&&c?function(){return s(_({destination:{x:a,y:n}}))}:void 0})})),Ae=i.memo((function(e){var t=e.layerId,a=Object(X.d)((function(e){return e.map.gridSize})),n=Object(X.d)((function(e){return e.map.gridCount})),r=ie(Object(j.a)({},a));return i.createElement("div",{className:Object(b.a)(r.root)},S.a.times(n.height,(function(e){return S.a.times(n.width,(function(a){return i.createElement(se,{key:"".concat(a,"-").concat(e),x:a,y:e,classes:r,layerId:t})}))})))})),de=function(e){e.className;var t=e.layerDef,a=e.layerId,n=Object(X.d)((function(e){return e.map.objectDefs}));return t.walkable&&i.createElement(i.Fragment,null,i.createElement(Ae,{layerId:a}),n&&Object.keys(n).filter((function(e){return n[e].layer===a})).map((function(e){return i.createElement(ue,{key:e,objectId:e})})))};de.defaultProps={};var me=de,fe=y((function(e){return{root:{position:"fixed",height:"100%",width:"100%"},layerContainer:{transformOrigin:"0 0",position:"fixed",top:0,left:0,height:"100%",width:"100%",transition:e.transitions.create("transform",{duration:100})},controlInstruction:{position:"fixed",bottom:0,left:"50%"},controlInstructionInner:{backgroundColor:"rgba(0,0,0,0.3)",color:"white",borderTopRightRadius:e.shape.borderRadius,borderTopLeftRadius:e.shape.borderRadius,padding:16,transform:"translateX(-50%)"}}}),{name:"CameraControl",index:1}),pe=a(387),ge=a(345),he=Object(P.b)("cameraMoveStart"),ye=Object(P.b)("cameraZoomRelative"),ve=Object(P.b)("cameraMoveRelative"),be=Object(P.b)("cameraMoveSourceRelative"),Ee=Object(P.b)("cameraMoveEnd"),we=Object(P.b)("cameraZoomStart"),xe=Object(P.b)("cameraZoomEnd"),je=Object(P.b)("cameraCloseTip"),Ce=Object(P.d)({isMoving:!1,cameraOriginalPosition:null,moveSourcePosition:null,position:{x:0,y:0},zoom:1,isZooming:!1,showTip:!0},(function(e){return e.addCase(je,(function(e){e.showTip=!1})).addCase(he,(function(e,t){e.isMoving=!0,e.moveSourcePosition=t.payload.sourcePosition,e.cameraOriginalPosition=Object(j.a)({},e.position)})).addCase(Ee,(function(e,t){e.isMoving=!1})).addCase(ve,(function(e,t){e.position.x+=t.payload.x,e.position.y+=t.payload.y})).addCase(be,(function(e,t){e.position.x=e.cameraOriginalPosition.x+e.moveSourcePosition.x-t.payload.x,e.position.y=e.cameraOriginalPosition.y+e.moveSourcePosition.y-t.payload.y})).addCase(we,(function(e,t){e.isZooming=!0})).addCase(xe,(function(e,t){e.isZooming=!1})).addCase(ye,(function(e,t){var a=t.payload,n=a.center,r=a.zoom,i=a.screen,o=e.zoom,l=Math.min(4,Math.max(.25,e.zoom+r)),c=l/o,u=l-o,s=n.x-i.width/2,A=n.y-i.height/2,d=s*-c*1,m=A*-c*1,f=(e.position.x+s)/o*-u*1,p=(e.position.y+A)/o*-u*1,g=Math.sqrt(s*s+A*A),h=.5*Math.min(1,1/g*20),y=f-(f-d)*h,v=p-(p-m)*h,b={x:e.position.x-y,y:e.position.y-v};e.zoom=l,e.position=b}))})),Oe=function(e,t,a){i.useEffect((function(){return window.addEventListener(e,t),function(){window.removeEventListener(e,t)}}),a)},ke=function(e){var t=e.children,a=fe({}),n=Object(X.d)((function(e){return e.camera})),r=Object(X.c)(),o=i.useRef(null);return Oe("mouseup",(function(e){return 1===e.button&&r(Ee())}),[r]),i.useEffect((function(){var e=o.current;if(e){var t=function(t){r(ye({zoom:-t.deltaY/200,center:{x:t.pageX,y:t.pageY},screen:{width:e.clientWidth,height:e.clientHeight}}))};return e.addEventListener("wheel",t),function(){e.removeEventListener("wheel",t)}}}),[r]),i.createElement("div",{ref:o,className:Object(b.a)(a.root),onMouseDown:function(e){1===e.button&&r(he({sourcePosition:{x:e.pageX,y:e.pageY}}))},onMouseMove:function(e){n.isMoving&&r(be({x:e.pageX,y:e.pageY}))},onTouchStart:function(e){1===e.touches.length?r(he({sourcePosition:{x:e.touches[0].pageX,y:e.touches[0].pageY}})):2===e.touches.length&&(r(Ee()),r(we()))},onTouchMove:function(e){n.isMoving&&r(be({x:e.touches[0].pageX,y:e.touches[0].pageY}))}},i.createElement("div",{className:a.layerContainer,style:{transform:"translate(50%,50%) translate(".concat(-n.position.x,"px,").concat(-n.position.y,"px) scale(").concat(n.zoom,")")}},t),i.createElement(ge.a,{in:n.showTip,direction:"up"},i.createElement("div",{className:a.controlInstruction},i.createElement("div",{className:a.controlInstructionInner},"Middle mouse click and drag to move camera, middle wheel to zoom"," ",i.createElement(pe.a,{color:"primary",onClick:function(){return r(je())}},"Understood")))))};ke.defaultProps={};var De=ke,Se=a(22),Pe=a(39),Le=a(414),Te=Object(P.c)("importTileset",function(){var e=Object(k.a)(O.a.mark((function e(t,a){var n,r,i,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(Le.a)(),r=t.tilesetId,i=!0===t.applyToLayer?a.getState().editor.workingLayer:t.applyToLayer,e.next=5,K(r);case 5:return o=e.sent,e.abrupt("return",{tileDef:o,localId:n,localName:t.localName||t.tilesetId,applyToLayer:i});case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),Ie=function(){var e=Object(Le.a)();return{gridCount:{width:36,height:18},gridSize:{width:16,height:16},layerOrder:[e],layerDefs:Object(re.a)({},e,{type:"tilemap",tileset:"",tiles:[]}),objectDefs:{},spriteDefs:{},tilesetDefs:{}}},ze=Object(P.e)({name:"editor",initialState:{workingLayer:null,mapDef:null,isEditing:!1,panel:{tilemapLayerEditor:{selected:{x:0,y:0,width:1,height:1},paintMode:"paint"}},updatedTiles:null,dialog:{},hiddenLayer:{}},reducers:{initialize:{prepare:function(e){return{payload:{mapDef:e.mapDef||Ie()}}},reducer:function(e,t){e.mapDef=t.payload.mapDef,e.isEditing=!0,e.mapDef.loaded=!0,e.mapDef.ready=!0}},selectWorkingLayer:function(e,t){e.workingLayer=t.payload.layerId},addLayer:{prepare:function(e){return{payload:{layerType:e.layerType,layerId:Object(Le.a)()}}},reducer:function(e,t){var a=t.payload.layerId,n=e.mapDef;if(n)switch(n.layerOrder.push(a),t.payload.layerType){case"image":n.layerDefs[a]={type:"image",localName:"Image Layer",src:"",scale:{width:1,height:1},offset:{x:0,y:0}},e.workingLayer=a;break;case"tilemap":n.layerDefs[a]={type:"tilemap",localName:"Tilemap Layer",tileset:{src:""},tiles:[]},e.workingLayer=a;break;default:throw new Error("not support layer type")}}},setMapProperty:function(e,t){e.mapDef&&S.a.set(e.mapDef,t.payload.property,t.payload.value)},setLayerProperty:function(e,t){var a,n=null===(a=e.mapDef)||void 0===a?void 0:a.layerDefs[t.payload.layerId];n&&S.a.set(n,t.payload.property,t.payload.value)},setProperty:{prepare:function(e,t){return{payload:{name:e,value:t},meta:{},error:null}},reducer:function(e,t){S.a.set(e,t.payload.name,t.payload.value)}},paintTileLayer:function(e,t){var a=t.payload,n=a.layerId,r=a.position,i=a.tileGridCount,o=a.startingPosition;if(e.mapDef){var l,c,u,s=e.mapDef.layerDefs[n];if(s&&"tilemap"===s.type&&i){var A=e.panel.tilemapLayerEditor.selected;l=A.width,c=A.height,u=function(t,a){var n=r.x+t,l=r.y+a;if(n>=0&&l>=0&&n<e.mapDef.gridCount.width&&l<e.mapDef.gridCount.height){s.tiles[l]||(s.tiles[l]=[]);var c=i.width*(A.y+(o?(r.y-(o.y-1e4*A.height)+a)%A.height:a))+A.x+(o?(r.x-(o.x-1e4*A.width)+t)%A.width:t);s.tiles[l][n]=c}},S.a.times(c,(function(e){return S.a.times(l,(function(t){return u(t,e)}))})).flatMap(S.a.identity)}}},deleteLayer:function(e,t){if(e.mapDef){var a,n=t.payload.layerId;e.mapDef.layerOrder=null===(a=e.mapDef)||void 0===a?void 0:a.layerOrder.filter((function(e){return e!==n})),delete e.mapDef.layerDefs[n],e.workingLayer=null}},createTileset:{prepare:function(e){var t=e.tilesetDef,a=e.assignToLayer;return{payload:{tilesetDef:t,tilesetId:Object(Le.a)(),assignToLayer:a},meta:{},error:null}},reducer:function(e,t){if(e.mapDef&&(S.a.set(e.mapDef,["tilesetDefs",t.payload.tilesetId],t.payload.tilesetDef),t.payload.assignToLayer))return void(e.mapDef.layerDefs[!0===t.payload.assignToLayer&&e.workingLayer||t.payload.assignToLayer].tileset=t.payload.tilesetId)}},rearrangeLayer:function(e,t){if(e.mapDef){var a,n=e.mapDef.layerOrder.splice(t.payload.sourceIndex,1);(a=e.mapDef.layerOrder).splice.apply(a,[t.payload.targetIndex,0].concat(Object(Pe.a)(n)))}},openDialog:function(e,t){var a;e.dialog[t.payload.dialog]=null===(a=t.payload.props)||void 0===a||a},closeDialog:function(e,t){delete e.dialog[t.payload.dialog]},hideLayer:function(e,t){t.payload.hidden?e.hiddenLayer[t.payload.layerId]=!0:delete e.hiddenLayer[t.payload.layerId]}},extraReducers:function(e){return e.addCase(Te.fulfilled,(function(e,t){e.mapDef&&(S.a.set(e.mapDef,["tilesetDefs",t.payload.localId],Object(j.a)({},t.payload.tileDef,{localName:t.payload.localName})),t.payload.applyToLayer&&S.a.set(e.mapDef,["layerDefs",t.payload.applyToLayer,"tileset"],t.payload.localId))}))}});ze.actions=Object.assign(ze.actions,{importTileset:Te});var Me=ze,Ne=a(179),Re=a.n(Ne),Be=function(e,t){if(t.length){var a=document.createElement("canvas"),n=a.getContext("2d"),r=e.width,i=e.height;if(n){a.width=r,a.height=i,n.clearRect(0,0,r,i),n.drawImage(e,0,0);var o=n.getImageData(0,0,r,i),l=o.data,c=new Set(t.map((function(e){var t=new Re.a(e);return"".concat(t.red(),",").concat(t.green(),",").concat(t.blue())})));console.log(c);for(var u=0;u<l.length;u+=4){var s="".concat(l[u],",").concat(l[u+1],",").concat(l[u+2]);c.has(s)&&(l[u+3]=0)}return n.clearRect(0,0,r,i),n.putImageData(o,0,0),a.toDataURL("image/png")}throw new Error("not support canvas 2dcontext")}},Fe=function(e){var t;return e.src+((null===(t=e.transparentColor)||void 0===t?void 0:t.length)?"::"+e.transparentColor.join(","):"")},We=Object(P.c)("loadDataResource",function(){var e=Object(k.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K(t.url));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ge=Object(P.c)("processImage",function(){var e=Object(k.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var a=document.createElement("img");a.src=w(t.src),a.onload=function(){t.transparentColor?e({src:Be(a,t.transparentColor)}):e({src:w(t.src)})}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Ye=Object(P.e)({name:"resource",initialState:{},reducers:{},extraReducers:function(e){return e.addCase(We.fulfilled,(function(e,t){S.a.set(e,[t.meta.arg.resourceType,t.meta.arg.url],t.payload)})).addCase(Ge.fulfilled,(function(e,t){S.a.set(e,["image",Fe(t.meta.arg)],t.payload.src)}))}}),Ke={loadDataResource:We,processImage:Ge};Ye.actions=Object.assign(Ye.actions,Ke);var Ve=Ye,Xe=a(128),qe=a(180),Ze={key:"root",storage:a.n(qe).a,blacklist:["resource"]},He=Object(P.a)({reducer:Object(Xe.a)(Ze,Object(Se.c)({camera:Ce,map:te,editor:Me.reducer,resource:Ye.reducer}))}),Ue=function(e){return Object(X.d)((function(t){return e(t.editor)}))},Je=Object(Xe.b)(He),Qe=He,$e=y((function(e){return{root:{},tile:{position:"absolute"},tileDef:function(e){var t,a,n=e.tileset,r=(e.gridCount,e.gridSize),i=n,o=S.a.transform(S.a.times(null!==(t=null===(a=i.gridCount)||void 0===a?void 0:a.height)&&void 0!==t?t:0,(function(e){var t,a;return S.a.times(null!==(t=null===(a=i.gridCount)||void 0===a?void 0:a.width)&&void 0!==t?t:0,(function(t){return[t,e]}))})).flatMap(S.a.identity),(function(e,t,a){var n=Object(x.a)(t,2),i=n[0],o=n[1];e["&.t".concat(a)]={backgroundPositionX:-i*r.width,backgroundPositionY:-o*r.height}}),{});return Object(j.a)({width:r.width,height:r.height},o)},img:{display:"none"}}}),{name:"TilemapLayer",index:1}),_e=function(e){var t=e.className,a=e.layerId,n=Object(X.c)(),r=q((function(e){return e.gridCount})),o=q((function(e){return e.gridSize})),l=q((function(e){return e.layerDefs[a]})),c=q((function(e){return"string"===typeof l.tileset?e.tilesetDefs[l.tileset]:void 0})),u=$e(Object(j.a)({},l,{gridCount:r,gridSize:o})),s=i.useRef(null),A=i.useRef(),d=Object(X.d)((function(e){var t;return(null===c||void 0===c?void 0:c.image.src)?null===(t=e.resource.image)||void 0===t?void 0:t[Fe(c.image)]:void 0})),m=w(d||(null===c||void 0===c?void 0:c.image.src));i.useEffect((function(){var e;!d&&(null===c||void 0===c||null===(e=c.image)||void 0===e?void 0:e.transparentColor)&&n(Ve.actions.processImage(c.image))}),[d,null===c||void 0===c?void 0:c.image]);var f=i.useReducer((function(e,t){return t}),""),p=Object(x.a)(f,2),g=p[0],h=p[1],y=i.useRef();return i.useLayoutEffect((function(){var e,t=y.current,a=null===(e=s.current)||void 0===e?void 0:e.getContext("2d"),n=A.current;a&&n&&c&&(t&&t.src===g?S.a.forEach(l.tiles,(function(e,r){e!==(null===t||void 0===t?void 0:t.tiles[r])&&S.a.forEach(e,(function(e,i){var l;if(e!==(null===(l=t.tiles[r])||void 0===l?void 0:l[i])){if(a.imageSmoothingEnabled=!1,a.clearRect(o.width*i,o.height*r,o.width,o.height),null==e)return;a.drawImage(n,e%c.gridCount.width*c.gridSize.width,Math.floor(e/c.gridCount.width)*c.gridSize.height,c.gridSize.width,c.gridSize.height,o.width*i,o.height*r,o.width,o.height)}}))})):S.a.forEach(l.tiles,(function(e,t){S.a.forEach(e,(function(e,r){a.imageSmoothingEnabled=!1,a.clearRect(o.width*r,o.height*t,o.width,o.height),null!=e&&a.drawImage(n,e%c.gridCount.width*c.gridSize.width,Math.floor(e/c.gridCount.width)*c.gridSize.height,c.gridSize.width,c.gridSize.height,o.width*r,o.height*t,o.width,o.height)}))})),y.current={src:g,tiles:l.tiles})}),[g,l.tiles,c]),i.useEffect((function(){A.current||(A.current=document.createElement("img"));var e=A.current;e&&(e.src=m,e.onload=function(e){return h(m)})}),[m]),i.createElement("div",{className:Object(b.a)(t,u.root)},i.createElement("canvas",{ref:s,width:r.width*o.width,height:r.height*o.height}))};_e.defaultProps={};var et=_e,tt=i.memo((function(e){var t=e.layerId,a=v({}),n=q((function(e){return e.layerDefs[t]}));return function(e){switch(n.type){case"image":return i.createElement(ne,{className:a.layer,key:e,layerId:e,layerDef:n});case"object":return i.createElement(me,{className:a.layer,key:e,layerId:e,layerDef:n});case"tilemap":return i.createElement(et,{className:a.layer,key:e,layerId:e,layerDef:n});default:return null}}(t)})),at=i.memo((function(){var e=q((function(e){return e.layerOrder})),t=Ue((function(e){return e.hiddenLayer}));return i.createElement(i.Fragment,null,e.map((function(e){return t[e]?null:i.createElement(tt,{key:e,layerId:e})})))})),nt=function(e){var t=v(e),a=(e.className,e.mapDef),n=e.overlay,r=q((function(e){return Boolean(e)})),o=(q((function(e){return Boolean(e.loaded)})),Object(X.c)());return i.useEffect((function(){r||o(Z(a))}),[o,r,a]),i.createElement("div",{className:t.root},i.createElement(De,null,i.createElement(at,null),n))},rt=function(e){return i.createElement(nt,e)},it=a(408),ot=a(93),lt=a.n(ot),ct=(a(102),a(389)),ut=a(103),st={row:{justifyContent:"center"},column:{alignItems:"center"}},At='Kanit, Sarabun, Prompt, "Roboto", "Helvetica", "Arial", sans-serif',dt='Sarabun, Prompt, "Roboto", "Helvetica", "Arial", sans-serif',mt={palette:{background:{},type:"dark",primary:ct.a,secondary:ut.a},mixins:{flex:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"column",t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return Object(j.a)({display:"flex",flexDirection:e},a.includes("center")?st[e]:{},{},a.includes("wrap")?{flexWrap:"wrap"}:{})},imageAvatar:function(){return{borderRadius:"12%"}},mixBackgroundColor:function(e,t){return{backgroundColor:t,color:e.palette.getContrastText(t)}}},drawer:{width:240},main:{width:720},sidebar:{width:300,flex:"0 0 300px"},typography:{fontSize:14,fontFamily:dt,sansFonts:At,serifFonts:dt,h1:{fontFamily:At},h2:{fontFamily:At},h3:{fontFamily:At},h4:{fontFamily:At},h5:{fontFamily:At},h6:{fontFamily:At}}},ft=lt()(mt),pt=a(409),gt=a(193),ht=a(20),yt=y((function(e){return{root:{display:"flex"},drawerPaper:{backgroundColor:"rgba(66, 66, 66, 0.5)",maxWidth:"25vw",boxShadow:e.shadows[15]}}}),{name:"GameEditor",index:1}),vt=a(407),bt=y((function(e){return{root:{},center:{overflowY:"auto"}}}),{name:"LayerPanel",index:1}),Et=y((function(e){return{root:{marginBottom:e.spacing(1),display:"flex",flexDirection:"column"}}}),{name:"PanelBase",index:1}),wt=a(390),xt=a(391),jt=function(e){var t=Et(e),a=e.className,n=e.title,r=e.children;return i.createElement(wt.a,{elevation:8,className:Object(b.a)(a,t.root)},n&&i.createElement(xt.a,{title:n||"unnamedpanel"}),r)};jt.defaultProps={};var Ct=jt,Ot=a(413),kt=a(346),Dt=a(396),St=a(392),Pt=a(347),Lt=a(394),Tt=a(393),It=a(194),zt=a(395),Mt=a(184),Nt=a.n(Mt),Rt=a(183),Bt=a.n(Rt),Ft=a(185),Wt=a.n(Ft),Gt=a(181),Yt=a.n(Gt),Kt=a(182),Vt=a.n(Kt),Xt=a(104),qt=i.forwardRef((function(e,t){return i.createElement(Ot.a,Object.assign({ref:t,checkedIcon:i.createElement(Yt.a,null),icon:i.createElement(Vt.a,null)},e))})),Zt=function(e){var t=bt(e),a=(e.className,Ue((function(e){return e.mapDef}))),n=Ue((function(e){return e.workingLayer})),r=Ue((function(e){return e.hiddenLayer})),o=Object(X.c)(),l=i.useCallback((function(e){var t=e.currentTarget.dataset.layerid;t&&o(Me.actions.selectWorkingLayer({layerId:t}))}),[]),c=i.useState(!1),u=Object(x.a)(c,2),s=u[0],A=u[1],d=i.useRef(null),m=i.useCallback((function(e){A(!1);var t=e.currentTarget.dataset.layertype;t&&o(Me.actions.addLayer({layerType:t}))}),[]),f=i.useCallback((function(){n&&o(Me.actions.deleteLayer({layerId:n}))}),[n]),p=i.useCallback((function(e){var t=e.currentTarget,a=t.dataset.layerid;a&&o(Me.actions.hideLayer({layerId:a,hidden:!t.checked}))}),[]);return i.createElement(Xt.a,{onDragEnd:function(e){e.destination&&o(Me.actions.rearrangeLayer({sourceIndex:a.layerOrder.length-e.source.index-1,targetIndex:a.layerOrder.length-e.destination.index-1}))}},i.createElement(Ct,{title:"Layer"},i.createElement(Xt.c,{droppableId:"layerpanel",type:"LAYER"},(function(e,o){return i.createElement(St.a,Object.assign({className:t.center,ref:e.innerRef},e.droppableProps),(null===a||void 0===a?void 0:a.layerOrder)&&Object(Pe.a)(a.layerOrder).reverse().map((function(e,t){return i.createElement(Xt.b,{key:e,draggableId:e,index:t},(function(t,o){var c;return i.createElement(Pt.a,Object.assign({button:!0,ref:t.innerRef},t.draggableProps,{"data-layerid":e,selected:n===e,onClick:l,divider:!0}),i.createElement(Tt.a,{inset:!0,secondary:a.layerDefs[e].type},(null===(c=a.layerDefs[e])||void 0===c?void 0:c.localName)||e),i.createElement("span",t.dragHandleProps,i.createElement(Bt.a,null)),i.createElement(Lt.a,{style:{left:16,right:"unset"}},i.createElement(qt,{color:"default",inputProps:{"data-layerid":e},checked:!r[e],onChange:p})))}))})),e.placeholder)})),i.createElement(It.a,{open:s,anchorEl:d.current,onClose:function(){return A(!1)}},i.createElement(zt.a,{"data-layertype":"image",onClick:m},"Image"),i.createElement(zt.a,{"data-layertype":"tilemap",onClick:m},"Tilemap")),i.createElement(Dt.a,null,i.createElement(kt.a,{ref:d,onClick:function(){return A(!0)}},i.createElement(Nt.a,null)),i.createElement(kt.a,{disabled:!n,onClick:f},i.createElement(Wt.a,null)))))};Zt.defaultProps={};var Ht=Zt,Ut=y((function(e){return{root:{},divider:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}}}),{name:"LayerWorkPanel",index:1}),Jt=a(66),Qt=y((function(e){return{root:{}}}),{name:"EditorTextField",index:1}),$t=a(411),_t=function(e){var t=Qt(e),a=e.className,n=e.onUpdate,r=Object(Jt.a)(e,["className","onUpdate"]),o=i.useState(!1),l=Object(x.a)(o,2),c=l[0],u=l[1],s=i.useState(""),A=Object(x.a)(s,2),d=A[0],m=A[1],f=i.useRef(e);f.current=e;var p=i.useCallback((function(){u(!0),m(f.current.value)}),[]),g=i.useCallback((function(e){var t,a;u(!1),null===(t=(a=f.current).onUpdate)||void 0===t||t.call(a,e.target.value)}),[]),h=i.useCallback((function(e){m(e.target.value)}),[]),y=i.useCallback((function(t){var a;"Enter"===t.key&&(null===n||void 0===n||n(t.target.value)),null===(a=e.onKeyDown)||void 0===a||a.call(e,t)}),[e.onKeyDown,n]);return i.createElement($t.a,Object.assign({},r,{className:Object(b.a)(a,t.root),onFocus:p,onBlur:g,onChange:h,onKeyDown:y,value:c?d:e.value}))};_t.defaultProps={};var ea=_t,ta=a(400),aa=a(401),na=a(399),ra=a(398),ia=y((function(e){return{root:{height:function(e){return e.height},paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},input:{width:48,textAlign:"right"}}}),{name:"ZoomInput",index:1}),oa=a(397),la=a(187),ca=a.n(la),ua=a(186),sa=a.n(ua),Aa=function(e){var t=ia(e),a=e.className,n=e.value,r=e.onChange,o=e.label,l=e.min,c=void 0===l?.1:l,u=i.useState(n),s=Object(x.a)(u,2),A=s[0],d=s[1],m=i.useState(!1),f=Object(x.a)(m,2),p=f[0],g=f[1],h=i.useCallback((function(e){var t=e.target.value,a=t.endsWith("%")?t.substring(0,t.length-1):t,n=Math.max(c,Math.round(Number(a))/100);d(n),g(!0)}),[c]),y=i.useCallback((function(){p&&r&&r(A),g(!1)}),[r,A,p]),v=i.useCallback((function(e){"Enter"===e.key&&y()}),[y]),b=i.useCallback((function(){r&&r(n+.1)}),[n,r]),E=i.useCallback((function(){r&&r(n-.1)}),[n,r]),w=i.useMemo((function(){return{classes:t,startAdornment:i.createElement(oa.a,{position:"start"},i.createElement(kt.a,{disabled:n<=c+1e-4,onClick:E},i.createElement(sa.a,null))),endAdornment:i.createElement(oa.a,{position:"end"},i.createElement(kt.a,{onClick:b},i.createElement(ca.a,null)))}}),[t,n,c,b,E]);return i.createElement($t.a,{className:a,value:Math.floor(100*(p?A:n))+"%",variant:"outlined",InputProps:w,onBlur:y,onChange:h,onKeyPress:v,label:o})};Aa.defaultProps={};var da=Aa,ma=y((function(e){return{root:{position:"relative"},canvas:{position:"absolute",top:0,left:0},highlight:{position:"absolute",backgroundColor:"rgba(255,255,127,0.5)",pointerEvents:"none"},clickThrough:{pointerEvents:"none"},highlightPosition:function(e){return"object"===typeof e.highlight?{left:e.highlight.x*e.gridSize.width,top:e.highlight.y*e.gridSize.height,width:e.highlight.width*e.gridSize.height,height:e.highlight.height*e.gridSize.height}:{}}}}),{name:"GridOverlay",index:1}),fa=function(e){var t=ma(e),a=e.className,n=e.children,r=e.gridSize,o=e.gridCount,l=e.strokeStyle,c=void 0===l?"rgb(255,255,0)":l,u=e.highlight,s=void 0===u?"":u,A=e.clickThrough,d=void 0!==A&&A,m=e.onGridClick,f=e.onGridPointerDown,p=e.onGridPointerUp,g=e.onGridPointerMove,h=Object(Jt.a)(e,["className","children","gridSize","gridCount","strokeStyle","highlight","clickThrough","onGridClick","onGridPointerDown","onGridPointerUp","onGridPointerMove"]),y=i.useRef(null),v=o.width*r.width,E=o.height*r.height;i.useLayoutEffect((function(){var e,t=null===(e=y.current)||void 0===e?void 0:e.getContext("2d");t&&(t.clearRect(0,0,v,E),t.beginPath(),S.a.times(o.height+1,(function(e){t.moveTo(0,e*r.height),t.lineTo(v,e*r.height)})),S.a.times(o.width+1,(function(e){t.moveTo(e*r.width,0),t.lineTo(e*r.width,E)})),t.strokeStyle=c,t.stroke())}),[v,E,r.width,r.height,o.width,o.height,c]);var w=function(e){var t=e.currentTarget.getBoundingClientRect(),a=e.clientX-t.x,n=e.clientY-t.y;return{x:Math.floor(a/(r.width*(t.width/(r.width*o.width)))),y:Math.floor(n/(r.height*(t.height/(r.height*o.height))))}},x=i.useRef(null),j=i.useRef(null);return i.createElement("div",{className:Object(b.a)(a,t.root)},n,i.createElement("canvas",Object.assign({},h,{ref:y,width:v,height:E,className:Object(b.a)(t.canvas,Object(re.a)({},t.clickThrough,d)),onClick:function(e){var t,a,n,r=w(e);(null===(t=x.current)||void 0===t?void 0:t.x)===r.x&&(null===(a=x.current)||void 0===a?void 0:a.y)===r.y&&(null===m||void 0===m||m({grid:r},e)),null===(n=h.onClick)||void 0===n||n.call(h,e)},onMouseMove:function(e){var t,a=w(e),n=j.current;n&&n.x===a.x&&n.y===a.y||null===g||void 0===g||g({grid:a},e),j.current=a,null===(t=h.onMouseMove)||void 0===t||t.call(h,e)},onMouseDown:function(e){var t,a=w(e);x.current=a,null===f||void 0===f||f({grid:a},e),null===(t=h.onMouseDown)||void 0===t||t.call(h,e)},onMouseUp:function(e){var t,a=w(e);null===p||void 0===p||p({grid:a},e),null===(t=h.onMouseUp)||void 0===t||t.call(h,e)}})),s&&i.createElement("div",{className:Object(b.a)(t.highlight,t.highlightPosition)}))};fa.defaultProps={};var pa=fa,ga=y((function(e){return{imageContainer:{maxWidth:"100%",overflow:"auto",position:"relative"},tile:{borderRightStyle:"dashed",borderBottomStyle:"dashed",borderWidth:1,borderColor:"rgba(255,0,255,0.4)",position:"absolute"},disableElementSelect:{userSelect:"none"},tileSize:function(e){var t=e.gridSize;return{width:null===t||void 0===t?void 0:t.width,height:null===t||void 0===t?void 0:t.height}},tileSelected:{border:"solid yellow 1px !important"},contentScale:function(e){var t=e.zoom;return{transform:"scale(".concat(t,")"),transformOrigin:"0 0"}},divider:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}}}),{index:1});var ha={image:function(e){var t=e.layerId,a=Ue((function(e){return e.mapDef.layerDefs[t]})),n=Object(X.c)(),r=function(e){n(Me.actions.setLayerProperty({layerId:t,property:e.target.name,value:Number(e.target.value)}))};return i.createElement(ta.a,null,i.createElement(aa.a,{container:!0,spacing:1},i.createElement(aa.a,{item:!0,xs:12},i.createElement(ea,{fullWidth:!0,label:"Image src",value:a.src,onUpdate:function(e){n(Me.actions.setLayerProperty({layerId:t,property:"src",value:e}))}})),i.createElement(aa.a,{item:!0,xs:6},i.createElement($t.a,{fullWidth:!0,type:"number",inputProps:{step:.1},value:a.offset.x,label:"Offset X",onChange:r,name:"offset.x"})),i.createElement(aa.a,{item:!0,xs:6},i.createElement($t.a,{fullWidth:!0,type:"number",inputProps:{step:.1},value:a.offset.y,label:"Offset Y",onChange:r,name:"offset.y"})),i.createElement(aa.a,{item:!0,xs:6},i.createElement($t.a,{fullWidth:!0,type:"number",inputProps:{step:.1},value:a.scale.width,label:"Scale width",onChange:r,name:"scale.width"})),i.createElement(aa.a,{item:!0,xs:6},i.createElement($t.a,{fullWidth:!0,type:"number",inputProps:{step:.1},value:a.scale.height,label:"Scale height",onChange:r,name:"scale.height"}))))},object:function(e){var t=e.layerId,a=Ue((function(e){return e.mapDef.layerDefs[t]}));return i.createElement(i.Fragment,null,i.createElement(ea,{label:"Image src",value:a.src}))},tilemap:function(e){var t,a=e.layerId,n=Ue((function(e){return e.mapDef.layerDefs[a]})),r="string"===typeof n.tileset?n.tileset:"src"in n.tileset?n.tileset.src:"local",o=Object(X.c)(),l=q((function(e){var t;return null===(t=e.tilesetDefs)||void 0===t?void 0:t[r]})),c=null===l||void 0===l||null===(t=l.image)||void 0===t?void 0:t.src,u=Object(X.d)((function(e){var t;return c&&(null===(t=e.resource.image)||void 0===t?void 0:t[Fe(l.image)])})),s=w(u||c);i.useEffect((function(){var e;!u&&(null===l||void 0===l||null===(e=l.image)||void 0===e?void 0:e.transparentColor)&&o(Ve.actions.processImage(null===l||void 0===l?void 0:l.image))}),[u,null===l||void 0===l?void 0:l.image]);var A=i.useState(1),d=Object(x.a)(A,2),m=d[0],f=d[1],p=ga(Object(j.a)({},l,{zoom:m})),g=Ue((function(e){return e.panel.tilemapLayerEditor.selected})),h=Ue((function(e){var t;return null===(t=e.mapDef)||void 0===t?void 0:t.tilesetDefs})),y=i.useState(null),v=Object(x.a)(y,2),E=v[0],C=v[1],O=i.useCallback((function(e,t){var a=e.grid;a&&C(a)}),[]),k=i.useCallback((function(e,t){var a=e.grid;a&&o(Me.actions.setProperty(["panel","tilemapLayerEditor","selected"],Object(j.a)({},a,{width:1,height:1})))}),[]),D=i.useCallback((function(e,t){var a=e.grid;if(a&&E){var n={x:Math.min(E.x,a.x),y:Math.min(E.y,a.y)},r={width:Math.max(1,Math.abs(n.x-(a.x>E.x?a.x:E.x)-1)),height:Math.max(1,Math.abs(n.y-(a.y>E.y?a.y:E.y)-1))};o(Me.actions.setProperty(["panel","tilemapLayerEditor","selected"],Object(j.a)({},n,{},r)))}}),[E]);return Oe("mouseup",(function(){return C(null)}),[]),i.createElement(i.Fragment,null,i.createElement($t.a,{fullWidth:!0,label:"Tileset ID",value:r,select:!0,onChange:function(e){switch(e.target.value){case"$import":return void o(Me.actions.openDialog({dialog:"tilesetImporter"}));case"$create":return void o(Me.actions.openDialog({dialog:"tilesetProperty"}));case void 0:return;default:o(Me.actions.setLayerProperty({layerId:a,property:["tileset"],value:e.target.value}))}}},S.a.map(h,(function(e,t){return i.createElement(zt.a,{key:t,value:t},e.localName||"unnamed tileset")})),i.createElement(ra.a,{className:p.divider}),i.createElement(zt.a,{value:"$import"},"Import tileset"),i.createElement(zt.a,{value:"$create"},"Create new tileset")),l&&i.createElement(i.Fragment,null,i.createElement("div",{className:Object(b.a)(p.imageContainer,p.disableElementSelect)},i.createElement("div",{className:p.contentScale},i.createElement(pa,{gridCount:l.gridCount,gridSize:l.gridSize,onGridClick:k,onGridPointerMove:D,onGridPointerDown:O,highlight:g},i.createElement("img",{src:s,alt:r})))),i.createElement(na.a,null,i.createElement(da,{onChange:function(e){return f(e)},value:m}))))}},ya=function(e){Ut(e),e.className;var t=Ue((function(e){return e.workingLayer})),a=Ue((function(e){return e.workingLayer&&e.mapDef.layerDefs[e.workingLayer]})),n=ha[null===a||void 0===a?void 0:a.type];return i.createElement(Ct,{title:"Working on "+((null===a||void 0===a?void 0:a.localName)||t||"nothing")},n&&i.createElement(n,{layerId:t}))};ya.defaultProps={};var va=ya,ba=y((function(e){return{root:{},gridContainer:{position:"absolute"},grid:{borderRightStyle:"dashed",borderBottomStyle:"dashed",borderWidth:2,borderColor:"rgba(255,0,255,0.4)",position:"absolute"},gridSize:function(e){var t=e.gridSize;return Object(j.a)({},t)},gridTarget:{backgroundColor:"rgba(255,255,0,0.5)"}}}),{name:"MapEditorOverlay",index:1}),Ea=function(e){var t=e.className,a=Object(X.c)(),n=q((function(e){return e.gridSize})),r=q((function(e){return e.gridCount})),o=Ue((function(e){return e.workingLayer})),l=q((function(e){return o?e.layerDefs[o]:null})),c=ba({gridSize:n}),u=Object(X.e)(),s=i.useState(null),A=Object(x.a)(s,2),d=A[0],m=A[1],f=i.useState(null),p=Object(x.a)(f,2),g=p[0],h=p[1],y=Ue((function(e){return e.panel.tilemapLayerEditor.selected})),v=i.useMemo((function(){return Object(j.a)({},y,{},d)}),[y,d]),E=q((function(e){return e.tilesetDefs}));Oe("mouseup",(function(e){return 0===e.button&&h(null)}),[]);var w=i.useCallback((function(e,t){var n=e.grid;if(n&&(m(n),g&&"tilemap"===(null===l||void 0===l?void 0:l.type)&&o)){var r,i,c="string"===typeof l.tileset?E[l.tileset].gridCount:"gridCount"in l.tileset?l.tileset.gridCount:null===(r=u.getState().resource.tileset)||void 0===r||null===(i=r[l.tileset.src])||void 0===i?void 0:i.gridCount;a(Me.actions.paintTileLayer({layerId:o,position:n,startingPosition:g,tileGridCount:c}))}}),[g,l,o,E]),C=i.useCallback((function(e,t){var n=e.grid;if(0===t.button&&o&&n&&"tilemap"===(null===l||void 0===l?void 0:l.type)){var r,i;h(n);var c="string"===typeof l.tileset?E[l.tileset].gridCount:"gridCount"in l.tileset?l.tileset.gridCount:null===(r=u.getState().resource.tileset)||void 0===r||null===(i=r[l.tileset.src])||void 0===i?void 0:i.gridCount;a(Me.actions.paintTileLayer({layerId:o,position:n,startingPosition:n,tileGridCount:c}))}}),[l,o,E]);return l&&i.createElement("div",{draggable:!1,className:Object(b.a)(t,c.root,c.gridContainer)},i.createElement(pa,{gridCount:r,gridSize:n,onGridPointerDown:C,onGridPointerMove:w,highlight:v}))};Ea.defaultProps={};var wa=Ea,xa=y((function(e){return{root:{}}}),{name:"MenuPanel",index:1}),ja=a(402),Ca=a(404),Oa=a(403),ka=a(405),Da=a(188),Sa=a.n(Da),Pa=function(e){var t,a=null!==(t=q((function(e){return e})))&&void 0!==t?t:null,n=Object(X.c)();return a&&i.createElement(ja.a,e,i.createElement(Oa.a,null,"Map Properties"),i.createElement(Ca.a,null,i.createElement(aa.a,{container:!0,spacing:2},i.createElement(aa.a,{item:!0,xs:6},i.createElement(ea,{type:"number",fullWidth:!0,inputProps:{max:1024,min:0},name:"gridSize.width",label:"Tile width",value:a.gridSize.width,onUpdate:function(e){return n(Me.actions.setMapProperty({property:"gridSize.width",value:Number(e)}))}})),i.createElement(aa.a,{item:!0,xs:6},i.createElement(ea,{type:"number",fullWidth:!0,inputProps:{max:1024,min:0},name:"gridSize.height",label:"Tile height",value:a.gridSize.height,onUpdate:function(e){return n(Me.actions.setMapProperty({property:"gridSize.height",value:Number(e)}))}})),i.createElement(aa.a,{item:!0,xs:6},i.createElement(ea,{type:"number",fullWidth:!0,inputProps:{max:100,min:0},name:"gridCount.width",label:"Tile row",value:a.gridCount.width,onUpdate:function(e){return n(Me.actions.setMapProperty({property:"gridCount.width",value:Number(e)}))}})),i.createElement(aa.a,{item:!0,xs:6},i.createElement(ea,{type:"number",fullWidth:!0,inputProps:{max:100,min:0},name:"gridCount.height",label:"Tile column",value:a.gridCount.height,onUpdate:function(e){return n(Me.actions.setMapProperty({property:"gridCount.height",value:Number(e)}))}})))),i.createElement(ka.a,null,i.createElement(pe.a,{onClick:e.onClose},"Close")))},La=function(e){return Y.a.stringify(S.a.omit(e,"loaded","ready"))},Ta=function(e){var t,a=null!==(t=q((function(e){return e})))&&void 0!==t?t:null,n=(Object(X.c)(),i.useMemo((function(){return La(a)}),[a]));return a&&i.createElement(ja.a,e,i.createElement(Oa.a,null,"MapDef Raw Data"),i.createElement(Ca.a,null,i.createElement(ea,{multiline:!0,fullWidth:!0,variant:"outlined",value:n})),i.createElement(ka.a,null,i.createElement(pe.a,{onClick:e.onClose},"Close")))},Ia=function(e){var t=xa(e),a=e.className,n=i.useState(null),r=Object(x.a)(n,2),o=r[0],l=r[1],c=i.useRef(null),u=Object(X.e)(),s=Object(X.c)(),A=i.useCallback((function(e){l(null);var t=e.currentTarget.dataset,a=t.action,n=t.dialog;if(n)return l(n);switch(a){case"newmap":return void s(Me.actions.initialize({}));case"export":var r=u.getState().editor.mapDef;if(!r)return;var i=La(r),o="data:text/yaml;charset=UTF-8,".concat(i);return void(e.currentTarget.href=o)}}),[]);return i.createElement(Ct,{className:Object(b.a)(a,t.root)},i.createElement(na.a,null,i.createElement(kt.a,{ref:c,onClick:function(){return l("menu")}},i.createElement(Sa.a,null))),i.createElement(It.a,{anchorEl:c.current,open:"menu"===o,onClose:function(){return l(null)}},i.createElement(zt.a,{"data-action":"newmap",onClick:A},"New map"),i.createElement(zt.a,{"data-dialog":"mapproperties",onClick:A},"Map properties"),i.createElement(zt.a,{"data-dialog":"rawdata",onClick:A},"Raw data"),i.createElement(zt.a,{component:"a",download:"mapdef.yaml","data-action":"export",onClick:A},"Export as YAML")),i.createElement(Pa,{open:"mapproperties"===o,onClose:function(){return l(null)}}),i.createElement(Ta,{open:"rawdata"===o,onClose:function(){return l(null)}}))};Ia.defaultProps={};var za=Ia,Ma=y((function(e){return{root:{},colorChipFocus:{border:"solid"},imgColorPick:{cursor:"crosshair"}}}),{name:"TilesetPropertyDialog",index:1}),Na=a(415),Ra=a(191),Ba=a.n(Ra),Fa=a(40),Wa=a(34),Ga={gridCount:{width:3,height:3},gridSize:{width:8,height:8},offset:{x:0,y:0},image:{src:"",transparentColor:[]},tileDefs:[],localName:""},Ya=function(e){var t=e.classes,a=e.field,n=e.form,r=e.focus,o=e.onFocusChange,l=Object(Wa.a)(),c=function(e){try{return{backgroundColor:e,color:l.palette.getContrastText(e)}}catch(t){return}};return i.createElement(i.Fragment,null,a.value.map((function(e,l){return i.createElement(Na.a,{key:e,style:c(e),onClick:function(){o(l)},className:Object(b.a)(Object(re.a)({},t.colorChipFocus,r===l)),onDelete:function(t){o(null),n.setFieldValue(a.name,S.a.without(a.value,e))},label:e})})),i.createElement(kt.a,{onClick:function(){var e=S.a.uniq([].concat(Object(Pe.a)(a.value),[""]));n.setFieldValue(a.name,e),o(e.length-1)}},i.createElement(Ba.a,null)))},Ka=function(e){var t=Ma(e),a=e.className,n=Object(Jt.a)(e,["className"]),r=Object(X.c)(),o=Ue((function(e){return Boolean(e.dialog.tilesetProperty)})),l=i.useRef();i.useEffect((function(){l.current=document.createElement("canvas")}),[]);var c=i.useState(null),u=Object(x.a)(c,2),s=u[0],A=u[1];return i.createElement(Fa.c,{initialValues:Ga,onSubmit:function(e){r(Me.actions.createTileset({tilesetDef:e})),r(Me.actions.closeDialog({dialog:"tilesetProperty"}))}},i.createElement(ja.a,Object.assign({},n,{onClose:function(){r(Me.actions.closeDialog({dialog:"tilesetProperty"}))},open:o,className:Object(b.a)(a,t.root)}),i.createElement(Fa.b,null,i.createElement(Oa.a,null,"Create a new tileset"),i.createElement(Ca.a,null,i.createElement(aa.a,{container:!0,spacing:2},i.createElement(aa.a,{item:!0,xs:12},i.createElement(Fa.a,{fullWidth:!0,as:$t.a,name:"localName",label:"Tileset name"})),i.createElement(aa.a,{item:!0,xs:12},i.createElement(Fa.a,{fullWidth:!0,as:$t.a,name:"image.src",label:"Image URL"})),i.createElement(aa.a,{item:!0,xs:6},i.createElement(Fa.a,{fullWidth:!0,type:"number",inputProps:{min:0},as:$t.a,name:"gridCount.width",label:"Tile count horizontal"})),i.createElement(aa.a,{item:!0,xs:6},i.createElement(Fa.a,{fullWidth:!0,type:"number",inputProps:{min:0},as:$t.a,name:"gridCount.height",label:"Tile count vertical"})),i.createElement(aa.a,{item:!0,xs:6},i.createElement(Fa.a,{fullWidth:!0,type:"number",inputProps:{min:0},as:$t.a,name:"gridSize.width",label:"Tile width"})),i.createElement(aa.a,{item:!0,xs:6},i.createElement(Fa.a,{fullWidth:!0,type:"number",inputProps:{min:0},as:$t.a,name:"gridSize.height",label:"Tile height"})),i.createElement(aa.a,{item:!0,xs:12},"Transparent color",i.createElement(Fa.a,{name:"image.transparentColor"},(function(e){return i.createElement(Ya,Object.assign({},e,{classes:t,focus:s,onFocusChange:A}))}))),i.createElement(aa.a,{item:!0,xs:12},"Preview",i.createElement(Fa.a,null,(function(e){var a=e.form;return i.createElement(pa,{gridCount:a.values.gridCount,gridSize:a.values.gridSize,clickThrough:!0},i.createElement("img",{className:Object(b.a)(Object(re.a)({},t.imgColorPick,null!=s)),src:a.values.image.src,onClick:function(e){var t=function(e){var t,a=e.currentTarget,n=null===(t=l.current)||void 0===t?void 0:t.getContext("2d");if(l.current&&n){l.current.width=a.width,l.current.height=a.height,n.clearRect(0,0,a.width,a.height),n.drawImage(a,0,0);var r=a.getBoundingClientRect(),i=e.pageX-r.left,o=e.pageY-r.top,c=n.getImageData(i,o,1,1).data;return"rgb(".concat(c[0],",").concat(c[1],",").concat(c[2],")")}}(e);a.setFieldValue("image.transparentColor[".concat(s,"]"),t)},alt:"Tileset preview"}))}))))),i.createElement(ka.a,null,i.createElement(pe.a,{type:"submit"},"Save")))))};Ka.defaultProps={};var Va=Ka,Xa=y((function(e){return{root:{}}}),{name:"TilesetImporterDialog",index:1}),qa=a(412),Za=a(406),Ha=["/assets/tilesets/grasstown-tileset.yaml","/assets/tilesets/grasstown-tileset-transparent.yaml"],Ua=function(e){var t=Xa(e),a=e.className,n=i.useState(""),r=Object(x.a)(n,2),o=r[0],l=r[1],c=i.useState(""),u=Object(x.a)(c,2),s=u[0],A=u[1],d=Object(X.c)(),m=Ue((function(e){return Boolean(e.dialog.tilesetImporter)})),f=function(){d(Me.actions.closeDialog({dialog:"tilesetImporter"}))},p=i.useCallback((function(e){var t=e.currentTarget.dataset.tileset;t&&l(t)}),[]),g=i.useCallback((function(e){A(e.target.value)}),[]),h=function(){var e=Object(k.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d(Me.actions.importTileset({tilesetId:o,localName:s,applyToLayer:!0})),f();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i.createElement(ja.a,{open:m,onClose:f,className:Object(b.a)(a,t.root)},i.createElement(Oa.a,null,"Import tileset"),i.createElement(St.a,null,Ha.map((function(e){return i.createElement(Pt.a,{key:e,"data-tileset":e,selected:o===e,button:!0,onClick:p},i.createElement(Za.a,null,i.createElement(qa.a,{checked:o===e})),i.createElement(Tt.a,null,e))}))),i.createElement(Ca.a,null,i.createElement($t.a,{fullWidth:!0,label:"As name",InputLabelProps:{shrink:!0},placeholder:o,onChange:g,value:s})),i.createElement(ka.a,null,i.createElement(pe.a,{onClick:f},"Close"),i.createElement(pe.a,{onClick:h,disabled:!o},"Import")))};Ua.defaultProps={};var Ja=Ua,Qa=function(e){var t=yt(e),a=e.className,n=e.mapDef,r=Ue((function(e){return e.mapDef})),o=Ue((function(e){return e.isEditing})),l=Object(X.c)();return i.useEffect((function(){r||l(Me.actions.initialize({mapDef:n}))}),[n,r]),o&&r?i.createElement("div",{className:Object(b.a)(a,t.root)},i.createElement(rt,{mapDef:r,overlay:i.createElement(wa,null)}),i.createElement(vt.a,{classes:{paper:t.drawerPaper},open:!0,variant:"permanent",anchor:"right"},i.createElement(Ht,null)),i.createElement(vt.a,{classes:{paper:t.drawerPaper},open:!0,variant:"permanent",anchor:"left"},i.createElement(za,null),i.createElement(va,null)),i.createElement(Va,null),i.createElement(Ja,null)):null};Qa.defaultProps={};var $a=Qa,_a=a(192),en=lt()(ft);var tn=function(){return o.a.createElement(gt.a,{basename:"/rpg-map"},o.a.createElement(X.a,{store:Qe},o.a.createElement(_a.a,{loading:null,persistor:Je},o.a.createElement(it.a,{theme:en},o.a.createElement(pt.a,null,o.a.createElement("div",{className:"App"},o.a.createElement(ht.c,null,o.a.createElement(ht.a,{path:"/demo1"},o.a.createElement(rt,{mapDef:s.a})),o.a.createElement(ht.a,{path:"/demo2"},o.a.createElement(rt,{mapDef:d.a})),o.a.createElement(ht.a,{path:"/demo3"},o.a.createElement(rt,{mapDef:f.a})),o.a.createElement(ht.a,null,o.a.createElement($a,{mapDef:f.a})))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(tn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[209,1,2]]]);
//# sourceMappingURL=main.591a8b2f.chunk.js.map